function out = Morris_Lecar
out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = @jacobianp;
out{5} = @hessians;
out{6} = @hessiansp;
out{7} = @der3;
out{8} = @der4;
out{9} = @der5;
out{10} = [];

function dydt = fun_eval(t,in2,Iapp,v3)
dydt = [Iapp./2.0e+1-in2(1,:)./1.0e+1-((tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(1.1e+1./5.0)+1.1e+1./5.0).*(in2(1,:)-1.2e+2))./2.0e+1-in2(2,:).*(in2(1,:)+8.4e+1).*(2.0./5.0)-6.0;(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./2.5e+1];

function [tspan,y0,options] = init
handles = feval(Morris_Lecar);
y0=[0;0];
options = odeset('Jacobian',handles(3),'JacobianP',handles(4),'Hessians',handles(5),'HessiansP',handles(6));
tspan = [0 10];

function jac = jacobian(t,in2,Iapp,v3)
jac = reshape([in2(2,:).*(-2.0./5.0)-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(1.1e+1./1.0e+2)+((tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2.*(1.1e+1./9.0e+1)-1.1e+1./9.0e+1).*(in2(1,:)-1.2e+2))./2.0e+1-2.1e+1./1.0e+2,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1).*(-1.0./2.5e+1)+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./1.5e+3,in2(1,:).*(-2.0./5.0)-1.68e+2./5.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.0./2.5e+1)],[2,2]);

function jacp = jacobianp(t,in2,Iapp,v3)
jacp = reshape([1.0./2.0e+1,0.0,0.0,(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1))./2.5e+1-(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./1.5e+3],[2,2]);

function hess = hessians(t,in2,Iapp,v3)
hess(:,:,1) =reshape([tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2.*(1.1e+1./9.0e+2)-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*(in2(1,:)-1.2e+2).*(1.1e+1./9.0e+2)-1.1e+1./9.0e+2,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1).*(-1.0./7.5e+2)+(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./9.0e+4+(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./7.5e+2,-2.0./5.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-6.666666666666667e-4)],[2,2]);
hess(:,:,2) =reshape([-2.0./5.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-6.666666666666667e-4),0.0,0.0],[2,2]);

function hessp = hessiansp(t,in2,Iapp,v3)
hessp(:,:,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
hessp(:,:,2) =reshape([0.0,(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1))./7.5e+2-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./9.0e+4-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./7.5e+2,0.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1)./1.5e+3],[2,2]);

function tens3 = der3(t,in2,Iapp,v3)
tens3(:,:,1,1) =reshape([(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^2.*(in2(1,:)-1.2e+2).*(1.1e+1./9.0e+2)-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*(1.1e+1./3.0e+2)+tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*(in2(1,:)-1.2e+2).*1.358024691358025e-3,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1).*(-3.333333333333333e-5)-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2)./7.5e+2+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./5.4e+6+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./1.5e+4-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./1.125e+4,0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.111111111111111e-5)],[2,2]);
tens3(:,:,1,2) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.111111111111111e-5),0.0,0.0],[2,2]);
tens3(:,:,2,1) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.111111111111111e-5),0.0,0.0],[2,2]);
tens3(:,:,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);

function tens4 = der4(t,in2,Iapp,v3)
tens4(:,:,1,1,1) =reshape([(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^2.*(1.1e+1./2.25e+2)+tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*5.432098765432099e-3-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^2.*(in2(1,:)-1.2e+2).*5.432098765432099e-3-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^3.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*(in2(1,:)-1.2e+2).*1.508916323731139e-4,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1).*(-7.407407407407407e-7)-(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2)./1.125e+4+(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./3.24e+8+(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./4.5e+5+cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2.*3.555555555555556e-4+(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^3.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./1.6875e+5-(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./1.6875e+5,0.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.851851851851852e-7)],[2,2]);
tens4(:,:,1,1,2) =reshape([0.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.851851851851852e-7),0.0,0.0],[2,2]);
tens4(:,:,1,2,1) =reshape([0.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.851851851851852e-7),0.0,0.0],[2,2]);
tens4(:,:,1,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens4(:,:,2,1,1) =reshape([0.0,sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-1.851851851851852e-7),0.0,0.0],[2,2]);
tens4(:,:,2,1,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens4(:,:,2,2,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens4(:,:,2,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);

function tens5 = der5(t,in2,Iapp,v3)
tens5(:,:,1,1,1,1) =reshape([(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^3.*(in2(1,:)-1.2e+2).*5.432098765432099e-3-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^2.*(1.1e+1./4.05e+2)-tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^3.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*7.544581618655693e-4+tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).^2.*(in2(1,:)-1.2e+2).*1.659807956104252e-3+tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^4.*(tanh(in2(1,:)./1.8e+1+1.0./1.5e+1).^2./1.8e+1-1.0./1.8e+1).*(in2(1,:)-1.2e+2).*1.676573693034598e-5,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./6.0e+1-1.0./6.0e+1).*(-1.54320987654321e-8)-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2)./2.7e+5-cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^3.*3.555555555555556e-4+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-in2(2,:)+tanh(in2(1,:)./3.0e+1-v3./3.0e+1)./2.0+1.0./2.0))./1.944e+10-cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2.*6.518518518518519e-5+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./1.62e+7-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./4.05e+6-(cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^4.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./2.53125e+6+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1).^2)./3.375e+4+(sinh(in2(1,:)./6.0e+1-v3./6.0e+1).*tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^3.*(tanh(in2(1,:)./3.0e+1-v3./3.0e+1).^2./3.0e+1-1.0./3.0e+1))./2.025e+6,0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-3.08641975308642e-9)],[2,2]);
tens5(:,:,1,1,1,2) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-3.08641975308642e-9),0.0,0.0],[2,2]);
tens5(:,:,1,1,2,1) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-3.08641975308642e-9),0.0,0.0],[2,2]);
tens5(:,:,1,1,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,1,2,1,1) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-3.08641975308642e-9),0.0,0.0],[2,2]);
tens5(:,:,1,2,1,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,1,2,2,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,1,2,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,1,1,1) =reshape([0.0,cosh(in2(1,:)./6.0e+1-v3./6.0e+1).*(-3.08641975308642e-9),0.0,0.0],[2,2]);
tens5(:,:,2,1,1,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,1,2,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,1,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,2,1,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,2,1,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,2,2,1) =reshape([0.0,0.0,0.0,0.0],[2,2]);
tens5(:,:,2,2,2,2) =reshape([0.0,0.0,0.0,0.0],[2,2]);
