function out = CO_oxidation
out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = @jacobianp;
out{5} = @hessians;
out{6} = @hessiansp;
out{7} = @der3;
out{8} = @der4;
out{9} = @der5;
out{10} = [];

function dydt = fun_eval(t,in2,k1,km1,k3,k2,km2,k4,lambda)
dydt = [km1.*in2(1,:).^2.*-2.0+k1.*(in2(3,:)+in2(1,:)+in2(2,:)-1.0).^2.*2.0-k3.*in2(1,:).*in2(2,:);-km2.*in2(2,:)-k2.*(in2(3,:)+in2(1,:)+in2(2,:)-1.0)-k3.*in2(1,:).*in2(2,:);-k4.*(in2(3,:)+in2(1,:)+in2(2,:)+lambda.*in2(3,:)-1.0)];

function [tspan,y0,options] = init
handles = feval(CO_oxidation);
y0=[0;0;0];
options = odeset('Jacobian',handles(3),'JacobianP',handles(4),'Hessians',handles(5),'HessiansP',handles(6));
tspan = [0 10];

function jac = jacobian(t,in2,k1,km1,k3,k2,km2,k4,lambda)
jac = reshape([km1.*in2(1,:).*-4.0-k3.*in2(2,:)+k1.*(in2(3,:).*2.0+in2(1,:).*2.0+in2(2,:).*2.0-2.0).*2.0,-k2-k3.*in2(2,:),-k4,-k3.*in2(1,:)+k1.*(in2(3,:).*2.0+in2(1,:).*2.0+in2(2,:).*2.0-2.0).*2.0,-k2-km2-k3.*in2(1,:),-k4,k1.*(in2(3,:).*2.0+in2(1,:).*2.0+in2(2,:).*2.0-2.0).*2.0,-k2,-k4.*(lambda+1.0)],[3,3]);

function jacp = jacobianp(t,in2,k1,km1,k3,k2,km2,k4,lambda)
jacp = reshape([(in2(3,:)+in2(1,:)+in2(2,:)-1.0).^2.*2.0,0.0,0.0,in2(1,:).^2.*-2.0,0.0,0.0,-in2(1,:).*in2(2,:),-in2(1,:).*in2(2,:),0.0,0.0,-in2(3,:)-in2(1,:)-in2(2,:)+1.0,0.0,0.0,-in2(2,:),0.0,0.0,0.0,-in2(3,:)-in2(1,:)-in2(2,:)-lambda.*in2(3,:)+1.0,0.0,0.0,-k4.*in2(3,:)],[3,7]);

function hess = hessians(t,in2,k1,km1,k3,k2,km2,k4,lambda)
hess(:,:,1) =reshape([k1.*4.0-km1.*4.0,0.0,0.0,k1.*4.0-k3,-k3,0.0,k1.*4.0,0.0,0.0],[3,3]);
hess(:,:,2) =reshape([k1.*4.0-k3,-k3,0.0,k1.*4.0,0.0,0.0,k1.*4.0,0.0,0.0],[3,3]);
hess(:,:,3) =reshape([k1.*4.0,0.0,0.0,k1.*4.0,0.0,0.0,k1.*4.0,0.0,0.0],[3,3]);

function hessp = hessiansp(t,in2,k1,km1,k3,k2,km2,k4,lambda)
hessp(:,:,1) =reshape([in2(3,:).*4.0+in2(1,:).*4.0+in2(2,:).*4.0-4.0,0.0,0.0,in2(3,:).*4.0+in2(1,:).*4.0+in2(2,:).*4.0-4.0,0.0,0.0,in2(3,:).*4.0+in2(1,:).*4.0+in2(2,:).*4.0-4.0,0.0,0.0],[3,3]);
hessp(:,:,2) =reshape([in2(1,:).*-4.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
hessp(:,:,3) =reshape([-in2(2,:),-in2(2,:),0.0,-in2(1,:),-in2(1,:),0.0,0.0,0.0,0.0],[3,3]);
hessp(:,:,4) =reshape([0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-1.0,0.0],[3,3]);
hessp(:,:,5) =reshape([0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,0.0],[3,3]);
hessp(:,:,6) =reshape([0.0,0.0,-1.0,0.0,0.0,-1.0,0.0,0.0,-lambda-1.0],[3,3]);
hessp(:,:,7) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-k4],[3,3]);

function tens3 = der3(t,in2,k1,km1,k3,k2,km2,k4,lambda)
tens3(:,:,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens3(:,:,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);

function tens4 = der4(t,in2,k1,km1,k3,k2,km2,k4,lambda)
tens4(:,:,1,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,1,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,2,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens4(:,:,3,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);

function tens5 = der5(t,in2,k1,km1,k3,k2,km2,k4,lambda)
tens5(:,:,1,1,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,1,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,2,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,1,3,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,1,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,2,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,2,3,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,1,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,2,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,1,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,1,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,1,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,2,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,2,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,2,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,3,1) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,3,2) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
tens5(:,:,3,3,3,3) =reshape([0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[3,3]);
