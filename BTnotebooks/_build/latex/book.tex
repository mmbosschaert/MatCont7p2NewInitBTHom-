%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]


\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=0,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Morris-Lecar}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{Interplay between normal forms and center manifold reduction for homoclinic predictors near Bogdanov-Takens bifurcation}
\date{Sep 12, 2022}
\release{}
\author{Maikel Bosschaert}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
In this Jupyter Book we will demonstrate the effectiveness of the homoclinic
predictors derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]} to start continuations of
homoclinic orbits in two parameters in MatCont near generic codimension two
Bogdanov\sphinxhyphen{}Takens bifurcation points in \(n\)\sphinxhyphen{}dimensional ordinary differential
equations (ODEs) of the form
\begin{equation}\label{equation:intro:ODE}
\begin{split}\dot x(t) = f(x(t), \alpha),\end{split}
\end{equation}
\sphinxAtStartPar
where \(x: \mathbb R \to \mathbb R^n\) and \(\alpha \in \mathbb R^m\). The
function \(f : \mathbb R^n \times \mathbb R^m \to \mathbb R^n\) is assumed to
be as smooth as necessary.

\sphinxAtStartPar
In total there are eight different models considered. Each the models consists
of two notebooks:
\begin{itemize}
\item {} 
\sphinxAtStartPar
one to generate the necessary \sphinxstyleemphasis{derivative files}, see for example
{\hyperref[\detokenize{Morris-LecarGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Generate system files for Morris\sphinxhyphen{}Lecar in a platinum model}}}},

\item {} 
\sphinxAtStartPar
and one \sphinxstyleemphasis{model notebook} to analyse the model.

\end{itemize}

\sphinxAtStartPar
In the first two models {\hyperref[\detokenize{Morris-Lecar::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Morris\sphinxhyphen{}Lecar Model}}}},  and {\hyperref[\detokenize{CO-oxidation::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{CO\sphinxhyphen{}oxidation in a platinum model.}}}}
we partly follow the presentation in {[}\hyperlink{cite.references:id5}{BAH15}{]}, that is, we define an
equilibrium of \eqref{equation:intro:ODE}, continue the equilibrium point one parameter, encounter
a codimension one Hopf or fold bifurcation, continue the codimension one
bifurcation point in two parameters and encounter one or more Bogdanov\sphinxhyphen{}Takens
points. The homoclinic orbits emanating from these Bogdanov\sphinxhyphen{}Takens point can
then be continued using one of the homoclinic predictors form
{[}\hyperlink{cite.references:id3}{Kuz21}{]} implemented into MatCont. In these first two models we
will describe in detail how a homoclinic approximation near the generic
codimension two Bogdanov\sphinxhyphen{}Takens bifurcation is obtained in MatCont.

\sphinxAtStartPar
Although the procedure described above is a common situation for discovering
Bogdanov\sphinxhyphen{}Takens points in ODEs, in many situations it is possible to derive the
Bogdanov\sphinxhyphen{}Takens point directly, either analytically or numerically, form the
ODE. This will be the approach for the remaining models were we will focus
solely on the homoclinic orbits emanating from the Bogdanov\sphinxhyphen{}Takens point and
not the Hopf and fold curves.

\sphinxAtStartPar
At the end of each \sphinxstyleemphasis{model notebook} we create a convergence plot of the
different methods to approximation the homoclinic solution derived in
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\sphinxAtStartPar
In the notebook {\hyperref[\detokenize{BogdanovTakens::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{BogdanovTakens.ipynb}}}} the importance of
using a higher order approximation of the non\sphinxhyphen{}linear time transformation used
in {[}\hyperlink{cite.references:id3}{Kuz21}{]} is demonstrated.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The \sphinxstyleemphasis{derivative files} can also be generated with the graphical user interface of
MatCont. In fact, if preferred, the continuation of the various bifurcation
branches can be done using only the graphical user interface.
\end{sphinxadmonition}


\part{Morris\sphinxhyphen{}Lecar}


\chapter{Generate system files for Morris\sphinxhyphen{}Lecar in a platinum model}
\label{\detokenize{Morris-LecarGenSym:generate-system-files-for-morris-lecar-in-a-platinum-model}}\label{\detokenize{Morris-LecarGenSym::doc}}
\sphinxAtStartPar
In this script the \sphinxstylestrong{system files} for the Morris\sphinxhyphen{}Lecar model {[}\hyperlink{cite.references:id4}{ML81}{]}
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
c\dot V &= I_{app} - I_{ion}, \\
\dot w &= \phi \frac{w_\infty -w}{\tau},
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}
\begin{aligned}
m_\infty &= 0.5 \left(1+\tanh\left(\frac{v-v_1}{v_2}\right)\right), \\
w_\infty &= 0.5 \left(1+\tanh\left(\frac{v-v_3}{v_4}\right)\right), \\
i_{ion} &= g_{ca} m_{\infty} (v-v_{ca}) + g_k w (v-v_k) + g_l (v-v_l), \\
\tau &= \text{sech}\left(\frac{v-v_3}{2v_4}\right).
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
are generated. These are used in the {\hyperref[\detokenize{Morris-Lecar::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Morris\sphinxhyphen{}Lecar demo}}}}.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{Morris-LecarGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{Morris-LecarGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Morris\PYGZus{}Lecar\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{Morris-LecarGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{w\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Iapp\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{v3\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{Morris-LecarGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.  Due to
the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{alpha}} or \sphinxcode{\sphinxupquote{par(1)}}.
There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{Morris-LecarGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{C}\PYG{p}{=}\PYG{l+m+mi}{20}\PYG{p}{;}
\PYG{n}{VL}\PYG{p}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{;}
\PYG{n}{VCa}\PYG{p}{=}\PYG{l+m+mi}{120}\PYG{p}{;}
\PYG{n}{VK}\PYG{p}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{84}\PYG{p}{;}
\PYG{n}{gL}\PYG{p}{=}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{gCa}\PYG{p}{=}\PYG{l+m+mf}{4.4}\PYG{p}{;}
\PYG{n}{gK}\PYG{p}{=}\PYG{l+m+mi}{8}\PYG{p}{;}
\PYG{n}{v1}\PYG{p}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2}\PYG{p}{;}
\PYG{n}{v2}\PYG{p}{=}\PYG{l+m+mi}{18}\PYG{p}{;}
\PYG{n}{v4}\PYG{p}{=}\PYG{l+m+mi}{30}\PYG{p}{;}
\PYG{n}{phi}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{25}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{Morris-LecarGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{minf}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n+nb}{tanh}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{v1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{v2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{winf}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n+nb}{tanh}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{v3}\PYG{p}{)}\PYG{o}{/}\PYG{n}{v4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Iion}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{gCa}\PYG{o}{*}\PYG{n}{minf}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VCa}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gK}\PYG{o}{*}\PYG{n}{w}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gL}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VL}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{tau}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{sech}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{v3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{v4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dV\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{Iapp}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{Iion}\PYG{p}{)}\PYG{o}{/}\PYG{n}{C}\PYG{p}{;}
\PYG{n}{dw\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{phi}\PYG{o}{/}\PYG{n}{tau}\PYG{o}{*}\PYG{p}{(}\PYG{n}{winf}\PYG{o}{\PYGZhy{}}\PYG{n}{w}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dV\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dw\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{Morris-LecarGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{Morris-LecarGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Morris\sphinxhyphen{}Lecar Model}
\label{\detokenize{Morris-Lecar:morris-lecar-model}}\label{\detokenize{Morris-Lecar::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id4}{ML81}{]} the following reduced model is considered
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
c\dot V &= I_{app} - I_{ion}, \\
\dot w &= \phi \frac{w_\infty -w}{\tau},
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
where
\begin{equation*}
\begin{split}
\begin{aligned}
m_\infty &= 0.5 \left(1+\tanh\left(\frac{v-v_1}{v_2}\right)\right), \\
w_\infty &= 0.5 \left(1+\tanh\left(\frac{v-v_3}{v_4}\right)\right), \\
i_{ion} &= g_{ca} m_{\infty} (v-v_{ca}) + g_k w (v-v_k) + g_l (v-v_l), \\
\tau &= \text{sech}\left(\frac{v-v_3}{2v_4}\right).
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
are generated. Here, \(C\) is the membrane capacitance; \(I_{a p p}\)
is the applied current; \(I_{\text {ion }}\) collects the \(\mathrm{Ca}^{2+}\),
\(K^{1+}\) and \(L\) currents; \(g_{L}, g_{C a}\) and \(g_{K}\) are the maximal
conductances for \(L, \mathrm{Ca}^{2+}\) and \(K^{1+}\) channels, respectively. \(V\)
is the membrane potential; \(V_{L}, V_{C a}\) and \(V_{K}\) are the equilibrium
potentials corresponding to \(L, C a^{2+}\) and \(K^{1+}\) conductance’s,
respectively; \(w\) is the fraction of open \(K^{1+}\) channels; \(m_{\infty}\) and
\(w_{\infty}\) are the fractions of open \(\mathrm{Ca}^{2+}\) and \(K^{1+}\) channels
at steady state respectively; \(\frac{\tau}{0}\) determines the activation time
for the \(K^{1+}\) current. The parameters \(v_{1}, v_{2}, v_{3}\) and \(v_{4}\) are
chosen to fit the model data.

\sphinxAtStartPar
The following parameters are fixed
\begin{equation*}
\begin{split}
C=20, \quad V_{L}=-60, \quad V_{C a}=120, \quad V_{K}=-84, \quad g_{L}=2, \quad
g_{C a}= 4.4, \quad g_{K}=8,
\end{split}
\end{equation*}
\sphinxAtStartPar
and
\begin{equation*}
\begin{split}
v_{1}=-1.2, \quad v_{2}=18, \quad v_{3}=2, \quad v_{4}=30, \quad
\phi=\frac{1}{25}.
\end{split}
\end{equation*}

\section{Overview}
\label{\detokenize{Morris-Lecar:overview}}
\sphinxAtStartPar
In this demo we will revisit and extend the results from {[}\hyperlink{cite.references:id5}{BAH15}{]},
using the new homoclinic predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}. Thus, we will:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Compute a curve of equilibria, parametrized by \(I_{app}\).

\item {} 
\sphinxAtStartPar
Detect two Hopf points.

\item {} 
\sphinxAtStartPar
Start continuation from the first Hopf point in two parameters \((I_{app},v_3)\).

\item {} 
\sphinxAtStartPar
Detect four Bogdanov\sphinxhyphen{}Takens points.

\item {} 
\sphinxAtStartPar
Start continuation from the Bogdanov\sphinxhyphen{}Takens points in two parameters \((I_{app},v_3)\).

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the first the Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
first Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create bifurcation plots including Hopf and fold curves.

\item {} 
\sphinxAtStartPar
Create a convergence plot comparing the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{Morris-Lecar:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{Morris-Lecar:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{Morris-LecarGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Morris\sphinxhyphen{}LecarGenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{Morris\PYGZus{}Lecar}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define equilibrium}
\label{\detokenize{Morris-Lecar:define-equilibrium}}
\sphinxAtStartPar
We manually define an equilibrium at
\begin{equation}\label{equation:Morris-Lecar:eq:MorrisLecar:equilibrium}
\begin{split}(V,w) = (-60.85456779, 0.0149139691),\end{split}
\end{equation}
\sphinxAtStartPar
with parameter values \(I_{app}=0\) and \(v_3 = 2\).

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in the software package \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool} {[}\hyperlink{cite.references:id21}{SEL+14}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Iapp\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{v3\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Iapp}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{v3}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{x}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{60.85456779}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m+mf}{0.0149139691}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue equilibrium in parameter \protect\(I_{app}\protect\)}
\label{\detokenize{Morris-Lecar:continue-equilibrium-in-parameter-i-app}}
\sphinxAtStartPar
To continue the equilibrium \eqref{equation:Morris-Lecar:eq:MorrisLecar:equilibrium} in parameter
\(I_{app}\), we first need to obtain a tangent vector to the curve. This is done
by the function \sphinxcode{\sphinxupquote{init\_EP\_EP}}. Then we use the function \sphinxcode{\sphinxupquote{contset}} to obain a
\sphinxstylestrong{struct} containing a list of options which is passed on to the continuer. By
adjusting the values of the fields of the \sphinxcode{\sphinxupquote{opt}} \sphinxstylestrong{struct} we set the maximum
step size.  We also set the maximum number of points to continue and weather or
not to detect bifurcation points (\sphinxcode{\sphinxupquote{opt.Singularities}}) on the equilibrium
curve. For more information about all options available to the
\sphinxstyleemphasis{MatCont} continuer and the continuation process in general, we refer to
{[}\hyperlink{cite.references:id14}{DGK+08}{]}.

\sphinxAtStartPar
Finally, we continue the curve using the function \sphinxcode{\sphinxupquote{cont}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}EP\PYGZus{}EP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Iapp}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{equilibrium}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = H , x = ( \PYGZhy{}25.270107 0.139673 93.857614 )
First Lyapunov coefficient = 5.220142e\PYGZhy{}04
label = H , x = ( 7.800664 0.595491 212.018815 )
First Lyapunov coefficient = 5.451161e\PYGZhy{}04

elapsed time  = 0.2 secs
npoints curve = 300
\end{sphinxVerbatim}

\sphinxAtStartPar
There are two Hopf bifurcation points detected (H). The \sphinxstylestrong{array struct}
\sphinxcode{\sphinxupquote{eqbr\_bif\_data}} contains information about the detected bifurcation points. We
use this to extract the index of the detected bifurcation points on the
equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}. The equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}} is just a two
dimensional array. Each column consists of a point on the curve. The first two
rows contain the point \((V,w)\) while the last row contains the parameter
\(I_{app}\).

\sphinxAtStartPar
Below we plot the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}, together with the detected Hopf
points, in \((I_{app},w)\)\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n}{hopfPointsInfo}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{HopfPoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{hopfPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{HopfPoint2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{hopfPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{HopfPoint1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{HopfPoint1}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{HopfPoint2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{HopfPoint2}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve in \PYGZdl{}(I\PYGZus{}\PYGZob{}app\PYGZcb{},w)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_12_0}.png}


\section{Setup Hopf point}
\label{\detokenize{Morris-Lecar:setup-hopf-point}}
\sphinxAtStartPar
To continue the first Hopf point in the parameters \(I_{app}\) and \(v_3\) we
construct a new point \sphinxcode{\sphinxupquote{hopf1}} containing the position and parameter values.
These are needed to obtain an initial tangent vector \sphinxhyphen{} using the function
\sphinxcode{\sphinxupquote{init\_H\_H}} \sphinxhyphen{} in the full phase/parameter space. Since, from now on, we will be
using the continuation parameters \(I_{app}\) and \(v_3\) frequently we assigned
these parameters to the variable \sphinxcode{\sphinxupquote{ap}} (active parameters).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Iapp}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{v3}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} continuation parameters}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{;}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}H\PYGZus{}H}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue Hopf point in parameters \protect\(I_{app}\protect\) and \protect\(v_3\protect\)}
\label{\detokenize{Morris-Lecar:continue-hopf-point-in-parameters-i-app-and-v-3}}
\sphinxAtStartPar
We continue the Hopf point curve using again the function \sphinxcode{\sphinxupquote{cont}}. We use the
same continuation options as before defined above in the \sphinxstylestrong{struct} \sphinxcode{\sphinxupquote{opt}}, but
set additionally the following options. We increase the number of maximum
allowed continuation points. We also increase the accuracy for locating
detected bifurcations (\sphinxcode{\sphinxupquote{TestTolerance}}) and the maximum number of iterations
that may be used to achieve this (\sphinxcode{\sphinxupquote{MaxTestIters}}). This improves the homoclinic
predictor which depend directly on the accuracy of the located Bogdanov\sphinxhyphen{}Takens
point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{TestTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}15}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxTestIters}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2000}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{hopf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( 13.611147 0.023136 \PYGZhy{}227.131888 69.755737 0.000000 )
(a,b)=(\PYGZhy{}1.119908e\PYGZhy{}03, \PYGZhy{}3.301195e\PYGZhy{}02)
label = BT, x = ( 2.815616 0.974408 487.997703 \PYGZhy{}51.777429 0.000000 )
(a,b)=(\PYGZhy{}7.485863e\PYGZhy{}04, \PYGZhy{}2.961373e\PYGZhy{}02)
label = BT, x = ( \PYGZhy{}11.152829 0.970208 519.625365 \PYGZhy{}63.401902 0.000000 )
(a,b)=(7.383698e\PYGZhy{}04, 2.289394e\PYGZhy{}02)
label = BT, x = ( \PYGZhy{}27.149904 0.037007 48.225939 21.734143 0.000000 )
(a,b)=(2.766145e\PYGZhy{}04, 1.513072e\PYGZhy{}02)
Closed curve detected at step 1866

elapsed time  = 2.3 secs
npoints curve = 1866
\end{sphinxVerbatim}

\sphinxAtStartPar
There are four Bogdanov\sphinxhyphen{}Takens bifurcation points (BT) detected on the Hopf
branch \sphinxcode{\sphinxupquote{hopf\_br}}.

\sphinxAtStartPar
As with the Hopf points, information about the detected bifurcation points is
stored in the \sphinxstylestrong{struct array} \sphinxcode{\sphinxupquote{hopf\_br\_bif}}. Below we extract the
Bogdanov\sphinxhyphen{}Takens bifurcation points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{BT\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint3}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint4}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}v\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf curve in \PYGZdl{}(I\PYGZus{}\PYGZob{}app\PYGZcb{},v\PYGZus{}3)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_18_0}.png}


\section{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}
\label{\detokenize{Morris-Lecar:initial-prediction-of-homoclinic-orbit-near-bogdanov-takens-point-1}}\label{\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}}
\sphinxAtStartPar
To obtain an initial approximation to the homoclinic solution near the
Bogdanov\sphinxhyphen{}Takens point we use the function \sphinxcode{\sphinxupquote{init\_BT\_Hom}}. Its arguments are the
system file (\sphinxcode{\sphinxupquote{odefile}}), the Bogdanov\sphinxhyphen{}Takens point (\sphinxcode{\sphinxupquote{bt1}}) as defined below, the
unfolding parameters (\sphinxcode{\sphinxupquote{ap}}) and an options structure (\sphinxcode{\sphinxupquote{BToptions}}). The options
structure created with the function \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} contains the following
fields:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ntst}} Number of mesh intervals with a default value of 40.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ncol}} Number of collocation points used in each interval with a default of 4.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{extravec}} Three dimensional boolean row vector indicating which \sphinxstyleemphasis{homoclinic
parameters} are selected to be free. The first component refers to the
half\sphinxhyphen{}return time, while the second and third components refer to the
distances from the saddle point to the first, respectively, the last point on
the homoclinic orbit. The default value is set to \sphinxcode{\sphinxupquote{{[}0 1 1{]}}}. Thus, the
half\sphinxhyphen{}return time \sphinxcode{\sphinxupquote{T}} is fixed.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{order}} The order of the homoclinic approximation used with a default value
of 3.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{amplitude}} Desired amplitude of the homoclinic solution. If left empty then
a conservative estimate is made, see {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{TTolerance}} Desired distance between the last point on the numerical
homoclinic solution and the saddle point. This should be at least be smaller
than the amplitude. If left empty it is defined by \sphinxcode{\sphinxupquote{amplitude*1.0e\sphinxhyphen{}03}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{HigherOrderTimeReparametrization}} Boolean to indicate if a higher order
approximation to the nonlinear time transformation in the Lindstedt\sphinxhyphen{}Poincaré
method should be used. This should always be set to \sphinxcode{\sphinxupquote{1}}.  It is only
implemented for demonstration purposes.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{method}} Selects the method to be used to approximate the homoclinic
solution. The different methods available are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
orbital (the default),

\item {} 
\sphinxAtStartPar
orbitalv2,

\item {} 
\sphinxAtStartPar
LP (Lindstedt\sphinxhyphen{}Poincaré with smooth normal form),

\item {} 
\sphinxAtStartPar
LPHypernormalForm,

\item {} 
\sphinxAtStartPar
RegularPerturbation,

\item {} 
\sphinxAtStartPar
RegularPerturbationL2.

\end{itemize}

\sphinxAtStartPar
We refer to {[}\hyperlink{cite.references:id3}{Kuz21}{]} for the interpretations.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{messages}} Boolean to indicate if information about selected parameter should
be printed the console. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{correct}} Boolean to indicate if the predicted homoclinic solution should be
corrected with Newton. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\end{itemize}

\sphinxAtStartPar
Here we will use the default values for the Bogdanov\sphinxhyphen{}Takens option structure,
except we set the field \sphinxcode{\sphinxupquote{correct}} to \sphinxcode{\sphinxupquote{false}} and manually correct the
approximation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 2.842171e\PYGZhy{}14
BT normal form coefficients:
a=\PYGZhy{}1.119908e\PYGZhy{}03,	 b=\PYGZhy{}3.301195e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0616583
The initial half\PYGZhy{}return time T: 1221.71
The initial distance eps0: 3.339e\PYGZhy{}05
The initial distance eps1: 0.000109
\end{sphinxVerbatim}


\section{Correct initial prediction of homoclinic orbit near bt1 with Newton}
\label{\detokenize{Morris-Lecar:correct-initial-prediction-of-homoclinic-orbit-near-bt1-with-newton}}
\sphinxAtStartPar
Now that we have an initial prediction for the homoclinic orbit we
manually correct it using Newton. After the homoclinic predictor is corrected
with the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{newtcorr}} we use the function \sphinxcode{\sphinxupquote{bt\_rearr}}
(Bogdanov\sphinxhyphen{}Takens rearrange) to extract the homoclinic orbit and saddle point
from the homoclinic correction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Compare profiles of predicted and corrected solution (bt1)}
\label{\detokenize{Morris-Lecar:compare-profiles-of-predicted-and-corrected-solution-bt1}}
\sphinxAtStartPar
Using again the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{bt\_rearr}}, but now on the homoclinic
prediction \sphinxcode{\sphinxupquote{x1\_pred}} we compare the profiles of the predicted and corrected
homoclinic orbits. We see that they are indistinguishable. Note that to access
the mesh on which the homoclinic orbit is computed we need the global variable
\sphinxcode{\sphinxupquote{homds}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Profiles of the predicted and correction homolinic orbits.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}t\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_24_0}.png}


\section{Compare predictor and corrected solution in \protect\((V, w)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{Morris-Lecar:compare-predictor-and-corrected-solution-in-v-w-phase-space}}
\sphinxAtStartPar
Below we compare the predicted and corrected homoclinic orbit in \((V, w)\)
phase\sphinxhyphen{}space, as well as the predicted and corrected saddle point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8500}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.0980}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Orbits and saddle points of predicted and corrected in phase\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_26_0}.png}


\section{Continue homoclinic curve emanating from bt1}
\label{\detokenize{Morris-Lecar:continue-homoclinic-curve-emanating-from-bt1}}
\sphinxAtStartPar
Having obtain an initial approximation \sphinxcode{\sphinxupquote{{[}hom\_x, hom\_v{]}}}, where \sphinxcode{\sphinxupquote{homo\_v}} is the
tangent vector to the homoclinic curve pointing outwards from the
Bogdanov\sphinxhyphen{}Takens point, we can start continuation using the function \sphinxcode{\sphinxupquote{cont}}.
Since, we are not interested in bifurcations of the homoclinic
orbit, we disable the detection of homoclinic bifurcations \sphinxcode{\sphinxupquote{opt.Singularities = 0}}. This will reduce the computational cost. We also set the maximum number of
continuation steps.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1000}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
Current step size too small (point 477)
elapsed time  = 18.7 secs
npoints curve = 477
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters emanating from bt1}
\label{\detokenize{Morris-Lecar:compare-predicted-with-computed-parameters-emanating-from-bt1}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
in the smooth orbital normal form, see {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{} plot computed homoclinic parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent smooth orbital normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{1.8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Iapp}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{v3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}v\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 2.842171e\PYGZhy{}14
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_30_1}.png}


\section{Bifurcation diagram in \protect\((V,w)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{Morris-Lecar:bifurcation-diagram-in-v-w-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((V,w)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_32_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{Morris-Lecar:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Before proceeding with continuing the homoclinic orbits emanating from the
remaining three Bogdanov\sphinxhyphen{}Takens points we show that the estimate of the
amplitude is very conservative. Below we compute for a large range of
amplitudes the predicted and corrected homoclinic solutions and compare them in
phase space. We see that for this model even with an amplitude of \sphinxcode{\sphinxupquote{2}} the
predicted homoclinic orbit is still very close.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_34_0}.png}


\section{Continue homoclinic orbits from the remaining Bogdanov\sphinxhyphen{}Takens bifurcation points}
\label{\detokenize{Morris-Lecar:continue-homoclinic-orbits-from-the-remaining-bogdanov-takens-bifurcation-points}}
\sphinxAtStartPar
The code below continues and plots the homoclinic orbits emanating for each of the
remaining three detected Bogdanov\sphinxhyphen{}Takens points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{100}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{true}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom2\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2\PYGZus{}v\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2\PYGZus{}v\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 3.552714e\PYGZhy{}15
BT normal form coefficients:
a=\PYGZhy{}7.485863e\PYGZhy{}04,	 b=\PYGZhy{}2.961373e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0512162
The initial half\PYGZhy{}return time T: 1637.03
The initial distance eps0: 2.85469e\PYGZhy{}05
The initial distance eps1: 9.2748e\PYGZhy{}05
first point found
tangent vector to first point found

elapsed time  = 3.6 secs
npoints curve = 100
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_37_0}.png}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom3\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom3\PYGZus{}v\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{200}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br3}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom3\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom3\PYGZus{}v\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.136868e\PYGZhy{}13
BT normal form coefficients:
a=7.383698e\PYGZhy{}04,	 b=2.289394e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0845248
The initial half\PYGZhy{}return time T: 1284.91
The initial distance eps0: 4.5998e\PYGZhy{}05
The initial distance eps1: 0.000150094
first point found
tangent vector to first point found
Current step size too small (point 141)
elapsed time  = 5.9 secs
npoints curve = 141
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_39_0}.png}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt4}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt4}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt4}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom4\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom4\PYGZus{}v\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br4}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom4\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom4\PYGZus{}v\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.136868e\PYGZhy{}13
BT normal form coefficients:
a=2.766145e\PYGZhy{}04,	 b=1.513072e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0724949
The initial half\PYGZhy{}return time T: 2264.92
The initial distance eps0: 3.99117e\PYGZhy{}05
The initial distance eps1: 0.000129927
first point found
tangent vector to first point found

elapsed time  = 6.4 secs
npoints curve = 200
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt4}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt4}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_41_0}.png}


\section{Continue limit point from the first Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{Morris-Lecar:continue-limit-point-from-the-first-bogdanov-takens-point}}
\sphinxAtStartPar
Next we also continue the limit points emanating from the first and third
Bogdanov\sphinxhyphen{}Takens points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}LP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2000}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{lp1\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{200}\PYG{p}{;}
\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( 13.611147 0.023136 \PYGZhy{}227.131888 69.755737 )
(a,b)=(\PYGZhy{}1.119908e\PYGZhy{}03, \PYGZhy{}3.301195e\PYGZhy{}02)
label = CP, x = ( \PYGZhy{}10.103668 0.249467 92.105230 6.418208 )
c=5.229002e\PYGZhy{}05
label = BT, x = ( \PYGZhy{}27.149904 0.037007 48.225939 21.734143 )
(a,b)=(2.766145e\PYGZhy{}04, 1.513072e\PYGZhy{}02)

elapsed time  = 1.3 secs
npoints curve = 2000
first point found
tangent vector to first point found

elapsed time  = 0.2 secs
npoints curve = 200
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{lp2\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}LP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt3}\PYG{p}{.}\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2000}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{lp2\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{200}\PYG{p}{;}
\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( \PYGZhy{}11.152829 0.970208 519.625365 \PYGZhy{}63.401902 )
(a,b)=(7.383698e\PYGZhy{}04, 2.289394e\PYGZhy{}02)
label = CP, x = ( \PYGZhy{}2.672919 0.908521 457.907768 \PYGZhy{}37.108631 )
c=2.750363e\PYGZhy{}04
label = BT, x = ( 2.815616 0.974408 487.997703 \PYGZhy{}51.777429 )
(a,b)=(\PYGZhy{}7.485863e\PYGZhy{}04, \PYGZhy{}2.961373e\PYGZhy{}02)

elapsed time  = 1.1 secs
npoints curve = 2000
first point found
tangent vector to first point found

elapsed time  = 0.1 secs
npoints curve = 200
\end{sphinxVerbatim}


\section{Extract Cusp points}
\label{\detokenize{Morris-Lecar:extract-cusp-points}}
\sphinxAtStartPar
We see that during the continuation of the limit points two cusp (CP) points
were detected in addition to the four known Bogdanov\sphinxhyphen{}Takens bifurcation points.
We extract the cusp points in the code below.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cusp1\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{lp1\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{CP\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cusp2\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{lp2\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{CP\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Cusp1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{cusp1\PYGZus{}info}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Cusp2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{cusp2\PYGZus{}info}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Plot all curves in \protect\((V,w)\protect\)\sphinxhyphen{}phase\sphinxhyphen{}space}
\label{\detokenize{Morris-Lecar:plot-all-curves-in-v-w-phase-space}}
\sphinxAtStartPar
Here we plot all continued curves and singularities in \((V,w)\)\sphinxhyphen{}phase\sphinxhyphen{}space. To
get a detailed overview we split to plot into two parts.


\subsection{Upper part of the plot}
\label{\detokenize{Morris-Lecar:upper-part-of-the-plot}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{figure}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{+w}{ }
\PYG{n}{homColor}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{foldColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{Cusp2}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Cusp2}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{DisplayName\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Cusp point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf curve in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{21.7891}\PYG{+w}{   }\PYG{l+m+mf}{12.0474}\PYG{+w}{    }\PYG{l+m+mf}{0.8746}\PYG{+w}{    }\PYG{l+m+mf}{1.0000}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_48_0}.png}


\subsection{Lower part of the plot}
\label{\detokenize{Morris-Lecar:lower-part-of-the-plot}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{Cusp1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Cusp1}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}V\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Cusp point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf curve in \PYGZdl{}(V,w)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{50}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.05}\PYG{+w}{ }\PYG{l+m+mf}{0.45}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_50_0}.png}


\section{Bifurcation plot}
\label{\detokenize{Morris-Lecar:bifurcation-plot}}
\sphinxAtStartPar
Here we plot all continued curves and singularities in \((I_{app},v_3)\)
parameter space. As before, we split the plot into two parts to obtain a more
detailed overview.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{Cusp2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Cusp2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}v\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral Saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fold curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Cusp point\PYGZsq{}}\PYG{p}{,}\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bifurcation daigram in \PYGZdl{}(I\PYGZus{}\PYGZob{}app\PYGZcb{},v\PYGZus{}3)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{456.5097}\PYG{+w}{  }\PYG{l+m+mf}{519.9544}\PYG{+w}{  }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{63.9705}\PYG{+w}{  }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{34.7564}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_52_0}.png}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp2\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br3}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br4}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{Cusp1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{Cusp1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint3}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint4}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}v\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral Saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fold curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Cusp point\PYGZsq{}}\PYG{p}{,}\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bifurcation daigram in \PYGZdl{}(I\PYGZus{}\PYGZob{}app\PYGZcb{},v\PYGZus{}3)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{231.3697}\PYG{+w}{  }\PYG{l+m+mf}{104.5793}\PYG{+w}{    }\PYG{l+m+mf}{4.0404}\PYG{+w}{   }\PYG{l+m+mf}{73.0235}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_53_0}.png}


\section{Convergence plot}
\label{\detokenize{Morris-Lecar:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Morris\PYGZhy{}Lecar model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Morris-Lecar_55_0}.png}


\part{CO\sphinxhyphen{}oxidation}


\chapter{Generate system files for CO\sphinxhyphen{}oxidation in a platinum model}
\label{\detokenize{CO-oxidationGenSym:generate-system-files-for-co-oxidation-in-a-platinum-model}}\label{\detokenize{CO-oxidationGenSym::doc}}
\sphinxAtStartPar
In this script the \sphinxstylestrong{system files} for the CO\sphinxhyphen{}oxidation model
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
z &= 1 - x - y - s, \\
\dot x &= 2k_1z^2 - 2k_{-1}x^2 - k_3xy, \\
\dot y &= k_2z - k_{-2}y - k_3xy, \\
\dot s &= k_4(z - \lambda s).
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
are generated. These are used in the {\hyperref[\detokenize{CO-oxidation::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{CO\sphinxhyphen{}oxidation.ipynb}}}}
demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{CO-oxidationGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{CO-oxidationGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{CO\PYGZus{}oxidation\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{CO-oxidationGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{y\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{  }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{km1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{km2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k4\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{lambda\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{CO-oxidationGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{k1}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{CO-oxidationGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{z}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{y}\PYG{o}{\PYGZhy{}}\PYG{n}{s}\PYG{p}{;}
\PYG{n}{dx\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{k1}\PYG{o}{*}\PYG{n}{z}\PYGZca{}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{km1}\PYG{o}{*}\PYG{n}{x}\PYGZca{}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{k3}\PYG{o}{*}\PYG{n}{x}\PYG{o}{*}\PYG{n}{y}\PYG{p}{;}
\PYG{n}{dy\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{k2}\PYG{o}{*}\PYG{n}{z}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{km2}\PYG{o}{*}\PYG{n}{y}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{k3}\PYG{o}{*}\PYG{n}{x}\PYG{o}{*}\PYG{n}{y}\PYG{p}{;}
\PYG{n}{ds\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{k4}\PYG{o}{*}\PYG{p}{(}\PYG{n}{z}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{lambda}\PYG{o}{*}\PYG{n}{s}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dx\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dy\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ds\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{CO-oxidationGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{CO-oxidationGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{CO\sphinxhyphen{}oxidation in a platinum model.}
\label{\detokenize{CO-oxidation:co-oxidation-in-a-platinum-model}}\label{\detokenize{CO-oxidation::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id10}{Khi90}{]}, {[}\hyperlink{cite.references:id11}{BIK78}{]},  {[}\hyperlink{cite.references:id9}{Bey94}{]} the following
chemical model is considered
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
z &= 1 - x - y - s, \\
\dot x &= 2k_1z^2 - 2k_{-1}x^2 - k_3xy, \\
\dot y &= k_2z - k_{-2}y - k_3xy, \\
\dot s &= k_4(z - \lambda s).
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
The model describes CO\sphinxhyphen{}oxidation in platinum.  Here \(x, y, z\) and \(s\) are the
concentrations with \(x + y + z + s = 1\) and \(k_i\) stand for the reaction rate
constants.


\section{Overview}
\label{\detokenize{CO-oxidation:overview}}
\sphinxAtStartPar
In this demo we will revisit and extend the results from {[}\hyperlink{cite.references:id5}{BAH15}{]},
using the new homoclinic predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}. Thus, we will:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Compute a curve of equilibria, parametrized by \(k_2\).

\item {} 
\sphinxAtStartPar
Detect two limit points (LP).

\item {} 
\sphinxAtStartPar
Start continuation from the limit points in two parameters \((\lambda,k_2)\).

\item {} 
\sphinxAtStartPar
Detect two Bogdanov\sphinxhyphen{}Takens points.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic bifurcation curve emanating from the
Bogdanov\sphinxhyphen{}Takens points in two parameters \((\lambda,k_2)\).

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the first Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Create a convergence plot comparing the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{CO-oxidation:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultLineMarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{CO-oxidation:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the script {\hyperref[\detokenize{CO-oxidationGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{CO\sphinxhyphen{}oxidationGenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{CO\PYGZus{}oxidation}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define equilibrium}
\label{\detokenize{CO-oxidation:define-equilibrium}}
\sphinxAtStartPar
We manually define an equilibrium at
\begin{equation}\label{equation:CO-oxidation:eq:COoxidation:equilibrium}
\begin{split}(x,y,s) = (0.00295, 0.76211, 0.1678),\end{split}
\end{equation}
\sphinxAtStartPar
with parameter values \(k_1=2.5, k_{-1} = 1, k_3 = 10, k_2 = 0, k_{-2} = 0.1, k_4 = 0.0675\) and \(\lambda = 1\).

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{km1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{km2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k4\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{lambda\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{2.5}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{km1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k3}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{km2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.1}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k4}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.0675}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{lambda}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{x}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.00295}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m+mf}{0.76211}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m+mf}{0.1678}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue equilibrium in parameter \protect\(k_2\protect\)}
\label{\detokenize{CO-oxidation:continue-equilibrium-in-parameter-k-2}}
\sphinxAtStartPar
To continue the equilibrium \eqref{equation:CO-oxidation:eq:COoxidation:equilibrium} in parameter
\(k_2\), we first need to obtain a tangent vector to the curve. This is done by
the function \sphinxcode{\sphinxupquote{init\_EP\_EP}}. Then we use the function \sphinxcode{\sphinxupquote{contset}} to obain a
\sphinxstylestrong{struct} containing a list of options which is passed on to the continuer. By
adjusting the values of the fields of the \sphinxcode{\sphinxupquote{opt}} \sphinxstylestrong{struct} we set the minimum,
initial and maximum step sizes, as well as the direction in which to
continue (\sphinxcode{\sphinxupquote{opt.Backward}}), i.e. in the direction of the obtained tangent vector
\sphinxcode{\sphinxupquote{v1\_pred}}, or its negative. We also set the maximum number of points to
continue and weather or not to detect bifurcation points (\sphinxcode{\sphinxupquote{opt.Singularities}})
on the equilibrium curve. For more information about all options available to
the \sphinxstyleemphasis{MatCont} continuer and the continuation process in general, we refer to
{[}\hyperlink{cite.references:id14}{DGK+08}{]}.

\sphinxAtStartPar
Finally, we continue the curve using the function \sphinxcode{\sphinxupquote{cont}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}EP\PYGZus{}EP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MinStepsize}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.00001}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{InitStepsize}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.0001}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{      }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{equilibrium}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = LP, x = ( 0.014843 0.696880 0.144138 1.201115 )
a=1.931461e+00
Neutral saddle
label = H , x = ( 0.016833 0.679849 0.151659 1.202834 )
Neutral saddle
label = H , x = ( 0.116822 0.318191 0.282493 1.428482 )
label = LP, x = ( 0.117575 0.316719 0.282853 1.428493 )
a=\PYGZhy{}2.384097e+01
label = H , x = ( 0.916533 \PYGZhy{}0.174248 0.128858 \PYGZhy{}12.529060 )
First Lyapunov coefficient = \PYGZhy{}2.462095e+00

elapsed time  = 0.3 secs
npoints curve = 300
\end{sphinxVerbatim}

\sphinxAtStartPar
There are two limit points detected (LP), two neutral saddles (H) and one Hopf
bifurcation point (H). The \sphinxstylestrong{array struct} \sphinxcode{\sphinxupquote{eqbr\_bif\_data}} contains
information about the detected bifurcation points. We use this to extract the
index of the detected bifurcation points on the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}. The
equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}} is just a two dimensional array. Each column
consists of a point on the curve. The first three rows contain the point
\((x,y,s)\) while the last row contains the parameter \(k_2\).

\sphinxAtStartPar
Below we plot the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}, together with the detected Hopf and
limit points, in \((s,k_2)\)\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n}{hopfPointInfo}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{limitPointsInfo}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{HopfPoint}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{hopfPointInfo}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{limitpoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{limitPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{limitpoint2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{limitPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{HopfPoint}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{HopfPoint}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{limitpoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{limitpoint1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{limitpoint2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{limitpoint2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}k\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}s\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit points\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve in \PYGZdl{}(s,k\PYGZus{}2)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{16}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{l+m+mf}{0.05}\PYG{+w}{ }\PYG{l+m+mf}{0.35}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_11_0}.png}


\section{Construct limit point}
\label{\detokenize{CO-oxidation:construct-limit-point}}
\sphinxAtStartPar
To continue the first limit point in the parameters \(k_2\) and \(\lambda\) we
construct a new point \sphinxcode{\sphinxupquote{lp}} containing the position and parameter values. These
are needed to obtain an initial tangent vector \sphinxhyphen{} using the function
\sphinxcode{\sphinxupquote{init\_LP\_LP}} \sphinxhyphen{} in the full phase/parameter space. Since, from now on, we will
be using the continuation parameter \(k_2\) and \(\lambda\) frequently we assigned
these parameters to the variable \sphinxcode{\sphinxupquote{ap}} (active parameters).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k2}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{lambda}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} continuation parameters}
\PYG{n}{lp1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{;}
\PYG{n}{lp1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{limitPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{lp1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{limitPointsInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}LP\PYGZus{}LP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1}\PYG{p}{.}\PYG{n}{par}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue limit point in parameters \protect\(k\protect\) and \protect\(T_m\protect\)}
\label{\detokenize{CO-oxidation:continue-limit-point-in-parameters-k-and-t-m}}
\sphinxAtStartPar
We continue the limit point curve using again the function \sphinxcode{\sphinxupquote{cont}}. We use the
same continuation options as before defined below in the \sphinxstylestrong{struct} \sphinxcode{\sphinxupquote{opt}},
except for the direction of continuation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{TestTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}12}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxTestIters}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{lp\PYGZus{}br1}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( 0.016337 0.638410 0.200456 1.161199 0.722339 )
(a,b)=(\PYGZhy{}4.822565e\PYGZhy{}02, \PYGZhy{}1.937633e+00)
label = CP, x = ( 0.035941 0.352005 0.451370 1.006408 0.355991 )
c=3.627887e\PYGZhy{}01
label = BT, x = ( 0.115909 0.315467 0.288437 1.417628 0.971398 )
(a,b)=(\PYGZhy{}8.378444e\PYGZhy{}02, \PYGZhy{}2.136280e+00)

elapsed time  = 0.4 secs
npoints curve = 300
\end{sphinxVerbatim}

\sphinxAtStartPar
There are two Bogdanov\sphinxhyphen{}Takens bifurcation points (BT) detected on the limit
point branch \sphinxcode{\sphinxupquote{lp\_br1}}. The second detected Bogdanov\sphinxhyphen{}Takens point coincides with
the Bogdanov\sphinxhyphen{}Takens point teated in {[}\hyperlink{cite.references:id9}{Bey94}{]}.

\sphinxAtStartPar
As with the limit points, information about the detected bifurcation points in
stored in the \sphinxstylestrong{struct array} \sphinxcode{\sphinxupquote{lp\_br1\_bif}}. Below we extract the
Bogdanov\sphinxhyphen{}Takens bifurcation points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{BT\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1  (bt1)}
\label{\detokenize{CO-oxidation:initial-prediction-of-homoclinic-orbit-near-bogdanov-takens-point-1-bt1}}
\sphinxAtStartPar
To obtain an initial approximation to the homoclinic solution near the
Bogdanov\sphinxhyphen{}Takens point we use the function \sphinxcode{\sphinxupquote{init\_BT\_Hom}}. Its arguments are the
system file (\sphinxcode{\sphinxupquote{odefile}}), the Bogdanov\sphinxhyphen{}Takens point (\sphinxcode{\sphinxupquote{bt}}) as defined above, the
unfolding parameters  (\sphinxcode{\sphinxupquote{ap}}) and an options structure (\sphinxcode{\sphinxupquote{BToptions}}). The options
structure created with the function \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} contains the following
fields:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ntst}} Number of mesh intervals with a default value of 40.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ncol}} Number of collocation points used in each interval with a default of 4.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{extravec}} Three dimensional boolean row vector indicating which \sphinxstyleemphasis{homoclinic
parameters} are selected to be free. The first component refers to the
half\sphinxhyphen{}return time, while the second and third components refer to the
distances from the saddle point to the first, respectively, the last point on
the homoclinic orbit. The default value is set to \sphinxcode{\sphinxupquote{{[}0 1 1{]}}}. Thus, the
half\sphinxhyphen{}return time \sphinxcode{\sphinxupquote{T}} is fixed.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{order}} The order of the homoclinic approximation used with a default value
of 3.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{amplitude}} Desired amplitude of the homoclinic solution. If left empty then
a conservative estimate is made, see {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{TTolerance}} Desired distance between the last point on the homoclinic
solution and the saddle point. This should at least be smaller than the
amplitude. If left empty it is defined by \sphinxcode{\sphinxupquote{amplitude*1.0e\sphinxhyphen{}03}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{HigherOrderTimeReparametrization}} Boolean to indicate if a higher order
approximation to the nonlinear time transformation in the Lindstedt\sphinxhyphen{}Poincaré
method should be used. This should always be set to \sphinxcode{\sphinxupquote{1}}.  It is only
implemented for demonstration purposes.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{method}} Selects the method to be used to approximate the homoclinic
solution. The different methods available are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
orbital (the default),

\item {} 
\sphinxAtStartPar
orbitalv2,

\item {} 
\sphinxAtStartPar
LP (Lindstedt\sphinxhyphen{}Poincaré with smooth normal form),

\item {} 
\sphinxAtStartPar
LPHypernormalForm,

\item {} 
\sphinxAtStartPar
RegularPerturbation,

\item {} 
\sphinxAtStartPar
RegularPerturbationL2.

\end{itemize}

\sphinxAtStartPar
We refer to {[}\hyperlink{cite.references:id3}{Kuz21}{]} for the interpretations.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{messages}} Boolean to indicate if information about selected parameter should
be printed the console. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{correct}} Boolean to indicate if the predicted homoclinic solution should be
corrected with Newton. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\end{itemize}

\sphinxAtStartPar
Here we will use the default values for the Bogdanov\sphinxhyphen{}Takens option structure,
except we set the field \sphinxcode{\sphinxupquote{correct}} to \sphinxcode{\sphinxupquote{false}} and manually correct the
approximation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 5.023537e\PYGZhy{}11
BT normal form coefficients:
a=\PYGZhy{}4.822565e\PYGZhy{}02,	 b=\PYGZhy{}1.937633e+00
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.000770702
The initial half\PYGZhy{}return time T: 1661.8
The initial distance eps0: 4.36004e\PYGZhy{}07
The initial distance eps1: 1.41437e\PYGZhy{}06
\end{sphinxVerbatim}


\section{Correct initial prediction of homoclinic orbit near bt1 with Newton}
\label{\detokenize{CO-oxidation:correct-initial-prediction-of-homoclinic-orbit-near-bt1-with-newton}}
\sphinxAtStartPar
Now that we have an initial prediction for the homoclinic orbit we
manually correct it with Newton. After the homoclinic predictor is corrected
with the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{newtcorr}} we use the function \sphinxcode{\sphinxupquote{bt\_rearr}}
(Bogdanov\sphinxhyphen{}Takens rearrange) to extract the homoclinic orbit and saddle
point from the homoclinic correction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Compare profiles of predicted and corrected solution (bt1)}
\label{\detokenize{CO-oxidation:compare-profiles-of-predicted-and-corrected-solution-bt1}}
\sphinxAtStartPar
Using again the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{bt\_rearr}}, but now on the homoclinic
prediction \sphinxcode{\sphinxupquote{x1\_pred}} we compare the profiles of the predicted and corrected
homoclinic orbits. We see that they are indistinguishable.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{p}{[}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Profiles of the predicted and correction homolinic orbits.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{fontsize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{interpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{latex\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}y\PYGZdl{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{fontsize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{interpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{latex\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}t\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}s\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_23_0}.png}


\section{Compare predictor and corrected solution in \protect\((x, y)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{CO-oxidation:compare-predictor-and-corrected-solution-in-x-y-phase-space}}
\sphinxAtStartPar
Below we compare the predicted and corrected homoclinic orbit in \((x, y)\)
phase\sphinxhyphen{}space, as well as the predicted and corrected saddle point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8500}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.0980}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}y\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Orbits and saddle points of predicted and corrected in phase\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_25_0}.png}


\section{Continue homoclinic curve emanating from Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{CO-oxidation:continue-homoclinic-curve-emanating-from-bogdanov-takens-point}}
\sphinxAtStartPar
Having obtain an initial approximation \sphinxcode{\sphinxupquote{{[}hom\_x, hom\_v{]}}}, where \sphinxcode{\sphinxupquote{homo\_v}} is the
tangent vector to the homoclinic curve pointing outwards from the
Bogdanov\sphinxhyphen{}Takens point, we can start continuation using the function \sphinxcode{\sphinxupquote{cont}}.
Since, we are not interested in bifurcations of the homoclinic
orbit, we disable the detection of homoclinic bifurcations
\sphinxcode{\sphinxupquote{opt.Singularities = 0}}. This will reduce the computational cost. We also set
the maximum number of continuation steps.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MinStepsize}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}06}\PYG{p}{;}\PYG{+w}{ }
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{InitStepsize}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}03}\PYG{p}{;}\PYG{+w}{ }
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}02}\PYG{p}{;}\PYG{+w}{ }
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found

elapsed time  = 13.6 secs
npoints curve = 300
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters emanating from bt1}
\label{\detokenize{CO-oxidation:compare-predicted-with-computed-parameters-emanating-from-bt1}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm}} to obtain the
parameter\sphinxhyphen{}dependent normal form coefficients and the coefficients between the
parameters of the system and the parameters on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{1.8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{lambda}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}k\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}lambda\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 5.023537e\PYGZhy{}11
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_29_1}.png}


\section{Bifurcation diagram in \protect\((x,s)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{CO-oxidation:bifurcation-diagram-in-x-s-phase-space}}
\sphinxAtStartPar
To obtain an impression of the homoclinic solutions we plot the computed
homoclinic orbits in \((x,s)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{}plot naive}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}s\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x,s)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_31_0}.png}


\section{Continue homoclinic curve emanating from Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{CO-oxidation:id12}}
\sphinxAtStartPar
We continue the homoclinic orbit as usual with the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{cont}}.
However, since we already corrected the initial prediction to the homoclinic
orbits, we use this correction as an initial starting point of continuation in
stead of the predictor. If one isn’t interested in the correction of the
initial point, the prediction could be used directly as argument to \sphinxcode{\sphinxupquote{cont}}.
Lastly, since, here, we are not interested in bifurcations of the homoclinic
orbit, we disable the detection of homoclinic bifurcations. This will
reduce the computational cost.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt2\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x2\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v2\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x2\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v2\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 2.761569e\PYGZhy{}11
BT normal form coefficients:
a=\PYGZhy{}8.378444e\PYGZhy{}02,	 b=\PYGZhy{}2.136280e+00
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.00110154
The initial half\PYGZhy{}return time T: 1052.82
The initial distance eps0: 6.38083e\PYGZhy{}07
The initial distance eps1: 2.06064e\PYGZhy{}06
first point found
tangent vector to first point found

elapsed time  = 11.2 secs
npoints curve = 300
\end{sphinxVerbatim}


\section{Continue Hopf point from the first Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{CO-oxidation:continue-hopf-point-from-the-first-bogdanov-takens-point}}
\sphinxAtStartPar
We convert the first Bogdanov\sphinxhyphen{}Takens point into a Hopf point in order to
start continuation of the Hopf bifurcation curve.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}H}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
We continue the Hopf point using the function \sphinxcode{\sphinxupquote{cont}}. Then we try to filter out
the neutral saddle points by inspecting the eigenvalues.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{2000}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Eigenvalues}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eigenvalues}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{hopf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{neutral\PYGZus{}saddle\PYGZus{}br}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n+nb}{imag}\PYG{p}{(}\PYG{n}{eigenvalues}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{l+m+mf}{0.00001}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf\PYGZus{}br\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n+nb}{imag}\PYG{p}{(}\PYG{n}{eigenvalues}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}=}\PYG{+w}{ }\PYG{l+m+mf}{0.00001}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  2.031561e\PYGZhy{}16.
\PYGZgt{} In nf\PYGZus{}H (line 27)
In hopf\PYGZgt{}testf (line 150)
In cont\PYGZgt{}EvalTestFunc (line 810)
In cont (line 506)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  6.039544e\PYGZhy{}17.
\PYGZgt{} In nf\PYGZus{}H (line 28)
In hopf\PYGZgt{}testf (line 150)
In cont\PYGZgt{}EvalTestFunc (line 810)
In cont (line 506)

label = BT, x = ( 0.016337 0.638410 0.200456 1.161199 0.722339 0.000000 )
(a,b)=(\PYGZhy{}4.822565e\PYGZhy{}02, \PYGZhy{}1.937633e+00)
label = BT, x = ( 0.115909 0.315467 0.288437 1.417628 0.971398 0.000000 )
(a,b)=(8.378444e\PYGZhy{}02, 2.136280e+00)
label = GH, x = ( 0.064311 0.211095 0.554870 0.924255 0.305879 0.003512 )
l2=\PYGZhy{}2.401234e+02
label = GH, x = ( 0.018022 0.368238 0.497968 0.891319 0.232487 0.003324 )
l2=\PYGZhy{}7.769003e+02
Closed curve detected at step 1241

elapsed time  = 1.3 secs
npoints curve = 1241
\end{sphinxVerbatim}

\sphinxAtStartPar
We see that in addition to the two Bogdanov\sphinxhyphen{}Takens points already detected
before, there are also two generalized Hopf points (GH) detected.


\section{Bifurcation diagram in phase\sphinxhyphen{}space \protect\((x,s)\protect\)}
\label{\detokenize{CO-oxidation:bifurcation-diagram-in-phase-space-x-s}}
\sphinxAtStartPar
Below we plot the computed homoclinic orbits in \((x,s)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{colormap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homColor}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{colormap}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{colormap}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{foldColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{colormap}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br\PYGZus{}corrected}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}corrected}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{neutral\PYGZus{}saddle\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{neutral\PYGZus{}saddle\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}s\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point branch\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf branch\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Neutral saddle branch\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x,s)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.17}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.7}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_39_0}.png}


\section{Bifurcation diagram in parameter\sphinxhyphen{}space \protect\((k_2, \lambda)\protect\)}
\label{\detokenize{CO-oxidation:bifurcation-diagram-in-parameter-space-k-2-lambda}}
\sphinxAtStartPar
We finish this notebook by plotting the computed homoclinic orbits in \((x,s)\) phase\sphinxhyphen{}space.

\sphinxAtStartPar
Below we extract the cusp bifurcation point and the generalized Hopf points on
the limit point branch and Hopf branch respectively.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cusp\PYGZus{}point\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{CP\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{genh\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{GH\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{cusp}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{cusp\PYGZus{}point\PYGZus{}info}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{genh1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{genh\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{genh2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{genh\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br\PYGZus{}corrected}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}corrected}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot homoclinic curves}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic\PYGZus{}br2}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{lambda}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt2}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{lambda}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{cusp}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cusp}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{genh1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{genh1}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{genh2}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{genh2}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis, labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}k\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}lambda\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}\PYG{c}{ }
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens points\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Cusp point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Generalized Hopf point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.7130}\PYG{+w}{    }\PYG{l+m+mf}{1.4320}\PYG{+w}{    }\PYG{l+m+mf}{0.1413}\PYG{+w}{    }\PYG{l+m+mf}{1.0081}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_42_0}.png}


\section{Convergence plot}
\label{\detokenize{CO-oxidation:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultLineMarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{7}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{options}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{CO\PYGZhy{}oxidation model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{CO-oxidation_44_1}.png}


\part{Predator Prey}


\chapter{Generate system files for predator\sphinxhyphen{}prey system with constant rate harvesting}
\label{\detokenize{PredatorPreyGenSym:generate-system-files-for-predator-prey-system-with-constant-rate-harvesting}}\label{\detokenize{PredatorPreyGenSym::doc}}
\sphinxAtStartPar
In this script the \sphinxstylestrong{system files} for the predator\sphinxhyphen{}prey system given by
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot x &= rx\left(1-\frac x k\right) - y \frac x {e+x}, \\
\dot y &= y\left(-d+\frac x {e+x}\right) - h, \\
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
are generated. These are used in the {\hyperref[\detokenize{PredatorPrey::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{predator prey}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{PredatorPreyGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Utilities}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if} \PYG{n}{isOctave}
  \PYG{n}{pkg} \PYG{n}{load} \PYG{n}{symbolic} \PYG{o}{\PYGZpc{}} \PYG{k}{for} \PYG{n}{GNU} \PYG{n}{Octave}
\PYG{n}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{PredatorPreyGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PredatorPrey}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{PredatorPreyGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{h}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{PredatorPreyGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{alpha}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}       \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{n}{symbol} \PYG{k}{for} \PYG{n}{alpha} \PYG{o+ow}{and} \PYG{n}{delta}
\PYG{n}{par}\PYG{o}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}  \PYG{o}{\PYGZpc{}} \PYG{n}{now} \PYG{n}{alpha1} \PYG{o+ow}{is} \PYG{n}{par}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}    \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{n}{symbol} \PYG{k}{for} \PYG{n}{alpha} \PYG{o+ow}{and} \PYG{n}{delta}
\PYG{n}{coords}\PYG{o}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;} \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{n} \PYG{n}{vector} \PYG{k}{for} \PYG{n}{coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{PredatorPreyGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{r} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{e} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{PredatorPreyGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dx\PYGZus{}dt} \PYG{o}{=} \PYG{n}{r}\PYG{o}{*}\PYG{n}{x}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{x}\PYG{o}{/}\PYG{n}{k}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{y}\PYG{o}{*}\PYG{n}{x}\PYG{o}{/}\PYG{p}{(}\PYG{n}{e}\PYG{o}{+}\PYG{n}{x}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dy\PYGZus{}dt} \PYG{o}{=} \PYG{n}{y}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{d}\PYG{o}{+}\PYG{n}{x}\PYG{o}{/}\PYG{p}{(}\PYG{n}{e}\PYG{o}{+}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{h}\PYG{p}{;}
\PYG{n}{system} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dx\PYGZus{}dt}\PYG{p}{;} \PYG{n}{dy\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{PredatorPreyGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc} \PYG{o}{=} \PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
  \PYG{n}{system}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}   \PYG{o}{\PYGZpc{}} \PYG{n}{n} \PYG{n}{x} \PYG{l+m+mi}{1} \PYG{n}{array} \PYG{n}{of} \PYG{n}{derivative} \PYG{n}{symbolic} \PYG{n}{expressions}
  \PYG{n}{coords}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{n} \PYG{n}{array} \PYG{n}{of} \PYG{n}{symbols} \PYG{k}{for} \PYG{n}{states}
  \PYG{n}{par}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}      \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{np} \PYG{n}{array} \PYG{n}{of} \PYG{n}{symbols} \PYG{n}{used} \PYG{k}{for} \PYG{n}{parameters}
  \PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{n}{argument} \PYG{n}{specifying} \PYG{n}{the} \PYG{n}{system} \PYG{n}{name}
  \PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Systems/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{n}{directory} \PYG{n}{to} \PYG{n}{save} \PYG{n}{to} \PYG{n}{file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{PredatorPreyGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc} \PYG{o}{=} \PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,} \PYG{n}{system}\PYG{p}{,} \PYG{n}{coords}\PYG{p}{,} \PYG{n}{par}\PYG{p}{,} \PYG{n}{order}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
        \PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Systems/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Predator\sphinxhyphen{}prey system with constant harvesting rate}
\label{\detokenize{PredatorPrey:predator-prey-system-with-constant-harvesting-rate}}\label{\detokenize{PredatorPrey::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id7}{BS79}{]} the following predator\sphinxhyphen{}prey system with constant
harvesting rate is considered
\begin{equation}\label{equation:PredatorPrey:eq:predatorpray}
\begin{split}\begin{cases}
\begin{aligned}
\dot x &= rx\left(1-\frac x k\right) - y \frac x {e+x}, \\
\dot y &= y\left(-d+\frac x {e+x}\right) - h. \\
\end{aligned}
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
Here the parameters have the following interpretations:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(k\) is the carrying capacity of the prey population,

\item {} 
\sphinxAtStartPar
\(d\) is the death rate of the predator,

\item {} 
\sphinxAtStartPar
\(r\) is the intrinsic growth rate of the prey population,

\item {} 
\sphinxAtStartPar
and \(h\) is the harvesting rate.

\end{itemize}

\sphinxAtStartPar
The function \(x \mapsto \frac{x}{e+x}\) is often called the functional response
of Holling type II. The authors in {[}\hyperlink{cite.references:id8}{XR99}{]} show the existence of a
Bogdanov\sphinxhyphen{}Takens bifurcation in \eqref{equation:PredatorPrey:eq:predatorpray} and sketch the global
bifurcation diagram including the homoclinic curve which emanates from the
Bogdanov\sphinxhyphen{}Takens point.  We study the occurrence of homoclinic orbits that
emanate from the computed Bogdanov\sphinxhyphen{}Takens point using \sphinxstyleemphasis{MatCont}.


\section{Overview}
\label{\detokenize{PredatorPrey:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Define an analytically derived Bogdanov\sphinxhyphen{}Takens point.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic branch emanating from the
Bogdanov\sphinxhyphen{}Takens point in two parameters \((d,h)\) using the new homoclinic
smooth orbital predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{PredatorPrey:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPointCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{PredatorPrey:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{PredatorPreyGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{PredatorPreyGenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{PredatorPrey}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point manually}
\label{\detokenize{PredatorPrey:define-bogdanov-takens-point-manually}}
\sphinxAtStartPar
There are two equilibrium points in \eqref{equation:PredatorPrey:eq:predatorpray}. One is given by
\begin{equation}\label{equation:PredatorPrey:eq:predatorpray_bt_point}
\begin{split}\begin{aligned}
\begin{cases}
x_1 &= \frac{\sqrt{9 d^2+8 d h-12 d-8 h+4}-d+2}{2-2 d}, \\
x_2 &= -\frac{\sqrt{9 d^2+8 d h-12 d-8 h+4}+d (4 h+3)-4 h-2}{4 (d-1)^2}.
\end{cases}
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
By evaluating the Jacobian of \eqref{equation:PredatorPrey:eq:predatorpray}
\begin{equation*}
\begin{split}
J = \begin{pmatrix}
 \frac{x y}{(x+1)^2}-\frac{y}{x+1}-x+1 & -\frac{x}{x+1} \\
 \left(\frac{1}{x+1}-\frac{x}{(x+1)^2}\right) y & \frac{x}{x+1}-d \\
\end{pmatrix}
\end{split}
\end{equation*}
\sphinxAtStartPar
at the equilibrium \eqref{equation:PredatorPrey:eq:predatorpray_bt_point} and subsequently solving for
a double zero of the characteristic equation of \(J\) for \((d,h)\) yields
\begin{equation*}
\begin{split}
\begin{aligned}
d &= \frac{1}{9} \left(8-\frac{11}{\sqrt[3]{548-18 \sqrt{894}}}-\frac{\sqrt[3]{274-9 \sqrt{894}}}{2^{2/3}}\right), \\
h &= \frac{93\ 2^{2/3}-9 \sqrt[6]{2} \sqrt{447}-975 \sqrt[3]{\frac{2}{274-9 \sqrt{894}}}+\frac{36\ 2^{5/6} \sqrt{447}}{\sqrt[3]{274-9 \sqrt{894}}}+30 \sqrt[3]{274-9 \sqrt{894}}}{88\ 2^{2/3}+16 \sqrt[3]{274-9 \sqrt{894}}+8 \sqrt[3]{2} \left(274-9 \sqrt{894}\right)^{2/3}}
.
\end{aligned}
\end{split}
\end{equation*}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{d}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{11}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{548}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{18}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{h}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{93}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{447.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{975}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{36}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{447.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{30}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{88}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{l+m+mf}{2.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{274}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{9}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+m+mf}{894.}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{n}{d}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{+}\PYG{n}{d}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{y}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{+}\PYG{n}{d}\PYG{p}{)}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{18}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{d}\PYG{o}{+}\PYG{l+m+mi}{9}\PYG{o}{.*}\PYG{n}{d}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{x}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{y}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{d}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{h}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{h\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{PredatorPrey:continue-homoclinic-curve-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{d}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{h}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{200}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 9.992007e\PYGZhy{}16
BT normal form coefficients:
a=1.798257e\PYGZhy{}01,	 b=\PYGZhy{}3.782866e\PYGZhy{}01
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0753982
The initial half\PYGZhy{}return time T: 86.8246
The initial distance eps0: 0.000144111
The initial distance eps1: 4.47679e\PYGZhy{}05
first point found
tangent vector to first point found
Current step size too small (point 118)
elapsed time  = 6.3 secs
npoints curve = 118
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters}
\label{\detokenize{PredatorPrey:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
of the smooth orbital normal form on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}. By using the transformation \(K\) as given in
{[}\hyperlink{cite.references:id2}{AHGKM16}{]} where \(K_{11}\) is not included for the second order
approximation we see that including \(K_{11}\) as done in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
does indeed lead to a better approximation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{alphaSecondOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{n}{alphaSecondOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{alphaSecondOrder}\PYG{p}{;}
\PYG{n}{alpha2016}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{alpha2016}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{alpha2016}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{alphaSecondOrder}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{alphaSecondOrder}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{7}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{alpha2016}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{alpha2016}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{d}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{h}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}d\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Second order homoclinc predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Second order homoclinic predictor 2016\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Thrid order homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1898}\PYG{+w}{    }\PYG{l+m+mf}{0.2596}\PYG{+w}{    }\PYG{l+m+mf}{0.2169}\PYG{+w}{    }\PYG{l+m+mf}{0.3137}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{PredatorPrey_12_0}.png}


\section{Bifurcation diagram in \protect\((x,y)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{PredatorPrey:bifurcation-diagram-in-x-y-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((x,y)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}y\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x,y)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{PredatorPrey_14_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{PredatorPrey:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a large range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. We see that even with an
amplitude of \sphinxcode{\sphinxupquote{1}} the predicted homoclinic orbit is still very close.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}y\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{PredatorPrey_16_0}.png}


\section{Convergence plot}
\label{\detokenize{PredatorPrey:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Predator\PYGZhy{}prey model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{PredatorPrey_18_1}.png}


\part{Bazykin}


\chapter{Generate system files for the Bazykin’s predator\sphinxhyphen{}prey system}
\label{\detokenize{BazykinGenSym:generate-system-files-for-the-bazykin-s-predator-prey-system}}\label{\detokenize{BazykinGenSym::doc}}
\sphinxAtStartPar
This Jupyter Notebook generates the \sphinxstylestrong{system files} for the following predator\sphinxhyphen{}prey
ecosystem
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot x_1 &= x_1 - \frac{x_1 x_2}{1+\alpha x_1} - \epsilon x_1^2, \\
\dot x_2 &= -\gamma x_2 + \frac{x_1 x_2}{1+\alpha x_1} - \delta x_2^2. \\
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
These are used in the {\hyperref[\detokenize{Bazykin::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Bazykin’s predator\sphinxhyphen{}prey demo}}}}.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{BazykinGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Define the system name}
\label{\detokenize{BazykinGenSym:define-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bazykin\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{BazykinGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x2\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{alpha\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{delta\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{BazykinGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{alpha}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{BazykinGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{gamma}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{epsilon}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.01}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{BazykinGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dx1\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x1}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{x1}\PYG{o}{*}\PYG{n}{x2}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n+nb}{alpha}\PYG{o}{*}\PYG{n}{x1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{epsilon}\PYG{o}{*}\PYG{n}{x1}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{dx2\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n+nb}{gamma}\PYG{o}{*}\PYG{n}{x2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{x1}\PYG{o}{*}\PYG{n}{x2}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n+nb}{alpha}\PYG{o}{*}\PYG{n}{x1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{delta}\PYG{o}{*}\PYG{n}{x2}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dx1\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dx2\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{BazykinGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{BazykinGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Bazykin’s predator\sphinxhyphen{}prey ecosystem}
\label{\detokenize{Bazykin:bazykin-s-predator-prey-ecosystem}}\label{\detokenize{Bazykin::doc}}
\sphinxAtStartPar
This notebook demonstrates initialization of homoclinic orbits emanating form a
generic codimension two Bogdanov\sphinxhyphen{}Takens bifurcation point in the following
predator\sphinxhyphen{}prey ecosystem
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot x_1 &= x_1 - \frac{x_1 x_2}{1+\alpha x_1} - \epsilon x_1^2, \\
\dot x_2 &= -\gamma x_2 + \frac{x_1 x_2}{1+\alpha x_1} - \delta x_2^2. \\
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
The variables \(x_{1}\) and \(x_{2}\) are (scaled) population numbers of prey and
predator, respectively, while \(\alpha, \gamma, \varepsilon\), and \(\delta\) are
nonnegative parameters describing the behavior of isolated populations and
their interaction, see {[}\hyperlink{cite.references:id22}{Baz85}, \hyperlink{cite.references:id6}{Kuz04}{]}


\section{Overview}
\label{\detokenize{Bazykin:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Define an analytically derived Bogdanov\sphinxhyphen{}Takens point.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic branch emanating from the
Bogdanov\sphinxhyphen{}Takens point in two parameters \((d,h)\) using the new homoclinic
smooth orbital predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating from the
Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{Bazykin:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPointCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{Bazykin:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{BazykinGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Generate system files for the Bazykin’s predator\sphinxhyphen{}prey system}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{Bazykin}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point manually}
\label{\detokenize{Bazykin:define-bogdanov-takens-point-manually}}
\sphinxAtStartPar
It is easy to analytically derive a Bogdanov\sphinxhyphen{}Takens point at
\begin{equation*}
\begin{split}(x_1, x_2) \approx (6.265765528962353, 3.601553936836365),\end{split}
\end{equation*}
\sphinxAtStartPar
with parameter values \((\alpha, \delta) \approx (0.4536243277781295, 0.1751275929502174)\).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{6.265765528962353}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m+mf}{3.601553936836365}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.4536243277781295}\PYG{p}{;}\PYG{+w}{ }\PYG{l+m+mf}{0.1751275929502174}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{alpha\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{delta\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{alpha}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{delta}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} continuation parameters}
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{Bazykin:continue-homoclinic-curve-emanating-from-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 2.664535e\PYGZhy{}15
BT normal form coefficients:
a=3.945309e\PYGZhy{}02,	 b=\PYGZhy{}5.253878e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.857576
The initial half\PYGZhy{}return time T: 55.2395
The initial distance eps0: 0.00153522
The initial distance eps1: 0.000472271
first point found
tangent vector to first point found

elapsed time  = 11.4 secs
npoints curve = 300
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters}
\label{\detokenize{Bazykin:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
parameter\sphinxhyphen{}dependent normal form coefficients and the coefficients between the
parameters of the system and the parameters on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.4}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{alpha}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{delta}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}alpha\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{}axis([1.1334    1.1658    0.6305    0.7339])}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Bazykin_11_0}.png}


\section{Bifurcation diagram in phase\sphinxhyphen{}space \protect\((x_1,x_2)\protect\)}
\label{\detokenize{Bazykin:bifurcation-diagram-in-phase-space-x-1-x-2}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((x,y)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x\PYGZus{}1,x\PYGZus{}2)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Bazykin_13_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{Bazykin:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a large range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. We see that even with an
amplitude of \sphinxcode{\sphinxupquote{2}} the predicted homoclinic orbit is still very close.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{330}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Bazykin_15_0}.png}


\section{Convergence plot}
\label{\detokenize{Bazykin:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bazykin model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Bazykin_17_0}.png}


\part{IFOC}


\chapter{Generate system files for the indirect field oriented control system}
\label{\detokenize{IFOCGenSym:generate-system-files-for-the-indirect-field-oriented-control-system}}\label{\detokenize{IFOCGenSym::doc}}
\sphinxAtStartPar
This Jupyter Notebook generates the \sphinxstylestrong{system files} for the indirect field oriented control system given by
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot x_1 &= -c_1 x_1 + c_2 x_4 - \frac{k c_1}{u_2^0} x_2 x_4, \\
\dot x_2 &= -c_1 x_2 + c_2 u_2^0 + \frac{k c_1}{u_2^0} x_1 x_4, \\
\dot x_3 &= -c_3 x_3 - c_4 c_5 (x_2x_4 - u_2^0 x_1) + (c_4 T_m + c_3 w_{ref}), \\
\dot x_4 &= -(k_i-k_p)x_3 - k_p c_4 c_5 ( x_2 x_4 - u_2^0 x_1) + k_p (c_4 T_m + c_3 w_{ref}). \\
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
Here \(x_1 , x_2 , x_3\) and \(x_4\) are the state variables, where \(x_1\) and \(x_2\)
represent, respectively, direct and quadrature components of the rotor ﬂux;
\(x_3\) is the rotor speed error; and \(x_4\) denotes the quadrature axis component
of the stator current, respectively.  We also deﬁne the following constants and
parameters: \(u_2^0\) is a constant reference for the rotor flux magnitude; \(c_1\)
to \(c_5\) are machine parameters; \(k_p\) and \(k_i\) are the proportional (P) and
the integral (I) control gains, respectively; \(w_{ref}\) is the speed reference;
\(T_m\) the load torque; \(k\) the measure of rotor time constant mismatches.

\sphinxAtStartPar
These are used in the {\hyperref[\detokenize{IFOC::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{IFOC}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{IFOCGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{IFOCGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{IFOC\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{IFOCGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x4\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{p}{=}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Tm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{IFOCGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{k}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{IFOCGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{c1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{4.4868}\PYG{p}{;}
\PYG{n}{c2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.3567}\PYG{p}{;}
\PYG{n}{c3}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{c4}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{9.743}\PYG{p}{;}
\PYG{n}{c5}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.911}\PYG{p}{;}
\PYG{n}{u20}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{11.3}\PYG{p}{;}
\PYG{n}{kp}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{4.5}\PYG{p}{;}
\PYG{n}{ki}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{500}\PYG{p}{;}
\PYG{n}{wref}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{IFOCGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dx1\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{c1}\PYG{o}{*}\PYG{n}{x1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{c2}\PYG{o}{*}\PYG{n}{x4}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{k}\PYG{o}{*}\PYG{n}{c1}\PYG{o}{/}\PYG{n}{u20}\PYG{o}{*}\PYG{n}{x2}\PYG{o}{*}\PYG{n}{x4}\PYG{p}{;}
\PYG{n}{dx2\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{c1}\PYG{o}{*}\PYG{n}{x2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{c2}\PYG{o}{*}\PYG{n}{u20}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{k}\PYG{o}{*}\PYG{n}{c1}\PYG{o}{/}\PYG{n}{u20}\PYG{o}{*}\PYG{n}{x1}\PYG{o}{*}\PYG{n}{x4}\PYG{p}{;}
\PYG{n}{dx3\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{c3}\PYG{o}{*}\PYG{n}{x3}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{c4}\PYG{o}{*}\PYG{n}{c5}\PYG{o}{*}\PYG{p}{(}\PYG{n}{x2}\PYG{o}{*}\PYG{n}{x4}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{u20}\PYG{o}{*}\PYG{n}{x1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{c4}\PYG{o}{*}\PYG{n}{Tm}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{c3}\PYG{o}{*}\PYG{n}{wref}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dx4\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{ki}\PYG{o}{\PYGZhy{}}\PYG{n}{kp}\PYG{o}{*}\PYG{n}{c3}\PYG{p}{)}\PYG{o}{*}\PYG{n}{x3}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{kp}\PYG{o}{*}\PYG{n}{c4}\PYG{o}{*}\PYG{n}{c5}\PYG{o}{*}\PYG{p}{(}\PYG{n}{x2}\PYG{o}{*}\PYG{n}{x4}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{u20}\PYG{o}{*}\PYG{n}{x1}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{kp}\PYG{o}{*}\PYG{p}{(}\PYG{n}{c4}\PYG{o}{*}\PYG{n}{Tm}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{c3}\PYG{o}{*}\PYG{n}{wref}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dx1\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dx2\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dx3\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dx4\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{IFOCGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{IFOCGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Indirect field oriented control system}
\label{\detokenize{IFOC:indirect-field-oriented-control-system}}\label{\detokenize{IFOC::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id12}{BR00}, \hyperlink{cite.references:id13}{SGAR08}{]} the following model is considered
\begin{equation}\label{equation:IFOC:eq:IFOC}
\begin{split}\begin{cases}
\begin{aligned}
\dot x_1 &= -c_1 x_1 + c_2 x_4 - \frac{k c_1}{u_2^0} x_2 x_4, \\
\dot x_2 &= -c_1 x_2 + c_2 u_2^0 + \frac{k c_1}{u_2^0} x_1 x_4, \\
\dot x_3 &= -c_3 x_3 - c_4 c_5 (x_2x_4 - u_2^0 x_1) + (c_4 T_m + c_3 w_{ref}), \\
\dot x_4 &= -(k_i-k_p)x_3 - k_p c_4 c_5 ( x_2 x_4 - u_2^0 x_1) + k_p (c_4 T_m + c_3 w_{ref}).
\end{aligned}
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
Here \(x_1 , x_2 , x_3\) and \(x_4\) are the state variables, where \(x_1\) and \(x_2\)
represent, respectively, direct and quadrature components of the rotor ﬂux;
\(x_3\) is the rotor speed error; and \(x_4\) denotes the quadrature axis component
of the stator current, respectively.  We also deﬁne the following constants and
parameters: \(u_2^0\) is a constant reference for the rotor ﬂux magnitude; \(c_1\)
to \(c_5\) are machine parameters; \(k_p\) and \(k_i\) are the proportional (P) and
the integral (I) control gains, respectively; \(w_{ref}\) is the speed reference;
\(T_m\) the load torque; \(k\) the measure of rotor time constant mismatches.

\sphinxAtStartPar
The parameters \(c_1,c_2,c_3,c_4,c_5,u_{20},k_p,k_i\) and \(w_{ref}\) are fixed as
follows
\begin{equation*}
\begin{split}
\begin{aligned}
c_1 &= 4.4868, \\
c_2 &= 0.3567, \\
c_3 &= 0, \\
c_4 &= 9.743, \\
c_5 &= 1.911, \\
u_2^0 &= 11.3, \\
k_p &= 4.5, \\
k_i &= 500, \\
w_{ref} &= 0, \\
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
while the parameters \(k\) and \(T_m\) are used as unfolding parameters.


\section{Overview}
\label{\detokenize{IFOC:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Define an analytically derived Bogdanov\sphinxhyphen{}Takens point.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic branch emanating from the
Bogdanov\sphinxhyphen{}Takens points in two parameters \((k,T_m)\) using the new homoclinic
smooth orbital predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating from the
Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{IFOC:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{IFOC:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{IFOCGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{IFOCGenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{IFOC}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point manually}
\label{\detokenize{IFOC:define-bogdanov-takens-point-manually}}
\sphinxAtStartPar
Since \(w_{ref}\) vanishes the equilibria of \eqref{equation:IFOC:eq:IFOC} are invariant under
the transformation
\begin{equation}\label{equation:IFOC:eq:symmetry}
\begin{split}(x_1, x_2, x_3, x_4, T_m) \mapsto (-x_1, x_2, -x_3, -x_4, -T_m).\end{split}
\end{equation}
\sphinxAtStartPar
Then solving simultaneously for equilibria of \eqref{equation:IFOC:eq:IFOC} with vanishing
determinant of the Jacobian with respect to the variables \(x_1, x_2, x_3\)
and \(x_4\), and the unfolding parameter \(T_m\) yields four solutions. Two solutions are
given by
\begin{equation*}
\begin{split}
\begin{aligned}
x_1^{\pm} &= \frac{c_2 \left(k^2 \pm \sqrt{k^4-10 k^2+9}-1\right)
|u_{20}|\sqrt{k^2 \mp \sqrt{k^4-10 k^2+9}-3}}{4 \sqrt{2} c_1 (k+1)|k|}, \\
x_2^{\pm} &= \frac{c_2 \left(\pm\sqrt{k^4-10 k^2+9}+k (k+4)+3\right) u_{20}}{4 c_1 k (k+1)}, \\
x_3 &= 0, \\
x_4^{\mp} &= -\frac{|u_{20}|\sqrt{\left(k^2\mp\sqrt{k^4-10 k^2+9}-3\right) }}{\sqrt{2}|k|}, \\
T_m^{\pm} &= -\frac{c_2 c_5 \left(k^2 \pm \sqrt{k^4-10 k^2+9}+3\right) u_{20} 
|u_{20}|\sqrt{k^2 \mp \sqrt{k^4-10 k^2+9}-3}}{4 \sqrt{2} c_1 k|k|},
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
while the second two follow from the symmetry \eqref{equation:IFOC:eq:symmetry}.

\sphinxAtStartPar
Next we solve for a double zero of the characteristic equation of the Jacobian
with respect to the unfolding parameter \(k\). This reveals that there are two
solutions given by
\begin{equation*}
\begin{split}
(\pm x_1^-, x_2^-, 0, \pm x_4^+, \pm T_m^-),
\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}
k = 1+\frac{1}{3} \sqrt[3]{216-24 \sqrt{57}}+\frac{2 \sqrt[3]{9+\sqrt{57}}}{3^{2/3}}.
\end{split}
\end{equation*}
\sphinxAtStartPar
Thus we can explicitly define the Bogdanov\sphinxhyphen{}Takens point

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{c1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{4.4868}\PYG{p}{;}
\PYG{n}{c2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.3567}\PYG{p}{;}
\PYG{n}{c5}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.911}\PYG{p}{;}
\PYG{n}{u20}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{11.3}\PYG{p}{;}
\PYG{n}{k}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{216}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{57}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{l+m+mi}{3}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{l+m+mi}{57}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{x1m}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{2}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c1}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c2}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{k}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{k}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u20}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{x2m}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c1}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c2}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{k}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{k}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{k}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u20}\PYG{p}{;}
\PYG{n}{x3}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{x4p}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{2}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{k}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u20}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Tmm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{2}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c1}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{c2}\PYG{o}{*}\PYG{n}{c5}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u20}\PYG{o}{*}\PYG{p}{(}\PYG{n}{k}\PYGZca{}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{k}\PYGZca{}\PYG{l+m+mi}{4}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u20}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{)}\PYGZca{}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{x1m}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{x2m}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{x3}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{x4p}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{k}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{Tmm}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Tm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{IFOC:continue-homoclinic-curve-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Tm}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{900}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
BT normal form coefficients:
a=\PYGZhy{}2.800604e+01,	 b=9.109991e\PYGZhy{}01
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 2.02473
The initial half\PYGZhy{}return time T: 1.17262
The initial distance time eps0: 0.0149101
The initial distance time eps1: 0.00705633
first point found
tangent vector to first point found

elapsed time  = 82.1 secs
npoints curve = 900
\end{sphinxVerbatim}

\sphinxAtStartPar
We see that the initial amplitude is large compared to the previously
considered models. Nonetheless the homoclinic approximation converges and the
homoclinic solution is continued correctly.


\section{Compare predicted with computed parameters}
\label{\detokenize{IFOC:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
of the smooth orbital normal form on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.15}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Tm}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}app\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{IFOC_14_0}.png}

\sphinxAtStartPar
If we would like to have the homoclinic curve close to the Bogdanov\sphinxhyphen{}Takens
point we could start the continuation of the homoclinic orbit with a smaller
amplitude, for example with \sphinxcode{\sphinxupquote{BToptions.amplitude = 0.1}}. Another possibility is
to continue the homoclinic curve in the reverse direction. Here we choose the
second approach.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{120}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1\PYGZus{}rev}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
BT normal form coefficients:
a=\PYGZhy{}2.800604e+01,	 b=9.109991e\PYGZhy{}01
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 2.02473
The initial half\PYGZhy{}return time T: 1.17262
The initial distance time eps0: 0.0149101
The initial distance time eps1: 0.00705633
first point found
tangent vector to first point found
Current step size too small (point 97)
elapsed time  = 9.9 secs
npoints curve = 97
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homColor}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1\PYGZus{}rev}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1\PYGZus{}rev}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{k}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{Tm}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZus{}\PYGZob{}app\PYGZcb{}\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{IFOC_17_0}.png}


\section{Plot of continued homoclinic solutions in \protect\((x_1,x_2,x_3)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{IFOC:plot-of-continued-homoclinic-solutions-in-x-1-x-2-x-3-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((x_1,x_2,x_3)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{30}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{30}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{30}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x\PYGZus{}1,x\PYGZus{}2,x\PYGZus{}3)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{144}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{31}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{IFOC_19_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{IFOC:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a large range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. We see that even with an
amplitude of \sphinxcode{\sphinxupquote{1}} the predicted homoclinic orbit is still very close.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{660}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{660}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x\PYGZus{}1,x\PYGZus{}2,x\PYGZus{}3)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}x\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{160}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{45}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{IFOC_21_0}.png}


\section{Convergence plot}
\label{\detokenize{IFOC:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{IFOC model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{IFOC_23_1}.png}


\part{Extended Lorenz 84}


\chapter{Generate system files for the extended Lorenz\sphinxhyphen{}84 model}
\label{\detokenize{Lorenz84GenSym:generate-system-files-for-the-extended-lorenz-84-model}}\label{\detokenize{Lorenz84GenSym::doc}}
\sphinxAtStartPar
This Jupyter Notebook generates the \sphinxstylestrong{system files} for the extended Lorenz\sphinxhyphen{}84 model
given by
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot{X} &=-Y^{2}-Z^{2}-\alpha X+\alpha F-\xi U^{2} \\
\dot{Y} &=X Y-\beta X Z-Y+G \\
\dot{Z} &=\beta X Y+X Z-Z \\
\dot{U} &=-\delta U+\xi U X+S
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
In this system, \(X\) models the intensity of a baroclinic wave, \(Y\) and \(Z\) the
sin and cos coefficients of the wave respectively, the variable \(U\) is added to
study the influence of external parameters such as temperature. We fix the
parameters as follows \(\alpha=0.25, \beta=1, G=0.25, \delta=1.04\) and
\(\xi=0.987\). The continuation parameters are \(F\) and \(S\).

\sphinxAtStartPar
These are used in the {\hyperref[\detokenize{extendedLorenz84model::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{extended Lorenz\sphinxhyphen{}84 model}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{Lorenz84GenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{Lorenz84GenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{extendedLorenz84\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{Lorenz84GenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{X\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Y\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Z\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{U\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{F\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{S\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{Lorenz84GenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{alpha}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{Lorenz84GenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.25}\PYG{p}{;}
\PYG{n+nb}{beta}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{G}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.25}\PYG{p}{;}
\PYG{n}{delta}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.04}\PYG{p}{;}
\PYG{n}{xi}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.987}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{Lorenz84GenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dX\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{Y}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{n}{Z}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{alpha}\PYG{o}{*}\PYG{n}{X}\PYG{o}{+}\PYG{n+nb}{alpha}\PYG{o}{*}\PYG{n}{F}\PYG{o}{\PYGZhy{}}\PYG{n}{xi}\PYG{o}{*}\PYG{n}{U}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{dY\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{X}\PYG{o}{*}\PYG{n}{Y}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{beta}\PYG{o}{*}\PYG{n}{X}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{\PYGZhy{}}\PYG{n}{Y}\PYG{o}{+}\PYG{n}{G}\PYG{p}{;}
\PYG{n}{dZ\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{beta}\PYG{o}{*}\PYG{n}{X}\PYG{o}{*}\PYG{n}{Y}\PYG{o}{+}\PYG{n}{X}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{\PYGZhy{}}\PYG{n}{Z}\PYG{p}{;}
\PYG{n}{dU\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{delta}\PYG{o}{*}\PYG{n}{U}\PYG{o}{+}\PYG{n}{xi}\PYG{o}{*}\PYG{n}{U}\PYG{o}{*}\PYG{n}{X}\PYG{o}{+}\PYG{n}{S}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dX\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dY\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dZ\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dU\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{Lorenz84GenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{Lorenz84GenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{The extended Lorenz\sphinxhyphen{}84 model}
\label{\detokenize{extendedLorenz84model:the-extended-lorenz-84-model}}\label{\detokenize{extendedLorenz84model::doc}}
\sphinxAtStartPar
The extended Lorenz\sphinxhyphen{}84 model given by
\begin{equation}\label{equation:extendedLorenz84model:eq:Lorenz84}
\begin{split}\begin{cases}
\begin{aligned}
\dot{X} &=-Y^{2}-Z^{2}-\alpha X+\alpha F-\xi U^{2}, \\
\dot{Y} &=X Y-\beta X Z-Y+G, \\
\dot{Z} &=\beta X Y+X Z-Z, \\
\dot{U} &=-\delta U+\xi U X+S.
\end{aligned}
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
Here \(X\) models the intensity of a baroclinic wave, \(Y\) and \(Z\) the sin and cos
coefficients of the wave respectively, the variable \(U\) is added to study the
influence of external parameters such as temperature.  In this model all
codimension two bifurcation points of equilibria are present, see
{[}\hyperlink{cite.references:id15}{KMGS08}, \hyperlink{cite.references:id17}{ShilNikovNN95}, \hyperlink{cite.references:id16}{vV03}{]}.  We fix the parameters as
follows \(\alpha=0.25, \beta=1, G=0.25, \delta=1.04\) and \(\xi=0.987\). The
continuation parameters are \(F\) and \(S\).


\section{Overview}
\label{\detokenize{extendedLorenz84model:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Define a numerically derive Bogdanov\sphinxhyphen{}Takens point.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic branch emanating from the
Bogdanov\sphinxhyphen{}Takens points in two parameters \((F,S)\) using the new homoclinic
smooth orbital predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{extendedLorenz84model:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n+nb}{restoredefaultpath}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{extendedLorenz84model:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{Lorenz84GenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Lorenz84GenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{extendedLorenz84}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point manually}
\label{\detokenize{extendedLorenz84model:define-bogdanov-takens-point-manually}}
\sphinxAtStartPar
By numerically solving for real equilibria of \eqref{equation:extendedLorenz84model:eq:Lorenz84} with double zero
eigenvalues we obtain two equilibria. The first equilibrium is given by
\begin{equation*}
\begin{split}
\begin{pmatrix}
  X \\Y \\Z \\U \\F \\S  
\end{pmatrix}
\approx
\begin{pmatrix}
1.225640495986278 \\ -0.036320793271068824 \\ 0.19728832311233313 \\
-0.12339001198518826 \\ 1.446716701115361 \\ 0.020940169683322466
\end{pmatrix},
\end{split}
\end{equation*}
\sphinxAtStartPar
while the second is obtained from the symmetry
{[}
(X,Y,Z,U,F,S) \textbackslash{}mapsto (X,Y,Z,\sphinxhyphen{}U,F,\sphinxhyphen{}S)
.{]}

\sphinxAtStartPar
Thus we can explicitly define the Bogdanov\sphinxhyphen{}Takens point

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{X}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.225640495986278}\PYG{p}{;}
\PYG{n}{Y}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.036320793271068824}\PYG{p}{;}
\PYG{n}{Z}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.19728832311233313}\PYG{p}{;}
\PYG{n}{U}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.12339001198518826}\PYG{p}{;}
\PYG{n}{F}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.446716701115361}\PYG{p}{;}
\PYG{n}{S}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.020940169683322466}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{X}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{Y}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{Z}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{U}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{F}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{S}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{F\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{S\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{extendedLorenz84model:continue-homoclinic-curve-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{F}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{S}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.887379e\PYGZhy{}15
BT normal form coefficients:
a=2.144234e\PYGZhy{}01,	 b=6.065146e\PYGZhy{}01
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0349736
The initial half\PYGZhy{}return time T: 116.985
The initial distance eps0: 1.96422e\PYGZhy{}05
The initial distance eps1: 6.35711e\PYGZhy{}05
first point found
tangent vector to first point found
Current step size too small (point 43)
elapsed time  = 2.5 secs
npoints curve = 43
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters}
\label{\detokenize{extendedLorenz84model:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
of the smooth orbital normal form on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LineWidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{F}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{S}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}F\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}S\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.887379e\PYGZhy{}15
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{extendedLorenz84model_11_1}.png}


\section{Plot of continued homoclinic solutions in \protect\((X,Y,Z)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{extendedLorenz84model:plot-of-continued-homoclinic-solutions-in-x-y-z-phase-space}}\label{\detokenize{extendedLorenz84model:lorenz-continued-homoclinic-solutions-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((X,Y,Z)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}X\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}Y\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}Z\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x\PYGZus{}1,x\PYGZus{}2,x\PYGZus{}3)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{71}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{extendedLorenz84model_13_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{extendedLorenz84model:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. As seen from the plot
{\hyperref[\detokenize{extendedLorenz84model:lorenz-continued-homoclinic-solutions-phase-space}]{\sphinxcrossref{\DUrole{std,std-ref}{above}}}} the homoclinic
solutions start to deform rather quickly. Therefore, we cannot expect the
approximation to be accurate for relative large amplitude values. Still, for
an amplitude of \(0.3\) the approximation is nearby the corrected homoclinic
solutions.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{658}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{658}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(X,Y,Z)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}X\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}Y\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}Z\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{71}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{extendedLorenz84model_15_0}.png}


\section{Convergence plot}
\label{\detokenize{extendedLorenz84model:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{extended Lorenz 84 model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{extendedLorenz84model_17_1}.png}


\part{SIR model}


\chapter{Generate system files for SIR model with the standard incidence rate}
\label{\detokenize{SIRmodelGenSym:generate-system-files-for-sir-model-with-the-standard-incidence-rate}}\label{\detokenize{SIRmodelGenSym::doc}}
\sphinxAtStartPar
This Jupyter Notebook generates the \sphinxstylestrong{system file} for the following SIR model
{[}\hyperlink{cite.references:id20}{SZ14}{]} with the standard incidence rate
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
    \frac{d S}{d t} &=A-d S-\frac{\beta S I}{S+I+R}, \\ 
    \frac{d I}{d t} &=-(d+\nu) I-\mu(b,I) I+\frac{\beta S I}{S+I+R}, \\ 
    \frac{d R}{d t} &=\mu(b,I) I-d R,
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(A>0\) is the recruitment rate of susceptible population;
\(d>0\) is the per capita natural death rate of the population; \(\nu>0\) is
the per capita disease\sphinxhyphen{}induced death rate; \(\mu>0\) is the per capita
recovery rate of infectious individual. The funtion \(\mu\) is set to
\begin{equation*}
\begin{split}
\mu(b,I) = \mu_0 + (\mu_1 - \mu_0) \frac{b}{I+b}.
\end{split}
\end{equation*}
\sphinxAtStartPar
These are used in the {\hyperref[\detokenize{SIRmodel::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{SIR model}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{SIRmodelGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/Utilities}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if} \PYG{n}{isOctave}
  \PYG{n}{pkg} \PYG{n}{load} \PYG{n}{symbolic} \PYG{o}{\PYGZpc{}} \PYG{k}{for} \PYG{n}{GNU} \PYG{n}{Octave}
\PYG{n}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{SIRmodelGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SIRmodel}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{SIRmodelGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{I}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{R}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mu1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{SIRmodelGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{mu1}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}       \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{n}{symbol} \PYG{k}{for} \PYG{n}{alpha} \PYG{o+ow}{and} \PYG{n}{delta}
\PYG{n}{par}\PYG{o}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}  \PYG{o}{\PYGZpc{}} \PYG{n}{now} \PYG{n}{alpha1} \PYG{o+ow}{is} \PYG{n}{par}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{n}{etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}    \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{n}{symbol} \PYG{k}{for} \PYG{n}{alpha} \PYG{o+ow}{and} \PYG{n}{delta}
\PYG{n}{coords}\PYG{o}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;} \PYG{o}{\PYGZpc{}} \PYG{n}{create} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{n} \PYG{n}{vector} \PYG{k}{for} \PYG{n}{coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{SIRmodelGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{A} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{p}{;}
\PYG{n}{mu0} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{d} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{nu} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{beta} \PYG{o}{=} \PYG{l+m+mf}{11.5}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{SIRmodelGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mu} \PYG{o}{=} \PYG{o}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I}\PYG{p}{)} \PYG{n}{mu0} \PYG{o}{+} \PYG{p}{(}\PYG{n}{mu1}\PYG{o}{\PYGZhy{}}\PYG{n}{mu0}\PYG{p}{)}\PYG{o}{*}\PYG{n}{b}\PYG{o}{/}\PYG{p}{(}\PYG{n}{I}\PYG{o}{+}\PYG{n}{b}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dS\PYGZus{}dt} \PYG{o}{=} \PYG{n}{A}\PYG{o}{\PYGZhy{}}\PYG{n}{d}\PYG{o}{*}\PYG{n}{S}\PYG{o}{\PYGZhy{}}\PYG{n}{beta}\PYG{o}{*}\PYG{n}{S}\PYG{o}{*}\PYG{n}{I}\PYG{o}{/}\PYG{p}{(}\PYG{n}{S}\PYG{o}{+}\PYG{n}{I}\PYG{o}{+}\PYG{n}{R}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dI\PYGZus{}dt} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{n}{I}\PYG{o}{\PYGZhy{}}\PYG{n}{mu}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I}\PYG{p}{)}\PYG{o}{*}\PYG{n}{I}\PYG{o}{+}\PYG{n}{beta}\PYG{o}{*}\PYG{n}{S}\PYG{o}{*}\PYG{n}{I}\PYG{o}{/}\PYG{p}{(}\PYG{n}{S}\PYG{o}{+}\PYG{n}{I}\PYG{o}{+}\PYG{n}{R}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dR\PYGZus{}dt} \PYG{o}{=} \PYG{n}{mu}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I}\PYG{p}{)}\PYG{o}{*}\PYG{n}{I}\PYG{o}{\PYGZhy{}}\PYG{n}{d}\PYG{o}{*}\PYG{n}{R}\PYG{p}{;}
\PYG{n}{system} \PYG{o}{=} \PYG{p}{[}\PYG{n}{dS\PYGZus{}dt}\PYG{p}{;} \PYG{n}{dI\PYGZus{}dt}\PYG{p}{;} \PYG{n}{dR\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{SIRmodelGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc} \PYG{o}{=} \PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
  \PYG{n}{system}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}   \PYG{o}{\PYGZpc{}} \PYG{n}{n} \PYG{n}{x} \PYG{l+m+mi}{1} \PYG{n}{array} \PYG{n}{of} \PYG{n}{derivative} \PYG{n}{symbolic} \PYG{n}{expressions}
  \PYG{n}{coords}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{n} \PYG{n}{array} \PYG{n}{of} \PYG{n}{symbols} \PYG{k}{for} \PYG{n}{states}
  \PYG{n}{par}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}      \PYG{o}{\PYGZpc{}} \PYG{l+m+mi}{1} \PYG{n}{x} \PYG{n}{np} \PYG{n}{array} \PYG{n}{of} \PYG{n}{symbols} \PYG{n}{used} \PYG{k}{for} \PYG{n}{parameters}
  \PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{n}{argument} \PYG{n}{specifying} \PYG{n}{the} \PYG{n}{system} \PYG{n}{name}
  \PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Systems/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.} \PYG{o}{\PYGZpc{}} \PYG{n}{directory} \PYG{n}{to} \PYG{n}{save} \PYG{n}{to} \PYG{n}{file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{SIRmodelGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc} \PYG{o}{=} \PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,} \PYG{n}{system}\PYG{p}{,} \PYG{n}{coords}\PYG{p}{,} \PYG{n}{par}\PYG{p}{,} \PYG{n}{order}\PYG{p}{,} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
        \PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Systems/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{SIR model}
\label{\detokenize{SIRmodel:sir-model}}\label{\detokenize{SIRmodel::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id20}{SZ14}{]} the following SIR model is considered
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
    \frac{d S}{d t} &=A-d S-\frac{\beta S I}{S+I+R}, \\ 
    \frac{d I}{d t} &=-(d+\nu) I-\mu(b,I) I+\frac{\beta S I}{S+I+R}, \\ 
    \frac{d R}{d t} &=\mu(b,I) I-d R,
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(A>0\) is the recruitment rate of susceptible population;
\(d>0\) is the per capita natural death rate of the population; \(\nu>0\) is
the per capita disease\sphinxhyphen{}induced death rate; \(\mu>0\) is the per capita
recovery rate of infectious individual. The funtion \(\mu\) is set to
\begin{equation*}
\begin{split}
\mu(b,I) = \mu_0 + (\mu_1 - \mu_0) \frac{b}{I+b}.
\end{split}
\end{equation*}

\section{Overview}
\label{\detokenize{SIRmodel:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Compute a curve of equilibria, parametrized by \(b\).

\item {} 
\sphinxAtStartPar
Detect a Hopf and limit point.

\item {} 
\sphinxAtStartPar
Start continuation form the Hopf point in two parameters \((\mu_1, b)\).

\item {} 
\sphinxAtStartPar
Detect a Bogdanov\sphinxhyphen{}Takens points.

\item {} 
\sphinxAtStartPar
Start continuation form the Bogdanov\sphinxhyphen{}Takens points in two parameters \((\mu_1, b)\).

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot comparing the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{SIRmodel:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{SIRmodel:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{SIRmodel::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{SIRmodel.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{SIRmodel}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define equilibrium}
\label{\detokenize{SIRmodel:define-equilibrium}}
\sphinxAtStartPar
As in {[}\hyperlink{cite.references:id20}{SZ14}{]} we fix the parameters \(A = 20, \mu_0 = 10, d = 1/10, \nu = 1,\)
and \(\beta = 11.5\).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{A}\PYG{+w}{     }\PYG{p}{=}\PYG{+w}{  }\PYG{l+m+mi}{20}\PYG{p}{;}
\PYG{n}{mu0}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{  }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{d}\PYG{+w}{     }\PYG{p}{=}\PYG{+w}{  }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{nu}\PYG{+w}{    }\PYG{p}{=}\PYG{+w}{  }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n+nb}{beta}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{  }\PYG{l+m+mf}{11.5}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
For any endemic equilibrium \(E(S, I, R)\), its coordinates satisfy

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mu}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{  }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{,}\PYG{n}{I}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{mu0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{mu1}\PYG{o}{\PYGZhy{}}\PYG{n}{mu0}\PYG{p}{)}\PYG{o}{*}\PYG{n}{b}\PYG{o}{/}\PYG{p}{(}\PYG{n}{I}\PYG{o}{+}\PYG{n}{b}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{S}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{  }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{A}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{mu1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{I}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{I}\PYG{p}{)}\PYG{o}{/}\PYG{n}{d}\PYG{p}{;}\PYG{+w}{ }
\PYG{n}{R}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{  }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{   }\PYG{n}{mu}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{mu1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{I}\PYG{p}{)}\PYG{o}{*}\PYG{n}{I}\PYG{o}{/}\PYG{n}{d}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
and the coordinate \(I\) should be the positive root of the quadratic equation
\begin{equation*}
\begin{split}
f(I)=\mathscr{A} I^{2}+\mathscr{B} I+\mathscr{C}
\end{split}
\end{equation*}
\sphinxAtStartPar
where

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{R0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{n+nb}{beta}\PYG{o}{/}\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Ascr}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu0}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{\PYGZhy{}}\PYG{n}{nu}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Bscr}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu0}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{beta}\PYG{p}{)}\PYG{o}{*}\PYG{n}{A}\PYG{o}{+}\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{\PYGZhy{}}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{Cscr}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{A}\PYG{o}{*}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{R0}\PYG{p}{(}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
with
\begin{equation*}
\begin{split}
\mathbb{R}_{0}=\frac{\beta}{d+\nu+\mu_{1}}
\end{split}
\end{equation*}
\sphinxAtStartPar
the basic reproduction number.  The equation \(f(I)=0\) may have two roots if
\(\Delta_{0}>0\) which are denoted as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{delta0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu0}\PYG{p}{;}
\PYG{n}{delta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{d}\PYG{o}{+}\PYG{n}{nu}\PYG{o}{+}\PYG{n}{mu1}\PYG{p}{;}
\PYG{n}{Delta0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{\PYGZhy{}}\PYG{n}{nu}\PYG{p}{)}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{delta1}\PYG{p}{(}\PYG{n}{mu1}\PYG{p}{)}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{A}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{\PYGZhy{}}\PYG{n}{nu}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{*}\PYG{p}{(}\PYG{n}{mu1}\PYG{o}{\PYGZhy{}}\PYG{n}{mu0}\PYG{p}{)}\PYG{o}{+}\PYG{n}{delta0}\PYG{o}{*}\PYG{p}{(}\PYG{n}{delta1}\PYG{p}{(}\PYG{n}{mu1}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{beta}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{b}\PYG{o}{+}\PYG{n}{A}\PYGZca{}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{beta}\PYG{o}{\PYGZhy{}}\PYG{n}{delta0}\PYG{p}{)}\PYGZca{}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n}{I1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{Bscr}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{sqrt}\PYG{p}{(}\PYG{n}{Delta0}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{Ascr}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{I2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{Bscr}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{o}{+}\PYG{n+nb}{sqrt}\PYG{p}{(}\PYG{n}{Delta0}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{Ascr}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
By setting \(b=0.022\) and \(\mu_1 = 10.45\) we are slightly below the Hopf curve
in Figure 4 of {[}\hyperlink{cite.references:id20}{SZ14}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{b}\PYG{p}{=}\PYG{l+m+mf}{0.022}\PYG{p}{;}
\PYG{n}{mu1}\PYG{p}{=}\PYG{l+m+mf}{10.45}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{mu1}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{b}\PYG{p}{;}
\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{S}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I2}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{I2}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{I2}\PYG{p}{(}\PYG{n}{b}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{,}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{mu1\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{b\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{mu1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{b}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} continuation parameters}
\end{sphinxVerbatim}


\section{Continue equilibrium in parameter \protect\(b\protect\)}
\label{\detokenize{SIRmodel:continue-equilibrium-in-parameter-b}}
\sphinxAtStartPar
To continue the equilibrium in parameter \(b\), we first need to obtain a
tangent vector to the curve. This is done by the function \sphinxcode{\sphinxupquote{init\_EP\_EP}}. Then we
use the function \sphinxcode{\sphinxupquote{contset}} to obtain a \sphinxstylestrong{struct} containing a list of options
which is passed on to the continuer. By adjusting the values of the fields of
the \sphinxcode{\sphinxupquote{opt}} \sphinxstylestrong{struct} we set the minimum, initial and maximum set sizes, as well
as the maximum number of points to continue and weather or not to detect
bifurcation points (\sphinxcode{\sphinxupquote{opt.Singularities}}) on the equilibrium curve.  We also
increase the accuracy for locating detected bifurcations (\sphinxcode{\sphinxupquote{TestTolerance}}) and
the maximum number of iterations that may be used to achieve this
(\sphinxcode{\sphinxupquote{MaxTestIters}}). This improves the homoclinic predictor which depend directly
on the accuracy of the located Bogdanov\sphinxhyphen{}Takens point.

\sphinxAtStartPar
Finally, we continue the curve using the function \sphinxcode{\sphinxupquote{cont}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}EP\PYGZus{}EP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{b}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1000}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{TestTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}15}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxTestIters}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MinStepsize}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.001}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{equilibrium}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = H , x = ( 195.380284 0.041037 4.168310 0.022089 )
First Lyapunov coefficient = 3.908102e\PYGZhy{}04
label = LP, x = ( 198.069839 0.016933 1.743895 0.033419 )
a=\PYGZhy{}2.413445e+00

elapsed time  = 0.7 secs
npoints curve = 1000
\end{sphinxVerbatim}

\sphinxAtStartPar
There is one limit point detected (LP and one Hopf bifurcation point (H). The
\sphinxstylestrong{array struct} \sphinxcode{\sphinxupquote{eqbr\_bif\_data}} contains information about the detected
bifurcation points. We use this to extract the index of the detected bifurcation
points on the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}. The equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}} is
just a two dimensional array. Each column consists of a point on the curve.
The frist three rows contain the point \((S,I,R)\) while the last row contains
the parameter \(b\).

\sphinxAtStartPar
Below we plot the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}, together with the detect Hopf and
limit point, in \((b,S)\)\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n}{hopfPointInfo}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{limitPointsInfo}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{HopfPoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{hopfPointInfo}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{limitpoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{limitPointsInfo}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{HopfPoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{HopfPoint1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{limitpoint1}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{limitpoint1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}b\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}S\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve in \PYGZdl{}(b,S)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{fontsize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{SIRmodel_21_0}.png}


\section{Continue Hopf point}
\label{\detokenize{SIRmodel:continue-hopf-point}}
\sphinxAtStartPar
We continue the Hopf point using again the function \sphinxcode{\sphinxupquote{cont}}. We use the same
continuation options as defined above in the \sphinxstylestrong{struct} \sphinxcode{\sphinxupquote{opt}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{mu1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{b}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{b}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfPointInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfPointInfo}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}H\PYGZus{}H}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1}\PYG{p}{.}\PYG{n}{par}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{500}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxStepsize}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{.01}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{hopf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = GH, x = ( 195.599878 0.039046 3.970613 10.427886 0.025488 0.012691 )
l2=\PYGZhy{}8.624030e\PYGZhy{}05
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.423059e\PYGZhy{}17.
\PYGZgt{} In nf\PYGZus{}H (line 27)
In hopf\PYGZgt{}testf (line 150)
In cont\PYGZgt{}EvalTestFunc (line 810)
In cont (line 506)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  4.847349e\PYGZhy{}18.
\PYGZgt{} In nf\PYGZus{}H (line 28)
In hopf\PYGZgt{}testf (line 150)
In cont\PYGZgt{}EvalTestFunc (line 810)
In cont (line 506)

label = BT, x = ( 198.059382 0.017026 1.753334 10.450822 0.033239 0.000000 )
(a,b)=(\PYGZhy{}1.298117e\PYGZhy{}03, 1.219168e\PYGZhy{}02)

elapsed time  = 1.3 secs
npoints curve = 500
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{SIRmodel:continue-homoclinic-curve-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{BT\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 7.460699e\PYGZhy{}13
BT normal form coefficients:
a=\PYGZhy{}1.298117e\PYGZhy{}03,	 b=1.219168e\PYGZhy{}02
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.524008
The initial half\PYGZhy{}return time T: 358.423
The initial distance eps0: 0.00239581
The initial distance eps1: 0.000941365
first point found
tangent vector to first point found

elapsed time  = 18.7 secs
npoints curve = 300
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters}
\label{\detokenize{SIRmodel:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
of the smooth orbital normal form on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}. We also plot the Hopf curve which can be compared with
Figure 4 in {[}\hyperlink{cite.references:id20}{SZ14}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{} plot computed homoclinic parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent smooth orbital normal form coefficients}
\PYG{n}{bt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{mu1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{b}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}mu\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}b\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral saddle curve\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 7.460699e\PYGZhy{}13
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{SIRmodel_27_1}.png}


\section{Plot of continued homoclinic solutions in phase\sphinxhyphen{}space}
\label{\detokenize{SIRmodel:plot-of-continued-homoclinic-solutions-in-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((S,I,R)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}S\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}R\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(x\PYGZus{}1,x\PYGZus{}2,x\PYGZus{}3)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{73}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{33}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{SIRmodel_29_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{SIRmodel:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a large range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. We see that even with an
amplitude of \sphinxcode{\sphinxupquote{1}} the predicted homoclinic orbit is still relatively close.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{494}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{494}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}S\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}R\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{73}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{33}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{SIRmodel_31_0}.png}


\section{Convergence plot}
\label{\detokenize{SIRmodel:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SIR model\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{SIRmodel_33_1}.png}


\part{Hodgkin\sphinxhyphen{}Huxley}


\chapter{Generate system files for Hodgkin\sphinxhyphen{}Huxley equations}
\label{\detokenize{HodgkinHuxleyGenSym:generate-system-files-for-hodgkin-huxley-equations}}\label{\detokenize{HodgkinHuxleyGenSym::doc}}
\sphinxAtStartPar
The Hodgkin\sphinxhyphen{}Huxley equations {[}\hyperlink{cite.references:id18}{HH52a}{]} relate the
difference in electric potential across the cell membrane \((V)\) and gating
variables \((m, n\) and \(h\) ) for ion channels to the stimulus intensity \((I)\)
and temperature \((T)\), as follows:
\begin{equation*}
\begin{split}
\begin{cases}
\dot{V} ={}& -G(V, m, n, h)+I \\
\dot{m} ={}& \Phi(T)\left[(1-m) \alpha_{m}(V)-m \beta_{m}(V)\right] \\
\dot{n} ={}& \Phi(T)\left[(1-n) \alpha_{n}(V)-n \beta_{n}(V)\right] \\
\dot{h} ={}& \Phi(T)\left[(1-h) \alpha_{h}(V)-h \beta_{h}(V)\right]
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\dot{x}\) stands for \(\mathrm{d} x / \mathrm{d} t\) and \(\Phi\) is
given by \(\Phi(T)=3^{(\mathrm{T}-6.3) / 10}\). The other functions involved
are:
\begin{equation*}
\begin{split}
G(V, m, n, h)=\bar{g}_{\mathrm{Na}} m^{3}
h\left(V-\bar{V}_{\mathrm{Na}}\right)+\bar{g}_{\mathrm{K}}
n^{4}\left(V-\bar{V}_{\mathrm{K}}\right)+\bar{g}_{\mathrm{L}}\left(V-\bar{V}_{\mathrm{L}}\right)
\end{split}
\end{equation*}
\sphinxAtStartPar
and the equations modeling the variation of membrane permeability are:
\begin{equation*}
\begin{split}
\begin{array}{ll}
\alpha_{m}(V)=\Psi\left(\frac{V+25}{10}\right) & \beta_{m}(V)=4 e^{V / 18}
\\
\alpha_{n}(V)=0.1 \Psi\left(\frac{V+10}{10}\right) & \beta_{n}(V)=0.125
e^{V / 80} \\
\alpha_{h}(V)=0.07 e^{V / 20} & \beta_{h}(V)=\left(1+e^{(V+30) /
10}\right)^{-1}
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}
\Psi(x)=\left\{\begin{array}{ll}
x /\left(e^{x}-1\right) & \text { if } x \neq 0 \\
1 & \text { if } x=0
\end{array}\right.
\end{split}
\end{equation*}
\sphinxAtStartPar
The parameters \(\bar{g}_{\text {ion }}\) and \(\bar{V}_{\text {ion}}\)
representing maximum conductance and equilibrium potential for the ion were
obtained from experimental data by Hodgkin and Huxley, with the values given
below:
\begin{equation*}
\begin{split}
\begin{array}{lll}
\bar{g}_{\mathrm{Na}}=120 \mathrm{mS} / \mathrm{cm}^{2}, &
\bar{g}_{\mathrm{K}}=36 \mathrm{mS} / \mathrm{cm}^{2}, &
\bar{g}_{\mathrm{L}}=0.3 \mathrm{mS} / \mathrm{cm}^{2} \\
\bar{V}_{\mathrm{Na}}=-115 \mathrm{mV}, & \bar{V}_{\mathrm{K}}=12
\mathrm{mV}, & \bar{V}_{\mathrm{L}}=10.599 \mathrm{mV}
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
The values of \(\bar{V}_{\mathrm{Na}}\) and \(\bar{V}_{\mathrm{K}}\) can be
controlled experimentally {[}\hyperlink{cite.references:id19}{HH52b}{]}.
The temperature is set to \(T=6.3^{\circ}\).

\sphinxAtStartPar
These are used in the {\hyperref[\detokenize{HodgkinHuxley::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{HodgkinHuxley}}}}.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{HodgkinHuxleyGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{HodgkinHuxleyGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HodgkinHuxley\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{HodgkinHuxleyGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{V\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{m\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{n\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{h\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{p}{=}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{VbarK\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{I\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for parameters}
\label{\detokenize{HodgkinHuxleyGenSym:create-symbols-for-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{|par|}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{mu\_1}} or
\sphinxcode{\sphinxupquote{par(1)}}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{HodgkinHuxleyGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{k}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define fixed parameters}
\label{\detokenize{HodgkinHuxleyGenSym:define-fixed-parameters}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{gbarNa}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{120}\PYG{p}{;}
\PYG{n}{gbarK}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{36}\PYG{p}{;}
\PYG{n}{gbarL}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.3}\PYG{p}{;}
\PYG{n}{VbarNa}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{115}\PYG{p}{;}
\PYG{n}{VbarL}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{10.599}\PYG{p}{;}
\PYG{n}{T}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{6.3}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{HodgkinHuxleyGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Psi}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{x}\PYG{o}{/}\PYG{p}{(}\PYG{n+nb}{exp}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{alpha\PYGZus{}m}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{Psi}\PYG{p}{(}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{V}\PYG{o}{+}\PYG{l+m+mi}{25}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{+w}{ }\PYG{p}{)}\PYG{p}{;}
\PYG{n}{alpha\PYGZus{}n}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mf}{0.1}\PYG{o}{*}\PYG{n}{Psi}\PYG{p}{(}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{V}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{alpha\PYGZus{}h}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mf}{0.07}\PYG{o}{*}\PYG{n+nb}{exp}\PYG{p}{(}\PYG{n}{V}\PYG{o}{/}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{beta\PYGZus{}m}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{exp}\PYG{p}{(}\PYG{n}{V}\PYG{o}{/}\PYG{l+m+mi}{18}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta\PYGZus{}n}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mf}{0.125}\PYG{o}{*}\PYG{n+nb}{exp}\PYG{p}{(}\PYG{n}{V}\PYG{o}{/}\PYG{l+m+mi}{80}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta\PYGZus{}h}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n+nb}{exp}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V}\PYG{o}{+}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{G}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{V}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{m}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{h}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{gbarNa}\PYG{o}{*}\PYG{n}{m}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{h}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VbarNa}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gbarK}\PYG{o}{*}\PYG{n}{n}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VbarK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{gbarL}\PYG{o}{*}\PYG{p}{(}\PYG{n}{V}\PYG{o}{\PYGZhy{}}\PYG{n}{VbarL}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{Phi}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYGZca{}\PYG{p}{(}\PYG{n}{T}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{6.3}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{dV\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{G}\PYG{p}{(}\PYG{n}{V}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{m}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{h}\PYG{p}{)}\PYG{o}{+}\PYG{n}{I}\PYG{p}{;}
\PYG{n}{dm\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{Phi}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{m}\PYG{p}{)}\PYG{o}{*}\PYG{n}{alpha\PYGZus{}m}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{m}\PYG{o}{*}\PYG{n}{beta\PYGZus{}m}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dn\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{Phi}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{n}\PYG{p}{)}\PYG{o}{*}\PYG{n}{alpha\PYGZus{}n}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{n}\PYG{o}{*}\PYG{n}{beta\PYGZus{}n}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dh\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{Phi}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{h}\PYG{p}{)}\PYG{o}{*}\PYG{n}{alpha\PYGZus{}h}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{h}\PYG{o}{*}\PYG{n}{beta\PYGZus{}h}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dV\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dm\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dn\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dh\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{HodgkinHuxleyGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{HodgkinHuxleyGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Hodgkin Huxley equations}
\label{\detokenize{HodgkinHuxley:hodgkin-huxley-equations}}\label{\detokenize{HodgkinHuxley::doc}}
\sphinxAtStartPar
The Hodgkin\sphinxhyphen{}Huxley equations {[}\hyperlink{cite.references:id18}{HH52a}{]} relate the
difference in electric potential across the cell membrane \((V)\) and gating
variables \((m, n\) and \(h\) ) for ion channels to the stimulus intensity \((I)\)
and temperature \((T)\), as follows:
\begin{equation}\label{equation:HodgkinHuxley:eq:HHequations}
\begin{split}\begin{cases}
\begin{aligned}
\dot{V} ={}& -G(V, m, n, h)+I, \\
\dot{m} ={}& \Phi(T)\left[(1-m) \alpha_{m}(V)-m \beta_{m}(V)\right], \\
\dot{n} ={}& \Phi(T)\left[(1-n) \alpha_{n}(V)-n \beta_{n}(V)\right], \\
\dot{h} ={}& \Phi(T)\left[(1-h) \alpha_{h}(V)-h \beta_{h}(V)\right],
\end{aligned}
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
where \(\dot{x}\) stands for \(\mathrm{d} x / \mathrm{d} t\) and \(\Phi\) is
given by \(\Phi(T)=3^{(\mathrm{T}-6.3) / 10}\). The other functions involved
are:
\begin{equation*}
\begin{split}
G(V, m, n, h)=\bar{g}_{\mathrm{Na}} m^{3}
h\left(V-\bar{V}_{\mathrm{Na}}\right)+\bar{g}_{\mathrm{K}}
n^{4}\left(V-\bar{V}_{\mathrm{K}}\right)+\bar{g}_{\mathrm{L}}\left(V-\bar{V}_{\mathrm{L}}\right)
\end{split}
\end{equation*}
\sphinxAtStartPar
and the equations modeling the variation of membrane permeability are:
\begin{equation*}
\begin{split}
\begin{array}{ll}
\alpha_{m}(V)=\Psi\left(\frac{V+25}{10}\right), & \beta_{m}(V)=4 e^{V / 18},
\\
\alpha_{n}(V)=0.1 \Psi\left(\frac{V+10}{10}\right), & \beta_{n}(V)=0.125 e^{V / 80} \\
\alpha_{h}(V)=0.07 e^{V / 20}, & \beta_{h}(V)=\left(1+e^{(V+30) / 10}\right)^{-1},
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}
\Psi(x) = \begin{cases}
    x /\left(e^{x}-1\right), & \text { if } x \neq 0, \\
    1, & \text { if } x=0.
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
The parameters \(\bar{g}_{\text {ion }}\) and \(\bar{V}_{\text {ion }}\)
representing maximum conductance and equilibrium potential for the ion were
obtained from experimental data by Hodgkin and Huxley, with the values given
below:
\begin{equation*}
\begin{split}
\begin{array}{lll}
\bar{g}_{\mathrm{Na}}=120 \mathrm{mS} / \mathrm{cm}^{2}, &
\bar{g}_{\mathrm{K}}=36 \mathrm{mS} / \mathrm{cm}^{2}, &
\bar{g}_{\mathrm{L}}=0.3 \mathrm{mS} / \mathrm{cm}^{2}, \\
\bar{V}_{\mathrm{Na}}=-115 \mathrm{mV}, & \bar{V}_{\mathrm{K}}=12
\mathrm{mV}, & \bar{V}_{\mathrm{L}}=10.599 \mathrm{mV}.
\end{array}
\end{split}
\end{equation*}
\sphinxAtStartPar
The values of \(\bar{V}_{\mathrm{Na}}\) and \(\bar{V}_{\mathrm{K}}\) can be
controlled experimentally {[}\hyperlink{cite.references:id19}{HH52b}{]}.
The temperature is set to \(T=6.3^{\circ}\).


\section{Overview}
\label{\detokenize{HodgkinHuxley:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Manually define an Bogdanov\sphinxhyphen{}Takens point.

\item {} 
\sphinxAtStartPar
Start continuation of the homoclinic branch emanating from the
Bogdanov\sphinxhyphen{}Takens points in two parameters \((\bar{V}_{\mathrm K},I)\) using the
new homoclinic smooth orbital predictor from {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating from the
Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{HodgkinHuxley:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{HodgkinHuxley:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{HodgkinHuxleyGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Generate system files for Hodgkin\sphinxhyphen{}Huxley equations}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{HodgkinHuxley}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point manually}
\label{\detokenize{HodgkinHuxley:define-bogdanov-takens-point-manually}}
\sphinxAtStartPar
By solving for real equilibria of \eqref{equation:HodgkinHuxley:eq:HHequations} with double
zero eigenvalues we obtain two equilibria. The first equilibrium is given by
\begin{equation*}
\begin{split}
(V,m,n,h)  = (-2.835463618170097, 0.07351498630356315, 0.361877602925177, 0.494859128785482),
\end{split}
\end{equation*}
\sphinxAtStartPar
with parameter values \(V_{\bar K} = (-4.977020454108788,
-0.06185214966177632)\). The second solution we can discard, since the geometric
multiplicity is equation to two.

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{VbarK\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{I\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{VbarK}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{I}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} continuation parameters}
\end{sphinxVerbatim}

\sphinxAtStartPar
Next we define the Bogdanov\sphinxhyphen{}Takens point

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{V}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.835463618170097}\PYG{p}{;}
\PYG{n}{m}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.07351498630356315}\PYG{p}{;}
\PYG{n}{n}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.361877602925177}\PYG{p}{;}
\PYG{n}{h}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.494859128785482}\PYG{p}{;}
\PYG{n}{VbarK}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.977020454108788}\PYG{p}{;}
\PYG{n}{I}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.06185214966177632}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{V}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{m}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{n}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{h}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{VbarK}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{I}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{HodgkinHuxley:continue-homoclinic-curve-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
To continue the homoclinic curve emanating from the Bogdanov\sphinxhyphen{}Takens point we
use the functions \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} and \sphinxcode{\sphinxupquote{init\_BT\_Hom}} to obtain an initial
approximation to the homoclinic solution (\sphinxcode{\sphinxupquote{hom\_x}}) as well as a tangent vector
to the discretized homoclinic solution (\sphinxcode{\sphinxupquote{hom\_v}}) as described in
{\hyperref[\detokenize{Morris-Lecar:initial-prediction-homoclinic-orbit}]{\sphinxcrossref{\DUrole{std,std-ref}{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{VbarK}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{I}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{ntst}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{40}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1000}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{homoclinic\PYGZus{}br1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.705303e\PYGZhy{}13
BT normal form coefficients:
a=2.551541e\PYGZhy{}05,	 b=\PYGZhy{}7.458949e\PYGZhy{}03
The initial perturbation parameter epsilon:  1.000000e\PYGZhy{}01
The initial amplitude: 0.0275168
The initial half\PYGZhy{}return time T: 12114.7
The initial distance eps0: 4.84346e\PYGZhy{}05
The initial distance eps1: 1.48445e\PYGZhy{}05
first point found
tangent vector to first point found

elapsed time  = 66.8 secs
npoints curve = 1000
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters}
\label{\detokenize{HodgkinHuxley:compare-predicted-with-computed-parameters}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
of the smooth orbital normal form on the center manifold, see
{[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{c}{\PYGZpc{} plot computed parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{VbarK}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{I}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}bar\PYGZob{}V\PYGZcb{}\PYGZus{}K\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}I\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 1.705303e\PYGZhy{}13
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HodgkinHuxley_12_1}.png}


\section{Plot of continued homoclinic solutions}
\label{\detokenize{HodgkinHuxley:plot-of-continued-homoclinic-solutions}}\label{\detokenize{HodgkinHuxley:hh-continued-homoclinic-solutions-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((m,n,h)\) phase\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot native}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{60}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{61}\PYG{p}{:}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{61}\PYG{p}{:}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{61}\PYG{p}{:}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}m\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}n\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,m,n)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot inline}
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{10}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}m\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}n\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(V,m,n)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HodgkinHuxley_15_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{HodgkinHuxley:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Below we compute for a range of amplitudes the predicted and corrected
homoclinic solutions and compare them in phase space. As seen from the plot
{\hyperref[\detokenize{HodgkinHuxley:hh-continued-homoclinic-solutions-phase-space}]{\sphinxcrossref{\DUrole{std,std-ref}{above}}}} the homoclinic
solutions start to deform rather quickly. Therefore, we cannot expect the
approximation to be accurate for relative large amplitude values. Still, for
an amplitude of \(0.3\) the approximation is nearby the corrected homoclinic
solutions.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot native}
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}02}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{658}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{658}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(X,Y,Z)\PYGZdl{} phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}m\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}n\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}h\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Convergence plot}
\label{\detokenize{HodgkinHuxley:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n}{o}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{o}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n}{o}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{            }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{try}
\PYG{+w}{                }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n}{o}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{catch}
\PYG{+w}{                }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{                }\PYG{k}{continue}
\PYG{+w}{            }\PYG{k}{end}
\PYG{+w}{        }\PYG{k}{end}
\PYG{+w}{    }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hodgkin\PYGZhy{}Huxley equations\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HodgkinHuxley_19_0}.png}


\chapter{Save data to files}
\label{\detokenize{HodgkinHuxley:save-data-to-files}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHRPorder1.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHRPorder2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHRPorder3.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{+w}{                                                   }
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHLPorder1.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHLPorder2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHLPorder3.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}

\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHLPorder3orbital.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHRegularPerturbationL2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HHLPHypernormalForm.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\part{Homoclinic RG flows}


\chapter{Generate system files for Homoclinic RG flows}
\label{\detokenize{HomoclinicRGflowsGenSym:generate-system-files-for-homoclinic-rg-flows}}\label{\detokenize{HomoclinicRGflowsGenSym::doc}}
\sphinxAtStartPar
This Jupyter Notebook generates the \sphinxstylestrong{system files} for the model considered
in the {\hyperref[\detokenize{HomoclinicRGflows::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{HomoclinicRGflows}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{HomoclinicRGflowsGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{HomoclinicRGflowsGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HomoclinicRGflows\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{HomoclinicRGflowsGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{g1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{g2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{g3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{g4\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{p}{=}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{epsilon\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{M\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{N\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{HomoclinicRGflowsGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{epsilon}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define beta functions}
\label{\detokenize{HomoclinicRGflowsGenSym:define-beta-functions}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{beta12}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{96}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{+}\PYG{n}{N}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{768}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{128}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{16}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{22}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{32}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{32}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{256}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{64}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{72}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{19}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{80}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{30}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{144}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{42}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{21}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{896}\PYG{o}{+}\PYG{l+m+mi}{128}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{352}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{48}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{928}\PYG{o}{+}\PYG{l+m+mi}{224}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{392}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{11}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{23}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{352}\PYG{o}{+}\PYG{l+m+mi}{96}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{152}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{44}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{1600}\PYG{o}{+}\PYG{l+m+mi}{320}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{656}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{136}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{50}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{pi}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{beta22}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{1536}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{128}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{16}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{192}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{80}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{16}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{22}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{48}\PYG{o}{+}\PYG{l+m+mi}{9}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{128}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{32}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{14}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{272}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{72}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{82}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{15}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{24}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{176}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{58}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{14}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{11}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{576}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{160}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{176}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{54}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{74}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{288}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{112}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{l+m+mi}{3968}\PYG{o}{+}\PYG{l+m+mi}{1024}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1600}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{416}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{56}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{22}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{85}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{11}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{1856}\PYG{o}{+}\PYG{l+m+mi}{448}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{736}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{176}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{22}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{43}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{2816}\PYG{o}{+}\PYG{l+m+mi}{768}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1152}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{320}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{69}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{30}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n+nb}{pi}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{beta32}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{384}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{96}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{8}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{128}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{18}\PYG{o}{+}\PYG{l+m+mi}{14}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{l+m+mi}{22}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{96}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{24}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{16}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{52}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{26}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{14}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{104}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{52}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{14}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{38}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{208}\PYG{o}{+}\PYG{l+m+mi}{56}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{48}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{208}\PYG{o}{+}\PYG{l+m+mi}{56}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{48}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{96}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{16}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{24}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{416}\PYG{o}{+}\PYG{l+m+mi}{112}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{96}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{18}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{768}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{128}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{192}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{96}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1152}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{192}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{288}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{48}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{176}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{70}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{21}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{576}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{96}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{144}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{24}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{104}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{34}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{13}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{11}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{pi}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{beta42}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{224}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{24}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{224}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{16}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{96}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{22}\PYG{o}{+}\PYG{n}{N}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{224}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{64}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{14}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{32}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{9}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{80}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{80}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g3}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{160}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{17}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{32}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{96}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{36}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{160}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{48}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{40}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{960}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{288}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{240}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{72}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{88}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{39}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{7}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+m+mi}{13}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{16}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{96}\PYG{o}{+}\PYG{l+m+mi}{36}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g1}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.*}\PYG{p}{(}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{240}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{72}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{60}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{18}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{8}\PYG{o}{.*}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{g4}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.*}\PYG{p}{(}\PYG{l+m+mi}{192}\PYG{o}{+}\PYG{l+m+mi}{72}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{48}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{6}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{4}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{+}\PYG{n}{g2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{.*}\PYG{p}{(}\PYG{+w}{ }\PYG{k}{...}
\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{640}\PYG{p}{)}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{192}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{+}\PYG{l+m+mi}{160}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{l+m+mi}{48}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{96}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{l+m+mi}{36}\PYG{o}{.*}\PYG{+w}{ }\PYG{k}{...}
\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{12}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{o}{+}\PYG{l+m+mi}{5}\PYG{o}{.*}\PYG{n}{M}\PYG{o}{.*}\PYG{n}{N}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{pi}\PYG{o}{.\PYGZca{}}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{HomoclinicRGflowsGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dg1\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{epsilon}\PYG{o}{*}\PYG{n}{g1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{beta12}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dg2\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{epsilon}\PYG{o}{*}\PYG{n}{g2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{beta22}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dg3\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{epsilon}\PYG{o}{*}\PYG{n}{g3}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{beta32}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{dg4\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n}{epsilon}\PYG{o}{*}\PYG{n}{g4}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{beta42}\PYG{p}{(}\PYG{n}{M}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dg1\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dg2\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dg3\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dg4\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{HomoclinicRGflowsGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{HomoclinicRGflowsGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Homoclinic RG flows}
\label{\detokenize{HomoclinicRGflows:homoclinic-rg-flows}}\label{\detokenize{HomoclinicRGflows::doc}}
\sphinxAtStartPar
In {[}\hyperlink{cite.references:id23}{JP21}{]} an \(\mathcal{N}=1\) supersymmetric model of interacting
scalar superfields that is invariant under the action of an
\(O(N) \times O(M)\) group in \(d=3-\epsilon\) dimensions is considered.
The coupling constants \(g_i(i=1,\dots,4)\) satisfy the following differential equations
\begin{equation*}
\begin{split}
\dot g_i = -\epsilon g_i + \beta_i^{(2)}, \qquad i=1,\dots,4,
\end{split}
\end{equation*}
\sphinxAtStartPar
where the \(\beta\) functions are given by
\begin{equation*}
\begin{split}
\begin{aligned}
\beta_{1}^{(2)}=& \frac{1}{8 \pi^{2} N^{2}}\left(32 g_{1}^{2} g_{4}
N\left(-40-8 M+8 N+7 M N+8 N^{2}\right)+16 g_{1}^{2} g_{3} N\left(-80-24 M+30
N+4 M N+7 N^{2}+4 M N^{2}\right)\right.\\
&+16 g_{1} g_{3}^{2} N^{2}\left(32+2 M+N+M N+N^{2}+M N^{2}\right)+64 g_{1}
g_{2} g_{4} N\left(-32-4 M+16 N+2 M N+5 N^{2}+2 M N^{2}\right) \\
&+4 g_{2}^{2} g_{3} N\left(-256-64 M+72 N+10 M N+19 N^{2}+2 M N^{2}\right)+64
g_{1} g_{4}^{2} N^{2}\left(22-2 M+M N+M N^{2}\right) \\
&+16 g_{1} g_{2} g_{3} N\left(-144-40 M+42 N+17 M N+21 N^{2}+5 M
N^{2}\right)+128 g_{1} g_{3} g_{4} N^{2}\left(3+5 M+N+N^{2}\right) \\
&+g_{2}^{3}\left(896+128 M-352 N-48 M N-12 N^{2}-12 M N^{2}+7 N^{3}+2 M
N^{3}\right)+96 g_{2}^{2} g_{4}(-8+N) N \\
&+4 g_{1}^{2} g_{2}\left(928+224 M-392 N-100 M N-2 N^{2}+11 M N^{2}+23 N^{3}+7
M N^{3}+4 N^{4}\right)+768 g_{2} g_{3} g_{4} N^{2} \\
&+4 g_{1}^{3}\left(352+96 M-152 N-44 M N+10 N^{3}+3 M N^{3}+M N^{4}\right)+16
g_{2} g_{3}^{2} N^{2}\left(16+7 M+N+N^{2}\right) \\
&\left.+2 g_{1} g_{2}^{2}\left(1600+320 M-656 N-136 M N+32 N^{2}+10 M N^{2}+50
N^{3}+10 M N^{3}+5 N^{4}+2 M N^{4}\right)\right),
\end{aligned}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{aligned}
\beta_{2}^{(2)}=& \frac{1}{8 \pi^{2} N^{2}}\left(64 g_{1} g_{2} g_{4}
N\left(-80-16 M+16 N+5 M N+7 N^{2}\right)+16 g_{2} g_{3}^{2} N^{2}\left(48+9
M+2 N+M N+2 N^{2}+M N^{2}\right)\right.\\
&+16 g_{1}^{2} g_{3} N\left(-128-32 M+32 N+12 M N+14 N^{2}+3 M N^{2}\right)+128
g_{2} g_{3} g_{4} N^{2}\left(9+5 M+N+N^{2}\right) \\
&+16 g_{1} g_{2} g_{3} N\left(-272-72 M+82 N+15 M N+24 N^{2}+6 M
N^{2}\right)+192 g_{1}^{2} g_{4} N\left(-12-2 M+4 N+N^{2}\right) \\
&+16 g_{2}^{2} g_{4} N\left(-176-40 M+58 N+14 M N+17 N^{2}+11 M N^{2}\right)+32
g_{1} g_{3}^{2} N^{2}\left(16+7 M+N+N^{2}\right) \\
&+4 g_{2}^{2} g_{3} N\left(-576-160 M+176 N+54 M N+74 N^{2}+17 M
N^{2}\right)+64 g_{2} g_{4}^{2} N^{2}\left(22-2 M+M N+M N^{2}\right) \\
&+8 g_{1}^{3}\left(288+64 M-112 N-24 M N-6 N^{2}+3 M N^{2}+5 N^{3}+2 M
N^{3}+N^{4}\right)+1536 g_{1} g_{3} g_{4} N^{2} \\
&+2 g_{1} g_{2}^{2}\left(3968+1024 M-1600 N-416 M N-56 N^{2}-22 M N^{2}+85
N^{3}+17 M N^{3}+11 N^{4}\right) \\
&+4 g_{1}^{2} g_{2}\left(1856+448 M-736 N-176 M N-22 N^{2}-5 M N^{2}+43 N^{3}+8
M N^{3}+3 N^{4}+2 M N^{4}\right) \\
&\left.+g_{2}^{3}\left(2816+768 M-1152 N-320 M N+12 N^{2}-12 M N^{2}+69
N^{3}+30 M N^{3}+7 N^{4}+5 M N^{4}\right)\right),
\end{aligned}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{aligned}
\beta_{3}^{(2)}=& \frac{1}{8 \pi^{2} N^{3}}\left(32 g_{3}^{2} g_{4}
N^{3}\left(18+14 M+7 N+7 N^{2}\right)+96 g_{1}^{2} g_{4} N\left(8+2 N^{2}+M
N^{2}\right)+384 g_{1} g_{2} g_{4} N\left(4+N^{2}\right)\right.\\
&+24 g_{3}^{3} N^{3}\left(16+2 M+2 N+M N+2 N^{2}+M N^{2}\right)+64 g_{2} g_{3}
g_{4} N^{2}\left(-20-4 M+10 N+2 M N+5 N^{2}+2 M N^{2}\right) \\
&+16 g_{1} g_{3}^{2} N^{2}\left(-52-14 M+26 N+7 M N+14 N^{2}+7 M
N^{2}\right)+128 g_{1} g_{3} g_{4} N^{2}\left(-10-2 M+5 N+M N+5 N^{2}\right) \\
&+8 g_{2} g_{3}^{2} N^{2}\left(-104-28 M+52 N+14 M N+38 N^{2}+7 M
N^{2}\right)+64 g_{3} g_{4}^{2} N^{3}\left(22-2 M+M N+M N^{2}\right) \\
&+16 g_{1} g_{2} g_{3} N\left(208+56 M-48 N-12 M N+12 N^{2}+3 M N^{2}+8 N^{3}+M
N^{3}+2 N^{4}\right)+96 g_{2}^{2} g 4 N\left(8+N^{2}\right) \\
&+8 g_{1}^{2} g_{3} N\left(208+56 M-48 N-12 M N+12 N^{2}+6 M N^{2}+4 N^{3}+3 M
N^{3}+M N^{4}\right) \\
&+8 g_{1}^{3}\left(-96-16 M+24 N+4 M N-20 N^{2}-10 M N^{2}+6 N^{3}+2 M
N^{3}+N^{4}+M N^{4}\right) \\
&+4 g_{2}^{2} g_{3} N\left(416+112 M-96 N-24 M N+18 N^{2}+6 M N^{2}+12 N^{3}+4
M N^{3}+2 N^{4}+M N^{4}\right) \\
&+g_{2}^{3}\left(-768-128 M+192 N+32 M N-96 N^{2}+32 N^{3}+4 M N^{3}+7 N^{4}+2
M N^{4}\right) \\
&+2 g_{1} g_{2}^{2}\left(-1152-192 M+288 N+48 M N-176 N^{2}-40 M N^{2}+70
N^{3}+10 M N^{3}+21 N^{4}+2 M N^{4}\right) \\
&\left.+4 g_{1}^{2} g_{2}\left(-576-96 M+144 N+24 M N-104 N^{2}-40 M N^{2}+34
N^{3}+13 M N^{3}+11 N^{4}+3 M N^{4}\right)\right),
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
and
\begin{equation*}
\begin{split}
\begin{aligned}
\beta_{4}^{(2)}=& \frac{1}{8 \pi^{2} N^{3}}\left(8 g_{1}^{2} g_{3} N\left(80+16 M-12 N+4 N^{2}+2 M N^{2}+3 N^{3}+N^{4}\right)\right.\\
&+224 g_{1} g_{4}^{2} N^{2}\left(-4-2 M+2 N+M N+2 N^{2}\right)+16 g_{1} g_{3}^{2} N^{2}\left(-16-2 M+8 N+M N+7 N^{2}\right) \\
&+96 g_{4}^{3} N^{3}\left(8-2 M+M N+M N^{2}\right)+64 g_{2} g_{3} g_{4} N^{2}\left(-14-4 M+7 N+2 M N+6 N^{2}+M N^{2}\right) \\
&+224 g_{2} g_{4}^{2} N^{2}\left(-4-2 M+2 N+M N+N^{2}+M N^{2}\right)+32 g_{3}^{2} g_{4} N^{3}\left(22+N+M N+N^{2}+M N^{2}\right) \\
&+64 g_{1} g_{3} g_{4} N^{2}\left(-14-4 M+7 N+2 M N+2 N^{2}+2 M N^{2}\right) \\
&+8 g_{2} g_{3}^{2} N^{2}\left(-32-4 M+16 N+2 M N+9 N^{2}+2 M N^{2}\right)+24 g_{3}^{3} N^{3}\left(4+2 M+N+N^{2}\right) \\
&+16 g_{1} g_{2} g_{3} N\left(80+16 M-12 N+7 N^{2}+2 M N^{2}+N^{3}\right)+224 g_{3} g_{4}^{2} N^{3}\left(2 M+N+N^{2}\right) \\
&+4 g_{2}^{2} g_{3} N\left(160+32 M-24 N+17 N^{2}+7 M N^{2}+4 N^{3}+N^{4}\right) \\
&+32 g_{1} g_{2} g_{4} N\left(96+36 M-24 N-12 M N+2 N^{2}-2 M N^{2}+4 N^{3}+M N^{3}+N^{4}\right) \\
&+4 g_{1}^{3}\left(-160-48 M+40 N+12 M N+4 N^{2}+2 M N^{2}+4 N^{3}+M N^{3}+2 N^{4}\right) \\
&+2 g_{1} g_{2}^{2}\left(-960-288 M+240 N+72 M N-88 N^{2}-20 M N^{2}+39 N^{3}+7 M N^{3}+13 N^{4}\right) \\
&+16 g_{1}^{2} g_{4} N\left(96+36 M-24 N-12 M N-4 N^{2}-2 M N^{2}+2 N^{3}+3 M N^{3}+M N^{4}\right) \\
&+8 g_{1}^{2} g_{2}\left(-240-72 M+60 N+18 M N-8 N^{2}-M N^{2}+6 N^{3}+2 M N^{3}+N^{4}+M N^{4}\right) \\
&+8 g_{2}^{2} g_{4} N\left(192+72 M-48 N-24 M N+10 N^{2}+2 M N^{2}+6 N^{3}+4 M N^{3}+N^{4}+M N^{4}\right) \\
&\left.+g_{2}^{3}\left(-640-192 M+160 N+48 M N-96 N^{2}-24 M N^{2}+36 N^{3}+12 M N^{3}+10 N^{4}+5 M N^{4}\right)\right).
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
The parameter \(\epsilon\) is fixed to \(1\), while \(M\) and \(N\) are taken
as unfolding parameters.


\section{Overview}
\label{\detokenize{HomoclinicRGflows:overview}}
\sphinxAtStartPar
In this demo we will use the new homoclinic predictor from
{[}\hyperlink{cite.references:id3}{Kuz21}{]} to continue homoclinic curves from generic
Bogdanov\sphinxhyphen{}Takens points. In order to do this we will:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Compute a curve of equilibria, parametrized by \(M\).

\item {} 
\sphinxAtStartPar
Detect various limit and Hopf points.

\item {} 
\sphinxAtStartPar
Start continuation from one of the detected Hopf points in two parameters \((M,N)\).

\item {} 
\sphinxAtStartPar
Detect two Bogdanov\sphinxhyphen{}Takens points.

\item {} 
\sphinxAtStartPar
Start continuation from the Bogdanov\sphinxhyphen{}Takens points in two parameters \((M,N)\).

\item {} 
\sphinxAtStartPar
Compare the predicted and computed homoclinic bifurcation curve emanating
from the first the Bogdanov\sphinxhyphen{}Takens point in parameters space.

\item {} 
\sphinxAtStartPar
Compare a range of predictors for the homoclinic solutions emanating from the
first Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space.

\item {} 
\sphinxAtStartPar
Create bifurcation plots including Hopf and fold curves.

\item {} 
\sphinxAtStartPar
Create a convergence plot comparing the different homoclinic approximations
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\end{itemize}


\section{Load MatCont}
\label{\detokenize{HomoclinicRGflows:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{HomoclinicRGflows:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{HomoclinicRGflowsGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{HomoclinicRGflowsGenSym.ipynb}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{HomoclinicRGflows}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define equilibrium}
\label{\detokenize{HomoclinicRGflows:define-equilibrium}}
\sphinxAtStartPar
We manually define an equilibrium at
\begin{equation}\label{equation:HomoclinicRGflows:eq:RGflows:equilibrium}
\begin{split}(g_1, g_2, g_3, g_4) = (0.27495712275636564, 1.3931601076374327, -0.30951743797410936, -0.30951743797410936),\end{split}
\end{equation}
\sphinxAtStartPar
with parameter values \(M=0.2945\) and \(N = 4.036\).

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in the software package \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool} {[}\hyperlink{cite.references:id21}{SEL+14}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{epsilon\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{M\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{N\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{epsilon}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{M}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.2945}\PYG{p}{;}
\PYG{n}{p}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{N}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{4.036}\PYG{p}{;}
\PYG{n}{x}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.0701457361241472}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.06520883770451065}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.001823543197553845}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.22874527306411319}\PYG{p}{]}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue equilibrium in parameter \protect\(N\protect\)}
\label{\detokenize{HomoclinicRGflows:continue-equilibrium-in-parameter-n}}
\sphinxAtStartPar
To continue the equilibrium \eqref{equation:HomoclinicRGflows:eq:RGflows:equilibrium} in parameter
\(N\), we first need to obtain a tangent vector to the curve. This is done
by the function \sphinxcode{\sphinxupquote{init\_EP\_EP}}. Then we use the function \sphinxcode{\sphinxupquote{contset}} to obtain a
\sphinxstylestrong{struct} containing a list of options which is passed on to the continuer. By
adjusting the values of the fields of the \sphinxcode{\sphinxupquote{opt}} \sphinxstylestrong{struct} we set the maximum
step size.  We also set the maximum number of points to continue and weather or
not to detect bifurcation points (\sphinxcode{\sphinxupquote{opt.Singularities}}) on the equilibrium
curve. For more information about all options available to the
\sphinxstyleemphasis{MatCont} continuer and the continuation process in general, we refer to
{[}\hyperlink{cite.references:id14}{DGK+08}{]}.

\sphinxAtStartPar
Finally, we continue the curve using the function \sphinxcode{\sphinxupquote{cont}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}EP\PYGZus{}EP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{p}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{M}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{contset}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{300}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Singularities}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{equilibrium}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
Neutral saddle
label = H , x = ( 0.000002 \PYGZhy{}0.000003 \PYGZhy{}0.000000 0.171390 1.091355 )
label = LP, x = ( \PYGZhy{}0.110189 0.142208 0.003572 0.100776 1.998164 )
a=\PYGZhy{}7.331116e\PYGZhy{}01
Neutral saddle
label = H , x = ( \PYGZhy{}0.579707 0.570669 0.013951 \PYGZhy{}0.019833 0.966823 )
label = LP, x = ( \PYGZhy{}0.876594 0.748784 0.043787 \PYGZhy{}0.092572 0.823874 )
a=3.488423e+00
Neutral saddle
label = H , x = ( \PYGZhy{}0.945788 0.778645 0.058703 \PYGZhy{}0.115668 0.837025 )
Neutral saddle
label = H , x = ( \PYGZhy{}0.990782 0.796522 0.076078 \PYGZhy{}0.141243 0.873995 )
label = LP, x = ( \PYGZhy{}1.273488 1.256015 0.469461 \PYGZhy{}0.638409 1.000164 )
a=7.585356e\PYGZhy{}01
label = LP, x = ( \PYGZhy{}1.345207 1.354790 0.724609 \PYGZhy{}0.959767 0.979759 )
a=\PYGZhy{}8.763553e\PYGZhy{}01
Neutral saddle
label = H , x = ( \PYGZhy{}1.042702 1.041690 0.603050 \PYGZhy{}0.814403 0.981600 )
label = BP, x = ( \PYGZhy{}0.541043 0.530513 0.349786 \PYGZhy{}0.520872 1.001623 )
label = BP, x = ( \PYGZhy{}0.541043 0.530513 0.349786 \PYGZhy{}0.520872 1.001623 )
Neutral saddle
label = H , x = ( \PYGZhy{}0.118398 0.237762 0.080743 \PYGZhy{}0.300349 1.024672 )
label = LP, x = ( \PYGZhy{}0.009751 0.027361 0.006892 \PYGZhy{}0.184779 1.098410 )
a=4.606024e\PYGZhy{}02
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.832631e\PYGZhy{}16.
\PYGZgt{} In equilibrium\PYGZgt{}locateBP (line 300)
In equilibrium\PYGZgt{}locate (line 214)
In cont (line 454)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.671679e\PYGZhy{}16.
\PYGZgt{} In equilibrium\PYGZgt{}locateBP (line 300)
In equilibrium\PYGZgt{}locate (line 214)
In cont (line 454)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.796148e\PYGZhy{}16.
\PYGZgt{} In equilibrium\PYGZgt{}locateBP (line 300)
In equilibrium\PYGZgt{}locate (line 214)
In cont (line 454)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  6.596977e\PYGZhy{}17.
\PYGZgt{} In equilibrium\PYGZgt{}locateBP (line 300)
In equilibrium\PYGZgt{}locate (line 214)
In cont (line 454)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  9.044303e\PYGZhy{}18.
\PYGZgt{} In equilibrium\PYGZgt{}locateBP (line 300)
In equilibrium\PYGZgt{}locate (line 214)
In cont (line 454)

Neutral saddle
label = H , x = ( 0.000004 \PYGZhy{}0.000012 \PYGZhy{}0.000003 \PYGZhy{}0.171382 1.091381 )
label = LP, x = ( 0.082791 \PYGZhy{}0.165490 \PYGZhy{}0.069470 \PYGZhy{}0.123735 0.030515 )
a=1.327431e+00
Neutral saddle
label = H , x = ( 0.017075 \PYGZhy{}0.016965 \PYGZhy{}0.013449 \PYGZhy{}0.162484 1.015832 )
Neutral saddle
label = H , x = ( 0.000034 \PYGZhy{}0.000033 \PYGZhy{}0.000027 \PYGZhy{}0.171369 1.091270 )
label = LP, x = ( \PYGZhy{}0.057200 0.053194 0.043292 \PYGZhy{}0.205042 1.166392 )
a=1.588963e\PYGZhy{}01
label = H , x = ( \PYGZhy{}1.161474 \PYGZhy{}0.089034 0.877004 \PYGZhy{}0.621034 0.674701 )
First Lyapunov coefficient = 4.229695e\PYGZhy{}01
label = H , x = ( \PYGZhy{}0.720879 \PYGZhy{}0.252515 0.514609 \PYGZhy{}0.394150 0.295843 )
First Lyapunov coefficient = \PYGZhy{}3.941504e+00
label = LP, x = ( \PYGZhy{}0.712373 \PYGZhy{}0.249398 0.507987 \PYGZhy{}0.391094 0.295815 )
a=\PYGZhy{}6.258319e+02
Neutral saddle
label = H , x = ( \PYGZhy{}0.386826 \PYGZhy{}0.127182 0.261001 \PYGZhy{}0.280979 0.367126 )
label = LP, x = ( 0.065249 0.011257 \PYGZhy{}0.036715 \PYGZhy{}0.160519 1.196516 )
a=\PYGZhy{}2.872173e\PYGZhy{}01
Neutral saddle
label = H , x = ( 0.648955 0.299168 \PYGZhy{}0.444774 \PYGZhy{}0.280762 \PYGZhy{}1.007194 )

elapsed time  = 1.0 secs
npoints curve = 300
\end{sphinxVerbatim}

\sphinxAtStartPar
There are multiple Hopf (H) and limit bifurcation points detected (LP). The \sphinxstylestrong{array struct}
\sphinxcode{\sphinxupquote{eqbr\_bif\_data}} contains information about the detected bifurcation points. We
use this to extract the index of the detected bifurcation points on the
equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}. The equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}} is just a two
dimensional array. Each column consists of a point on the curve. The first four
rows contain the point \(g\) while the last row contains the parameter \(M\).

\sphinxAtStartPar
Below we plot the equilibrium curve \sphinxcode{\sphinxupquote{eqbr\_x}}, together with the detected Hopf and limit
points, in \((M,g_4)\)\sphinxhyphen{}space.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n}{foldInfo}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Limit point\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{foldInfocell}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct2cell}\PYG{p}{(}\PYG{n}{foldInfo}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{foldInd}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{cell2mat}\PYG{p}{(}\PYG{n}{foldInfocell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfInfo}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfInfocell}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct2cell}\PYG{p}{(}\PYG{n}{hopfInfo}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfInd}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{cell2mat}\PYG{p}{(}\PYG{n}{hopfInfocell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{n}{foldInd}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{n}{foldInd}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.r\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{n}{hopfInd}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{n}{hopfInd}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}4\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium curve in \PYGZdl{}(M,g\PYGZus{}4)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_11_0}.png}


\section{Setup Hopf point}
\label{\detokenize{HomoclinicRGflows:setup-hopf-point}}
\sphinxAtStartPar
To continue the first Hopf point detected on the equilibrium branch \sphinxcode{\sphinxupquote{eqbr\_x}}
in the parameters \(M\) and \(N\) we construct a new point \sphinxcode{\sphinxupquote{Hopf}} containing the
position and parameter values.  These are needed to obtain an initial tangent
vector \sphinxhyphen{} using the function \sphinxcode{\sphinxupquote{init\_H\_H}} \sphinxhyphen{} in the full phase/parameter space.
Since, from now on, we will be using the continuation parameters \(M\) and \(N\)
frequently we assigned these parameters to the variable \sphinxcode{\sphinxupquote{ap}} (active
parameters).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{M}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{N}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{hopfInfo}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{eqbr\PYGZus{}bif\PYGZus{}data}\PYG{p}{.}\PYG{n}{msg}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{n}{hopfInfo}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopf}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{hopf}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{M}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{eqbr\PYGZus{}x}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{n}{hopfInfo}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}H\PYGZus{}H}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf}\PYG{p}{.}\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Continue Hopf point in parameters \protect\(M\protect\) and \protect\(N\protect\)}
\label{\detokenize{HomoclinicRGflows:continue-hopf-point-in-parameters-m-and-n}}
\sphinxAtStartPar
We continue the Hopf point curve using again the function \sphinxcode{\sphinxupquote{cont}}. We use the
same continuation options as before defined above in the \sphinxstylestrong{struct} \sphinxcode{\sphinxupquote{opt}}, but
set additionally the following options. We increase the number of maximum
allowed continuation points. We also increase the accuracy for locating
detected bifurcations (\sphinxcode{\sphinxupquote{TestTolerance}}) and the maximum number of iterations
that may be used to achieve this (\sphinxcode{\sphinxupquote{MaxTestIters}}). This improves the homoclinic
predictor which depend directly on the accuracy of the located Bogdanov\sphinxhyphen{}Takens
point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{TestTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}12}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxTestIters}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{MaxNumPoints}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{hopf}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( \PYGZhy{}0.715157 \PYGZhy{}0.250968 0.510051 \PYGZhy{}0.391935 0.294477 4.035536 0.000000 )
(a,b)=(1.387256e+00, \PYGZhy{}1.894680e\PYGZhy{}01)
label = HH, x = ( \PYGZhy{}0.642016 \PYGZhy{}0.228678 0.452440 \PYGZhy{}0.364578 0.283522 4.030314 \PYGZhy{}0.291003 )
Neutral saddle ?
label = BT, x = ( \PYGZhy{}0.133317 0.022458 0.090992 \PYGZhy{}0.220100 0.883754 4.419949 0.000000 )
(a,b)=(\PYGZhy{}2.411266e\PYGZhy{}02, \PYGZhy{}5.207995e\PYGZhy{}01)
label = BT, x = ( \PYGZhy{}0.132423 0.106649 0.089399 \PYGZhy{}0.248054 0.942195 4.593759 \PYGZhy{}0.000000 )
(a,b)=(\PYGZhy{}7.110064e\PYGZhy{}03, 5.333636e\PYGZhy{}02)
label = HH, x = ( \PYGZhy{}0.410202 0.398065 0.256144 \PYGZhy{}0.441341 0.950248 4.384951 \PYGZhy{}0.038318 )
Neutral saddle ?

elapsed time  = 0.6 secs
npoints curve = 50
\end{sphinxVerbatim}

\sphinxAtStartPar
There are two Bogdanov\sphinxhyphen{}Takens bifurcation points (BT) detected on the limit
point branch \sphinxcode{\sphinxupquote{lp\_br}}.

\sphinxAtStartPar
As with the limit points, information about the detected bifurcation points is
stored in the \sphinxstylestrong{struct array} \sphinxcode{\sphinxupquote{lp\_br\_bif}}. Below we extract the
Bogdanov\sphinxhyphen{}Takens bifurcation points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{(}\PYG{n+nb}{strcmp}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{hopf\PYGZus{}br\PYGZus{}bif}\PYG{p}{.}\PYG{n}{label}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{BT\PYGZsq{}}\PYG{p}{)}\PYG{o}{==}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BTPoint2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint2}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}N\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf branch\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf curve in \PYGZdl{}(M,N)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_17_0}.png}


\section{Initial prediction of homoclinic orbit near Bogdanov\sphinxhyphen{}Takens point 1}
\label{\detokenize{HomoclinicRGflows:initial-prediction-of-homoclinic-orbit-near-bogdanov-takens-point-1}}
\sphinxAtStartPar
To obtain an initial approximation to the homoclinic solution near the
Bogdanov\sphinxhyphen{}Takens point we use the function \sphinxcode{\sphinxupquote{init\_BT\_Hom}}. Its arguments are the
system file (\sphinxcode{\sphinxupquote{odefile}}), the Bogdanov\sphinxhyphen{}Takens point (\sphinxcode{\sphinxupquote{bt1}}) as defined below, the
unfolding parameters (\sphinxcode{\sphinxupquote{ap}}) and an options structure (\sphinxcode{\sphinxupquote{BToptions}}). The options
structure created with the function \sphinxcode{\sphinxupquote{BT\_Hom\_set\_options}} contains the following
fields:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ntst}} Number of mesh intervals with a default value of 40.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ncol}} Number of collocation points used in each interval with a default of 4.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{extravec}} Three dimensional boolean row vector indicating which \sphinxstyleemphasis{homoclinic
parameters} are selected to be free. The first component refers to the
half\sphinxhyphen{}return time, while the second and third components refer to the
distances from the saddle point to the first, respectively, the last point on
the homoclinic orbit. The default value is set to \sphinxcode{\sphinxupquote{{[}0 1 1{]}}}. Thus, the
half\sphinxhyphen{}return time \sphinxcode{\sphinxupquote{T}} is fixed.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{order}} The order of the homoclinic approximation used with a default value
of 3.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{amplitude}} Desired amplitude of the homoclinic solution. If left empty then
a conservative estimate is made, see {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{TTolerance}} Desired distance between the last point on the numerical
homoclinic solution and the saddle point. This should be at least be smaller
than the amplitude. If left empty it is defined by \sphinxcode{\sphinxupquote{amplitude*1.0e\sphinxhyphen{}03}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{HigherOrderTimeReparametrization}} Boolean to indicate if a higher order
approximation to the nonlinear time transformation in the Lindstedt\sphinxhyphen{}Poincaré
method should be used. This should always be set to \sphinxcode{\sphinxupquote{1}}.  It is only
implemented for demonstration purposes.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{method}} Selects the method to be used to approximate the homoclinic
solution. The different methods available are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
orbital (the default),

\item {} 
\sphinxAtStartPar
orbitalv2,

\item {} 
\sphinxAtStartPar
LP (Lindstedt\sphinxhyphen{}Poincaré with smooth normal form),

\item {} 
\sphinxAtStartPar
LPHypernormalForm,

\item {} 
\sphinxAtStartPar
RegularPerturbation,

\item {} 
\sphinxAtStartPar
RegularPerturbationL2.

\end{itemize}

\sphinxAtStartPar
We refer to {[}\hyperlink{cite.references:id3}{Kuz21}{]} for the interpretations.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{messages}} Boolean to indicate if information about selected parameter should
be printed the console. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{correct}} Boolean to indicate if the predicted homoclinic solution should be
corrected with Newton. The default value is set to \sphinxcode{\sphinxupquote{true}}.

\end{itemize}

\sphinxAtStartPar
Here we will use most of of default values for the Bogdanov\sphinxhyphen{}Takens option structure.
We set the field \sphinxcode{\sphinxupquote{correct}} to \sphinxcode{\sphinxupquote{false}} and manually correct the
approximation. Also, we set the field \sphinxcode{\sphinxupquote{amplitude}} to \sphinxcode{\sphinxupquote{0.2}} to start continuation
closer to the Bogdanov\sphinxhyphen{}Takens point. This looks better in the bifurcation diagram
below. However, if we do not set the field \sphinxcode{\sphinxupquote{amplitiude}} convergence is achived aswell.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{bt\PYGZus{}index}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}points\PYGZus{}info}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{.}\PYG{n}{index}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{p}\PYG{o}{\PYGZsq{}}\PYG{p}{;}
\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}index}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{0.2}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 7.730705e\PYGZhy{}12
BT normal form coefficients:
a=1.387256e+00,	 b=\PYGZhy{}1.894680e\PYGZhy{}01
The initial perturbation parameter epsilon:  2.936952e\PYGZhy{}02
The initial amplitude: 0.2
The initial half\PYGZhy{}return time T: 19.6487
The initial distance eps0: 0.000170201
The initial distance eps1: 0.000126381
\end{sphinxVerbatim}


\section{Correct initial prediction of homoclinic orbit near bt1 with Newton}
\label{\detokenize{HomoclinicRGflows:correct-initial-prediction-of-homoclinic-orbit-near-bt1-with-newton}}
\sphinxAtStartPar
Now that we have an initial prediction for the homoclinic orbit we
manually correct it using Newton. After the homoclinic predictor is corrected
with the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{newtcorr}} we use the function \sphinxcode{\sphinxupquote{bt\_rearr}}
(Bogdanov\sphinxhyphen{}Takens rearrange) to extract the homoclinic orbit and saddle point
from the homoclinic correction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{hom1\PYGZus{}x}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Compare profiles of predicted and corrected solution (bt1)}
\label{\detokenize{HomoclinicRGflows:compare-profiles-of-predicted-and-corrected-solution-bt1}}
\sphinxAtStartPar
Using again the \sphinxstylestrong{MatCont} function \sphinxcode{\sphinxupquote{bt\_rearr}}, but now on the homoclinic
prediction \sphinxcode{\sphinxupquote{x1\_pred}} we compare the profiles of the predicted and corrected
homoclinic orbits. We see that they are indistinguishable. Note that to access
the mesh on which the homoclinic orbit is computed we need the global variable
\sphinxcode{\sphinxupquote{homds}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{x1\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Profiles of the predicted and correction homolinic orbits.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}4\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{  }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}t\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_23_0}.png}


\section{Compare predictor and corrected solution in \protect\((g_1, g_2)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{HomoclinicRGflows:compare-predictor-and-corrected-solution-in-g-1-g-2-phase-space}}
\sphinxAtStartPar
Below we compare the predicted and corrected homoclinic orbit in \((g_1, g_2)\)
phase\sphinxhyphen{}space, as well as the predicted and corrected saddle point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{x1\PYGZus{}orbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{homoclinic1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x1\PYGZus{}saddle}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle1\PYGZus{}pred}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8500}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.3250}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.0980}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Orbits and saddle points of predicted and corrected in phase\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_25_0}.png}


\section{Continue homoclinic curve emanating from the first Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{HomoclinicRGflows:continue-homoclinic-curve-emanating-from-the-first-bogdanov-takens-point}}
\sphinxAtStartPar
Having obtain an initial approximation \sphinxcode{\sphinxupquote{{[}hom\_x, hom\_v{]}}}, where \sphinxcode{\sphinxupquote{homo\_v}} is the
tangent vector to the homoclinic curve pointing outwards from the
Bogdanov\sphinxhyphen{}Takens point, we can start continuation using the function \sphinxcode{\sphinxupquote{cont}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic\PYGZus{}br1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homoclinic\PYGZus{}singularities}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{homoclinic}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
Inclination\PYGZhy{}flip with respect to the unstable manifold, parameters = 0.32798 and 4.04374.

elapsed time  = 9.2 secs
npoints curve = 50
\end{sphinxVerbatim}


\section{Compare predicted with computed parameters emanating from bt1}
\label{\detokenize{HomoclinicRGflows:compare-predicted-with-computed-parameters-emanating-from-bt1}}
\sphinxAtStartPar
Now that we have obtained a curve of homoclinic orbits (\sphinxcode{\sphinxupquote{homoclinic\_br}}) we
compare the computed curve in parameter space with the predicted curve we
construct below. To do so, we use the function \sphinxcode{\sphinxupquote{BT\_nmfm\_orbital}} to obtain the
smooth orbital normal form coefficients, i.e. \(a\) and \(b\), and the coefficients
of the transformation \(K\) between the parameters of the system and the parameters
in the smooth orbital normal form, see {[}\hyperlink{cite.references:id3}{Kuz21}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{c}{\PYGZpc{} plot computed homoclinic parameter curve}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{c}{\PYGZpc{} Bogdanov\PYGZhy{}Takens parameter\PYGZhy{}dependent smooth orbital normal form coefficients}
\PYG{n}{bt1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}nmfm\PYGZus{}orbital}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{a}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{a}\PYG{p}{;}
\PYG{n}{b}\PYG{+w}{   }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{b}\PYG{p}{;}
\PYG{n}{K10}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K10}\PYG{p}{;}
\PYG{n}{K01}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K01}\PYG{p}{;}
\PYG{n}{K02}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K02}\PYG{p}{;}
\PYG{n}{K11}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K11}\PYG{p}{;}
\PYG{n}{K03}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{nmfm}\PYG{p}{.}\PYG{n}{K03}\PYG{p}{;}
\PYG{c}{\PYGZpc{} construct predictor as in the paper}
\PYG{n+nb}{eps}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{0.05}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{a}\PYGZca{}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{b}\PYGZca{}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{tau0}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{;}
\PYG{n}{tau2}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{288}\PYG{o}{/}\PYG{l+m+mi}{2401}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{a}\PYG{o}{/}\PYG{n}{b}\PYG{o}{*}\PYG{p}{(}\PYG{n}{tau0}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{tau2}\PYG{o}{*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{eps}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{K10}\PYG{o}{.*}\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K01}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{K02}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{K11}\PYG{o}{.*}\PYG{n}{beta1}\PYG{o}{.*}\PYG{n}{beta2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{K03}\PYG{o}{.*}\PYG{n}{beta2}\PYG{o}{.\PYGZca{}}\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n+nb}{alpha}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ap}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{;}
\PYG{c}{\PYGZpc{} plot currect predictor}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{alpha}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{)}
\PYG{c}{\PYGZpc{} plot Bogdanov\PYGZhy{}Takens point}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{M}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{(}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{N}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{c}{\PYGZpc{} set axis labels and legend}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}N\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Current homoclinic predictor\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Comparision between computed and predicted parameter curve.\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Center manifold coefficients\PYGZsq{} accuracy: 7.730705e\PYGZhy{}12
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_29_1}.png}


\section{Bifurcation diagram in \protect\((g_1,g_2,g_3)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{HomoclinicRGflows:bifurcation-diagram-in-g-1-g-2-g-3-phase-space}}
\sphinxAtStartPar
To obtain an impression of the  homoclinic solutions we plot the computed
homoclinic orbits in \((g_1,g_2,g_3)\) phase\sphinxhyphen{}space. The red curve is the
singularities detected on the homoclinic branch.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{;}
\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n}{bif\PYGZus{}points}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct2cell}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}singularities}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{cell2mat}\PYG{p}{(}\PYG{n}{bif\PYGZus{}points}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{cell2mat}\PYG{p}{(}\PYG{n}{bif\PYGZus{}points}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{coords}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{nphase}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{cell2mat}\PYG{p}{(}\PYG{n}{bif\PYGZus{}points}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{      }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LineWidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.k\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{SouthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclic orbits in \PYGZdl{}(g\PYGZus{}1,g\PYGZus{}2,g\PYGZus{}3)\PYGZdl{}\PYGZhy{}phase space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{l+m+mi}{66}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{+w}{ }
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_31_0}.png}


\subsection{Predictors of orbits for various epsilons}
\label{\detokenize{HomoclinicRGflows:predictors-of-orbits-for-various-epsilons}}
\sphinxAtStartPar
Before proceeding with continuing the homoclinic orbits emanating from the
remaining three Bogdanov\sphinxhyphen{}Takens points we show that the estimate of the
amplitude is very conservative. Below we compute for a large range of
amplitudes the predicted and corrected homoclinic solutions and compare them in
phase space. We see that for amplitudes up to \sphinxcode{\sphinxupquote{1.0e\sphinxhyphen{}02}} the predicted
homoclinic orbits are indistinguishable.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{options}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{options}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}05}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{linspace}\PYG{p}{(}\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}01}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XPredicted}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{660}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{XCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{l+m+mi}{660}\PYG{p}{,}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{  }\PYG{n}{options}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{options}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{x\PYGZus{}pred}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{try}
\PYG{+w}{    }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{  }\PYG{k}{catch}
\PYG{+w}{    }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Didn\PYGZsq{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{t convergence to homoclinic solution\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{clf}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n}{R}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{[}\PYG{n+nb}{cos}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n+nb}{sin}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n+nb}{sin}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{n+nb}{cos}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{S}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{s}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{s}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{0}\PYG{+w}{ }\PYG{l+s}{1]}\PYG{p}{;}
\PYG{n}{parsCorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{XCorrected}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{o}{.*}\PYG{n+nb}{ones}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{tps}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{parsCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{,}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{parsCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{,}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{end}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{l+m+mi}{32}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}

\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{alpha0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.139}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{alpha0}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{n}{alpha0}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{parsCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{,}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n}{alpha0}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{n}{alpha0}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{parsCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{,}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{end}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}4\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{l+m+mi}{28}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}

\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{n}{R}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{[}\PYG{n+nb}{cos}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{n+nb}{sin}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n+nb}{sin}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{n+nb}{cos}\PYG{p}{(}\PYG{n+nb}{alpha}\PYG{p}{)}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{0}\PYG{+w}{ }\PYG{l+s}{0}\PYG{+w}{ }\PYG{l+s}{1]}\PYG{p}{;}
\PYG{n}{S}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{@}\PYG{p}{(}\PYG{n}{s}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{s}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{0}\PYG{+w}{ }\PYG{l+s}{1}\PYG{+w}{ }\PYG{l+s}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{0}\PYG{+w}{ }\PYG{l+s}{0}\PYG{+w}{ }\PYG{l+s}{1]}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{end}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}3\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{l+m+mi}{332}\PYG{p}{,}\PYG{l+m+mi}{11}\PYG{p}{)}

\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XCorrected}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}

\PYG{+w}{    }\PYG{p}{[}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{XPredicted}\PYG{p}{(}\PYG{p}{:}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{profile}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{reshape}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{profileRotated}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{R}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{S}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{)}\PYG{o}{*}\PYG{n}{R}\PYG{p}{(}\PYG{l+m+mf}{1.2181}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n+nb}{profile}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                        }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{saddle}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n+nb}{plot3}\PYG{p}{(}\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{profileRotated}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{          }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{end}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}tilde g\PYGZus{}2\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{zlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}g\PYGZus{}4\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{grid}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{view}\PYG{p}{(}\PYG{l+m+mi}{332}\PYG{p}{,}\PYG{l+m+mi}{11}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_33_0}.png}


\section{Continue limit points emanating from the Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{HomoclinicRGflows:continue-limit-points-emanating-from-the-bogdanov-takens-point}}
\sphinxAtStartPar
Next we also continue the limit points emanating from the Bogdanov\sphinxhyphen{}Takens points.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}LP}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{.}\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{lp\PYGZus{}br}\PYG{p}{,}\PYG{+w}{ }\PYG{o}{\PYGZti{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br1\PYGZus{}bif}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{opt}\PYG{p}{.}\PYG{n}{Backward}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{n}{lp\PYGZus{}br\PYGZus{}rev}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cont}\PYG{p}{(}\PYG{p}{@}\PYG{n}{limitpoint}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}x}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp1\PYGZus{}v}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{opt}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
first point found
tangent vector to first point found
label = BT, x = ( \PYGZhy{}0.133317 0.022458 0.090992 \PYGZhy{}0.220100 0.883754 4.419949 )
(a,b)=(\PYGZhy{}2.411266e\PYGZhy{}02, \PYGZhy{}5.207995e\PYGZhy{}01)
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  1.198603e\PYGZhy{}16.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont (line 358)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND = 4.557903e\PYGZhy{}114.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont (line 358)

Warning: Matrix is singular, close to singular or badly scaled. Results may be inaccurate. RCOND = NaN.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont (line 358)

label = CP, x = ( \PYGZhy{}0.068275 0.012534 0.046191 \PYGZhy{}0.194560 0.905065 4.487600 )
c=1.231052e+00
Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND =  2.445239e\PYGZhy{}19.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont\PYGZgt{}LocateTestFunction (line 945)
In cont (line 465)

Warning: Matrix is close to singular or badly scaled. Results may be inaccurate. RCOND = 3.462497e\PYGZhy{}125.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont\PYGZgt{}LocateTestFunction (line 945)
In cont (line 465)

Warning: Matrix is singular, close to singular or badly scaled. Results may be inaccurate. RCOND = NaN.
\PYGZgt{} In limitpoint\PYGZgt{}curve\PYGZus{}func (line 26)
In newtcorr (line 21)
In cont\PYGZgt{}LocateTestFunction (line 945)
In cont (line 465)

label = ZH, x = ( 0.089558 0.013324 \PYGZhy{}0.045799 \PYGZhy{}0.157071 1.383946 3.902668 )
Neutral saddle
Zero\PYGZhy{}Neutral Saddle

elapsed time  = 0.3 secs
npoints curve = 50
first point found
tangent vector to first point found
label = BT, x = ( \PYGZhy{}0.715157 \PYGZhy{}0.250968 0.510051 \PYGZhy{}0.391935 0.294477 4.035536 )
(a,b)=(\PYGZhy{}1.387256e+00, 1.894680e\PYGZhy{}01)

elapsed time  = 0.1 secs
npoints curve = 50
\end{sphinxVerbatim}

\sphinxAtStartPar
We see that there are two additional Bogdanov\sphinxhyphen{}Takens points detected.


\section{Bifurcation plot}
\label{\detokenize{HomoclinicRGflows:bifurcation-plot}}
\sphinxAtStartPar
Next we plot the continued curves in \((M,N)\) parameter space near the first
Bogdanov\sphinxhyphen{}Takens point.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot inline }
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n}{homColor}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{hopfColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{foldColor}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopf\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hopfColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{lp\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{lp\PYGZus{}br\PYGZus{}rev}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{foldColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BTPoint1}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.b\PYGZsq{}}\PYG{+w}{ }\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{n}{homoclinic\PYGZus{}br1}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{PeriodIdx}\PYG{o}{+}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{     }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homColor}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{linewidth\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{HandleVisibility\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Off\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}M\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}N\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf/Neutral Saddle curve\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Fold curve\PYGZsq{}}\PYG{p}{,}\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogadanov\PYGZhy{}Takens point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthEast\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bifurcation daigram in \PYGZdl{}(M,N)\PYGZdl{}\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{axis}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1956}\PYG{+w}{    }\PYG{l+m+mf}{0.4852}\PYG{+w}{    }\PYG{l+m+mf}{3.9896}\PYG{+w}{    }\PYG{l+m+mf}{4.1020}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_38_0}.png}


\section{Convergence plot}
\label{\detokenize{HomoclinicRGflows:convergence-plot}}
\sphinxAtStartPar
We finish this notebook with a log\sphinxhyphen{}log convergence plot comparing the different
third order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the first Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{orbital\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{    }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LPHypernormalForm\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n}{o}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{o}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n}{o}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{            }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{try}
\PYG{+w}{                }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n}{o}\PYG{p}{,}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{catch}
\PYG{+w}{                }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{                }\PYG{k}{continue}
\PYG{+w}{            }\PYG{k}{end}
\PYG{+w}{        }\PYG{k}{end}
\PYG{+w}{    }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{d\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{s\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hodgkin\PYGZhy{}Huxley equations\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{HomoclinicRGflows_40_1}.png}


\chapter{Save data to files}
\label{\detokenize{HomoclinicRGflows:save-data-to-files}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsRPorder1.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsRPorder2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsRPorder3.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{+w}{                                                   }
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsLPorder1.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsLPorder2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsLPorder3.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}

\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsLPorder3orbital.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsRegularPerturbationL2.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{writematrix}\PYG{p}{(}\PYG{p}{[}\PYG{n}{amplitudes}\PYG{o}{\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../../data/HomRGflowsLPHypernormalForm.csv\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Delimiter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{ \PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\part{Bogdanov\sphinxhyphen{}Takens}


\chapter{Generate system files for predator\sphinxhyphen{}prey system with constant rate harvesting}
\label{\detokenize{BogdanovTakensNormalFormGenSym:generate-system-files-for-predator-prey-system-with-constant-rate-harvesting}}\label{\detokenize{BogdanovTakensNormalFormGenSym::doc}}
\sphinxAtStartPar
In this script the \sphinxstylestrong{system files} for critical Bogdanov\sphinxhyphen{}Takens codimension
two normal form given by
\begin{equation*}
\begin{split}
\begin{cases}
\begin{aligned}
\dot w_0 &= w_1, \\
\dot w_1 &= \beta_1  + \beta_2 w_1 - w_0^2 + w_0 w_1. \\
\end{aligned}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
are generated. These are used in the {\hyperref[\detokenize{BogdanovTakens::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{BogdanovTakens.md}}}} demo.


\section{Add MatCont path and load sym package if GNU Octave is used}
\label{\detokenize{BogdanovTakensNormalFormGenSym:add-matcont-path-and-load-sym-package-if-gnu-octave-is-used}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{/Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{if}\PYG{+w}{ }\PYG{n}{isOctave}
\PYG{+w}{  }\PYG{n}{pkg}\PYG{+w}{ }\PYG{n+nb}{load}\PYG{+w}{ }\PYG{n}{symbolic}\PYG{+w}{ }\PYG{c}{\PYGZpc{} for GNU Octave}
\PYG{k}{end}
\end{sphinxVerbatim}


\section{Set the system name}
\label{\detokenize{BogdanovTakensNormalFormGenSym:set-the-system-name}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{system\PYGZus{}name}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{BogdanovTakensNormalForm\PYGZsq{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create coordinates and parameter names as strings}
\label{\detokenize{BogdanovTakensNormalFormGenSym:create-coordinates-and-parameter-names-as-strings}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{coordsnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{w0\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{w1\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta2\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Create symbols for coordinates and parameters}
\label{\detokenize{BogdanovTakensNormalFormGenSym:create-symbols-for-coordinates-and-parameters}}
\sphinxAtStartPar
The array \sphinxcode{\sphinxupquote{par}} is the array of symbols in the same order as parnames.
Due to the following two lines we may, for example, use either \sphinxcode{\sphinxupquote{alpha}} or
\sphinxcode{\sphinxupquote{par(1)}}. There should no changes be need of this code.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{       }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{par}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{  }\PYG{c}{\PYGZpc{} now alpha1 is par(1) etc}
\PYG{n}{syms}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{    }\PYG{c}{\PYGZpc{} create symbol for alpha and delta}
\PYG{n}{coords}\PYG{p}{=}\PYG{n}{cell2sym}\PYG{p}{(}\PYG{n}{coordsnames}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{c}{\PYGZpc{} create 1 x n vector for coordinates}
\end{sphinxVerbatim}


\section{Define the system}
\label{\detokenize{BogdanovTakensNormalFormGenSym:define-the-system}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{dw0\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{w1}\PYG{p}{;}\PYG{+w}{ }
\PYG{n}{dw1\PYGZus{}dt}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{beta1}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{beta2}\PYG{o}{*}\PYG{n}{w1}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{n}{w0}\PYGZca{}\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{w0}\PYG{o}{*}\PYG{n}{w1}\PYG{p}{;}
\PYG{n+nb}{system}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{dw0\PYGZus{}dt}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{dw1\PYGZus{}dt}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
In general there are no modifications needed after this line.


\section{Differentiate and generate code (directional derivatives)}
\label{\detokenize{BogdanovTakensNormalFormGenSym:differentiate-and-generate-code-directional-derivatives}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>.m}}. This method uses directional derivatives.
Then using polarization identities derivatives can be calculated in arbitrary
direction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}directional\PYGZus{}derivatives}\PYG{p}{(}\PYG{k}{...}
\PYG{+w}{  }\PYG{n+nb}{system}\PYG{p}{,}\PYG{k}{...}\PYG{c}{   \PYGZpc{} n x 1 array of derivative symbolic expressions}
\PYG{+w}{  }\PYG{n}{coords}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} 1 x n array of symbols for states}
\PYG{+w}{  }\PYG{n}{par}\PYG{p}{,}\PYG{k}{...}\PYG{c}{      \PYGZpc{} 1 x np array of symbols used for parameters}
\PYG{+w}{  }\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{k}{...}\PYG{c}{ \PYGZpc{} argument specifying the system name}
\PYG{+w}{  }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{k}{...}\PYG{c}{ \PYGZpc{} directory to save to file}
\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Higher\sphinxhyphen{}order parameter\sphinxhyphen{}dependent multi\sphinxhyphen{}linear form.}
\label{\detokenize{BogdanovTakensNormalFormGenSym:higher-order-parameter-dependent-multi-linear-form}}
\sphinxAtStartPar
Exporting it to \sphinxcode{\sphinxupquote{<system\_name>\_multilinearforms.m}}. These multi\sphinxhyphen{}linear forms are
currently only used in the computation of the parameter\sphinxhyphen{}dependent center
manifold for the codimension two Bogdanov\sphinxhyphen{}Takens bifurcation.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{n}{suc}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{generate\PYGZus{}multilinear\PYGZus{}forms}\PYG{p}{(}\PYG{n}{system\PYGZus{}name}\PYG{p}{,}\PYG{+w}{ }\PYG{n+nb}{system}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{coords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{par}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{order}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems/\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\chapter{Bogdanov\sphinxhyphen{}Takens normal form}
\label{\detokenize{BogdanovTakens:bogdanov-takens-normal-form}}\label{\detokenize{BogdanovTakens::doc}}
\sphinxAtStartPar
The universal unfolding for the Bogdanov\sphinxhyphen{}Takens normal form is given by
\begin{equation}\label{equation:BogdanovTakens:eq:BogdanovTakensNormalForm}
\begin{split}\begin{cases}
\begin{aligned}
\dot w_0 &= w_1, \\
\dot w_1 &= \beta_1  + \beta_2 w_1 + w_0^2 - w_0 w_1. \\
\end{aligned}
\end{cases}\end{split}
\end{equation}

\section{Overview}
\label{\detokenize{BogdanovTakens:overview}}
\sphinxAtStartPar
In this demo we will
\begin{itemize}
\item {} 
\sphinxAtStartPar
Compare the profiles of the predicted homoclinic solutions emanating from the
Bogdanov\sphinxhyphen{}Takens point with the corrected homoclinic solutions curve in
phase\sphinxhyphen{}space. We will do this using the asymptotics derived in
{[}\hyperlink{cite.references:id3}{Kuz21}{]} and the asymptotics as provided in
{[}\hyperlink{cite.references:id2}{AHGKM16}{]}. We will focus on the difference in using the higher
order approximation of the non\sphinxhyphen{}linear time transformation.

\item {} 
\sphinxAtStartPar
Create a convergence plot of the different approximation
derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}. And compare them with the approximation
derived in {[}\hyperlink{cite.references:id2}{AHGKM16}{]}.

\end{itemize}

\sphinxAtStartPar
This demo will not show how to continue the homoclinic curve emanating from the
codimension two Bogdanov\sphinxhyphen{}Takens point. For this we refer to one of the other
demos.


\section{Load MatCont}
\label{\detokenize{BogdanovTakens:load-matcont}}
\sphinxAtStartPar
Before we can start using \sphinxstylestrong{MatCont} we need to add the main directory of
\sphinxstylestrong{MatCont,} as well as various subdirectories of \sphinxstylestrong{MatCont,} to the \sphinxstyleemphasis{MATLAB
search path}. This is done in the code below. The variable \sphinxcode{\sphinxupquote{matcont\_home}}
should point to the main directory of \sphinxstylestrong{MatCont.}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{clear}\PYG{+w}{ }\PYG{n+nb}{all}
\PYG{n}{matcontpath}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{../\PYGZsq{}}\PYG{p}{;}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{n}{matcontpath}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Systems\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Equilibrium\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPoint\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitPointCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Hopf\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Homoclinic\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LimitCycle\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Continuer\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MultilinearForms\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{addpath}\PYG{p}{(}\PYG{p}{[}\PYG{n}{matcontpath}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Utilities\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{n+nb}{groot}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultTextInterpreter\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LaTeX\PYGZsq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{set}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{defaultAxesFontSize\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Set the odefile}
\label{\detokenize{BogdanovTakens:set-the-odefile}}
\sphinxAtStartPar
Next we set the variable \sphinxcode{\sphinxupquote{odefile}} to the \sphinxstyleemphasis{system file} previously generated by
the notebook {\hyperref[\detokenize{BogdanovTakensNormalFormGenSym::doc}]{\sphinxcrossref{\DUrole{doc,std,std-doc}{Generate system files for predator\sphinxhyphen{}prey system with constant rate harvesting}}}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{odefile}\PYG{p}{=}\PYG{p}{@}\PYG{n}{BogdanovTakensNormalForm}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Define Bogdanov\sphinxhyphen{}Takens point}
\label{\detokenize{BogdanovTakens:define-bogdanov-takens-point}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{w0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{w1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{beta1}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{beta2}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{x}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{w0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{w1}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{bt}\PYG{p}{.}\PYG{n}{par}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{beta1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{beta2}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
To refer to the parameters throughout the script we create a \sphinxstylestrong{cell array} of
strings containing the parameter names. This is then converted into a
\sphinxstylestrong{struct}. This allows us to refer to the parameters as \sphinxcode{\sphinxupquote{ind.parametername}},
similar as done in \sphinxstyleemphasis{DDE\sphinxhyphen{}BifTool}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{parnames}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{beta2\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{n}{cind}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{parnames}\PYG{p}{;}\PYG{n+nb}{num2cell}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{parnames}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ind}\PYG{+w}{  }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{struct}\PYG{p}{(}\PYG{n}{cind}\PYG{p}{\PYGZob{}}\PYG{p}{:}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{Lindstedt\sphinxhyphen{}Poincaré with and without higher order time approximation}
\label{\detokenize{BogdanovTakens:lindstedt-poincare-with-and-without-higher-order-time-approximation}}
\sphinxAtStartPar
Here we will show that it is essential to use the higher order approximation of
the non\sphinxhyphen{}linear time transformation as derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}. This
was not taken into account in {[}\hyperlink{cite.references:id2}{AHGKM16}{]}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZpc{}plot \PYGZhy{}\PYGZhy{}width 1024 \PYGZhy{}\PYGZhy{}height 800}
\PYG{n}{ap}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{ind}\PYG{p}{.}\PYG{n}{beta1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ind}\PYG{p}{.}\PYG{n}{beta2}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{HigherOrderTimeReparametrization}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{6}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1.0e\PYGZhy{}03}\PYG{p}{;}
\PYG{n}{hom2016pred}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{HigherOrderTimeReparametrization}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom2021pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v\PYGZus{}pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{  }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{homcorrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{hom2021pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom\PYGZus{}v\PYGZus{}pred}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{global}\PYG{+w}{ }\PYG{n}{homds}
\PYG{p}{[}\PYG{n}{hom2016predOrbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle2016pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{hom2016pred}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{hom2021predOrbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddle2021pred}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{hom2021pred}\PYG{p}{)}\PYG{p}{;}
\PYG{p}{[}\PYG{n}{homcorrectedOrbit}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddlecorrected}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{bt\PYGZus{}rearr}\PYG{p}{(}\PYG{n}{homcorrected}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Profiles of the predicted and correction homolinic orbits.\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homcorrectedOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2016predOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2021predOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2016\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2021\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{subplot}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{hold}\PYG{+w}{ }\PYG{l+s}{on}\PYG{p}{;}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{homcorrectedOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2016predOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homds}\PYG{p}{.}\PYG{n}{finemsh}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{hom2021predOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2016\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2021\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}t\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
BT normal form coefficients:
a=\PYGZhy{}1,	 b=1
T: 5.04286
The initial perturbation parameter:  1
The initial distance eps0: 0.00144308
The initial distance eps1: 0.00485318
BT normal form coefficients:
a=\PYGZhy{}1,	 b=1
T: 5.04286
The initial perturbation parameter:  1
The initial distance eps0: 0.112165
The initial distance eps1: 4.58758e\PYGZhy{}08
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{BogdanovTakens_9_1}.png}


\section{Compare predictor and corrected solution in \protect\((w_0, w_1)\protect\) phase\sphinxhyphen{}space}
\label{\detokenize{BogdanovTakens:compare-predictor-and-corrected-solution-in-w-0-w-1-phase-space}}
\sphinxAtStartPar
The plot below shows that both predicted homoclinic orbits are in excellent
agreement in \((w_0, w_1)\) phase\sphinxhyphen{}space. However, this is not on which the Newton
iteration operates. It operates on the profiles as shown above.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{hold}\PYG{+w}{ }\PYG{n}{on}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{homcorrectedOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{homcorrectedOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hom2016predOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{hom2016predOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZhy{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{hom2021predOrbit}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{n}{hom2021predOrbit}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{k}{end}\PYG{p}{)}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{plot}\PYG{p}{(}\PYG{n}{saddlecorrected}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{saddlecorrected}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{.\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{MarkerSize\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Color\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{+w}{ }\PYG{l+m+mf}{0.4470}\PYG{+w}{ }\PYG{l+m+mf}{0.7410}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}w\PYGZus{}1\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{corrected\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2016\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{predicted 2021\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Corrected saddle point\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Orbits and saddle points of predicted and corrected in phase\PYGZhy{}space\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{BogdanovTakens_11_0}.png}


\section{Convergence plots}
\label{\detokenize{BogdanovTakens:convergence-plots}}
\sphinxAtStartPar
Below we show a log\sphinxhyphen{}log convergence plot comparing the different
higher order homoclinic approximation methods derived in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
to approximate the homoclinic solutions near the Bogdanov\sphinxhyphen{}Takens point.
On the abscissa is the amplitude \(A_0\) and on the ordinate the relative error
\(\delta\) between the constructed solution (\sphinxcode{\sphinxupquote{x\_pred}}) to the defining system for the
homoclinic orbit and the Newton corrected solution (\sphinxcode{\sphinxupquote{x\_corrected}}).
We will also plot the third order predictor as derived in
{[}\hyperlink{cite.references:id2}{AHGKM16}{]}. It is shown that it only provides zeroth\sphinxhyphen{}order
accuracy.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}

\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}
\PYG{+w}{    }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{try}
\PYG{+w}{            }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{catch}
\PYG{+w}{            }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{            }\PYG{k}{continue}
\PYG{+w}{        }\PYG{k}{end}
\PYG{+w}{  }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{4}\PYG{p}{;}
\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{HigherOrderTimeReparametrization}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{    }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{try}
\PYG{+w}{        }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{catch}
\PYG{+w}{        }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{        }\PYG{k}{continue}
\PYG{+w}{    }\PYG{k}{end}
\PYG{k}{end}

\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{4}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{o\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 3 zeroth order time\PYGZhy{}reparametrization\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov Takens normal form homoclinic convergence plot\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{BogdanovTakens_13_1}.png}

\sphinxAtStartPar
We finish this notebook with a convergence plot as above. This time we show
that the \(L2\) phase\sphinxhyphen{}condition provides better accuracy then  the phase\sphinxhyphen{}condition
used in {[}\hyperlink{cite.references:id2}{AHGKM16}{]}. However, as stated in {[}\hyperlink{cite.references:id3}{Kuz21}{]}
these results do not lift to the central manifold of a general system.

\sphinxAtStartPar
Also shown is that the Lindstedt\sphinxhyphen{}Poincaré method provides a much better
approximation here then either one of the regular perturbation methods.
This however doens’t hold true for the first order correction.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{BToptions}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{BT\PYGZus{}Hom\PYGZus{}set\PYGZus{}options}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{TTolerance}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{l+m+mf}{1e\PYGZhy{}05}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{messages}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}
\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{correct}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{false}\PYG{p}{;}

\PYG{n}{amplitudes}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{methodList}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{LP\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbation\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{RegularPerturbationL2\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}

\PYG{n}{relativeErrors}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{n}{k}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{methodList}\PYG{p}{)}
\PYG{+w}{        }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{,}\PYG{n}{k}\PYG{p}{\PYGZcb{}}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{zeros}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{order}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{i}\PYG{p}{;}
\PYG{+w}{        }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{method}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{methodList}\PYG{p}{\PYGZob{}}\PYG{n}{k}\PYG{p}{\PYGZcb{}}\PYG{p}{;}\PYG{+w}{ }
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{n+nb}{j}\PYG{p}{=}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n+nb}{length}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{)}
\PYG{+w}{            }\PYG{n}{BToptions}\PYG{p}{.}\PYG{n}{amplitude}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{amplitudes}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{p}{[}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{]}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{init\PYGZus{}BT\PYGZus{}Hom}\PYG{p}{(}\PYG{n}{odefile}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bt}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ap}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BToptions}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{try}
\PYG{+w}{                }\PYG{n}{x\PYGZus{}corrected}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{newtcorr}\PYG{p}{(}\PYG{n}{x\PYGZus{}pred}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{v0}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{                }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{n+nb}{i}\PYG{p}{,}\PYG{n}{k}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{n+nb}{j}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{o}{\PYGZhy{}}\PYG{n}{x\PYGZus{}pred}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb}{norm}\PYG{p}{(}\PYG{n}{x\PYGZus{}corrected}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{            }\PYG{k}{catch}
\PYG{+w}{                }\PYG{n+nb}{warning}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Did not converge.\PYGZsq{}}\PYG{p}{)}
\PYG{+w}{                }\PYG{k}{continue}
\PYG{+w}{            }\PYG{k}{end}
\PYG{+w}{        }\PYG{k}{end}
\PYG{+w}{    }\PYG{k}{end}
\PYG{k}{end}

\PYG{n+nb}{clf}
\PYG{n}{cm}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{lines}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\PYG{n+nb}{loglog}\PYG{p}{(}\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZhy{}\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{+\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{x\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{       }\PYG{n}{amplitudes}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{relativeErrors}\PYG{p}{\PYGZob{}}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{\PYGZcb{}}\PYG{p}{(}\PYG{p}{:}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{*\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{legend}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Lindstedt\PYGZhy{}Poincaré order 3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation order 1\PYGZsq{}}\PYG{p}{,}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation order 2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation order 3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation L2 phase condition order 1\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation L2 phase condition order 2\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Regular Perturbation L2 phase condition order 3\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{...}
\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Location\PYGZsq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{NorthWest\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{title}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Bogdanov Takens normal form homoclinic convergence plot\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{xlabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}A\PYGZus{}0\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{ylabel}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZdl{}\PYGZbs{}delta(X)\PYGZdl{}\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{gca}\PYG{p}{;}
\PYG{n+nb}{gray}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{+w}{ }\PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{;}
\PYG{n}{ax}\PYG{p}{.}\PYG{n}{ColorOrder}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{p}{[}\PYG{n+nb}{gray}\PYG{p}{;}\PYG{+w}{ }\PYG{n+nb}{gray}\PYG{p}{;}\PYG{+w}{ }\PYG{n+nb}{gray}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{k}{...}
\PYG{+w}{                 }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{cm}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{)}\PYG{p}{]}\PYG{p}{;}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Warning: Did not converge.
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{BogdanovTakens_15_1}.png}


\part{References}


\chapter{References}
\label{\detokenize{references:references}}\label{\detokenize{references::doc}}
\sphinxAtStartPar


\begin{sphinxthebibliography}{ShilNiko}
\bibitem[AHGKM16]{references:id2}
\sphinxAtStartPar
B. Al\sphinxhyphen{}Hdaibat, W. Govaerts, Yu. A. Kuznetsov, and H. G. E. Meijer. Initialization of homoclinic solutions near bogdanov–takens points: lindstedt–poincaré compared with regular perturbation method. \sphinxstyleemphasis{SIAM Journal on Applied Dynamical Systems}, 15(2):952–980, 2016. \sphinxhref{https://arxiv.org/abs/https://doi.org/10.1137/15M1017491}{arXiv:https://doi.org/10.1137/15M1017491}, \sphinxhref{https://doi.org/10.1137/15M1017491}{doi:10.1137/15M1017491}.
\bibitem[BAH15]{references:id5}
\sphinxAtStartPar
Willy Govaerts Bashir Al\sphinxhyphen{}Hdaibat. Continuation of homoclinic orbits starting from a generic bogdanov\sphinxhyphen{}takens point with matcont. \sphinxstyleemphasis{SourceForge}, 2015. URL: \sphinxurl{https://sourceforge.net/projects/matcont/files/NewestDocumentation/MatContODE/AdvancedTutorials/labinithom2.pdf}.
\bibitem[BR00]{references:id12}
\sphinxAtStartPar
A.S. Bazanella and R. Reginatto. Robustness margins for indirect field\sphinxhyphen{}oriented control of induction motors. \sphinxstyleemphasis{IEEE Trans. Automat. Contr.}, 45(6):1226–1231, June 2000. \sphinxhref{https://doi.org/10.1109/9.863613}{doi:10.1109/9.863613}.
\bibitem[Baz85]{references:id22}
\sphinxAtStartPar
A. D. Bazykin. \sphinxstyleemphasis{\textbackslash{}cyr Matematicheskaya biofizika vzaimodeĭ \textbackslash{}cyr stvuyushchikh populyatsiĭ}. “Nauka”, Moscow, 1985.
\bibitem[Bey94]{references:id9}
\sphinxAtStartPar
W.\sphinxhyphen{}J. Beyn. Numerical analysis of homoclinic orbits emanating from a takens\sphinxhyphen{}bogdanov point. \sphinxstyleemphasis{IMA J Numer Anal}, 14(3):381–410, 1994. \sphinxhref{https://doi.org/10.1093/imanum/14.3.381}{doi:10.1093/imanum/14.3.381}.
\bibitem[BS79]{references:id7}
\sphinxAtStartPar
F. Brauer and A.C. Soudack. Stability regions and transition phenomena for harvested predator\sphinxhyphen{}prey systems. \sphinxstyleemphasis{J. Math. Biol.}, 7(4):319–337, 1979. \sphinxhref{https://doi.org/10.1007/bf00275152}{doi:10.1007/bf00275152}.
\bibitem[BIK78]{references:id11}
\sphinxAtStartPar
V.I. Bykov, G.S. Iablonskii, and V.F. Kim. Simple\sphinxhyphen{}model of kinetic auto\sphinxhyphen{}oscillation model in catalytic reaction of co\sphinxhyphen{}oxidation. \sphinxstyleemphasis{Doklady Akademii Nauk SSSR}, 242:637–639, 1978.
\bibitem[DGK+08]{references:id14}
\sphinxAtStartPar
A. Dhooge, W. Govaerts, Yu.A. Kuznetsov, H.G.E. Meijer, and B. Sautois. New features of the software matcontfor bifurcation analysis of dynamical systems. \sphinxstyleemphasis{Mathematical and Computer Modelling of Dynamical Systems}, 14(2):147–175, April 2008. \sphinxhref{https://doi.org/10.1080/13873950701742754}{doi:10.1080/13873950701742754}.
\bibitem[HH52a]{references:id18}
\sphinxAtStartPar
A. L. Hodgkin and A. F. Huxley. A quantitative description of membrane current and its application to conduction and excitation in nerve. \sphinxstyleemphasis{The Journal of Physiology}, 117(4):500–544, 1952. \sphinxhref{https://arxiv.org/abs/https://physoc.onlinelibrary.wiley.com/doi/pdf/10.1113/jphysiol.1952.sp004764}{arXiv:https://physoc.onlinelibrary.wiley.com/doi/pdf/10.1113/jphysiol.1952.sp004764}, \sphinxhref{https://doi.org/https://doi.org/10.1113/jphysiol.1952.sp004764}{doi:https://doi.org/10.1113/jphysiol.1952.sp004764}.
\bibitem[HH52b]{references:id19}
\sphinxAtStartPar
A. L. Hodgkin and A. F. Huxley. Currents carried by sodium and potassium ions through the membrane of the giant axon of loligo. \sphinxstyleemphasis{The Journal of Physiology}, 116(4):449–472, 1952. \sphinxhref{https://arxiv.org/abs/https://physoc.onlinelibrary.wiley.com/doi/pdf/10.1113/jphysiol.1952.sp004717}{arXiv:https://physoc.onlinelibrary.wiley.com/doi/pdf/10.1113/jphysiol.1952.sp004717}, \sphinxhref{https://doi.org/https://doi.org/10.1113/jphysiol.1952.sp004717}{doi:https://doi.org/10.1113/jphysiol.1952.sp004717}.
\bibitem[JP21]{references:id23}
\sphinxAtStartPar
C. B. Jepsen and F. K. Popov. Homoclinic rg flows, or when relevant operators become irrelevant. \sphinxstyleemphasis{arXiv}, 2021. URL: \sphinxurl{arXiv:2105.01625v1}.
\bibitem[Khi90]{references:id10}
\sphinxAtStartPar
A. I. Khibnik. \sphinxstyleemphasis{LINLBF: A Program for Continuation and Bifurcation Analysis of Equilibria Up to Codimension Three}, pages 283–296. Springer Netherlands, Dordrecht, 1990. \sphinxhref{https://doi.org/10.1007/978-94-009-0659-4\_19}{doi:10.1007/978\sphinxhyphen{}94\sphinxhyphen{}009\sphinxhyphen{}0659\sphinxhyphen{}4\_19}.
\bibitem[Kuz21]{references:id3}
\sphinxAtStartPar
Bosschaert M.M. Kuznetsov, I.A. Interplay between normal forms and center manifold reduction for homoclinic predictors near bogdanov\sphinxhyphen{}takens bifurcation. \sphinxstyleemphasis{arXiv}, 2021.
\bibitem[KMGS08]{references:id15}
\sphinxAtStartPar
Yu.A. Kuznetsov, H.G.E. Meijer, W. Govaerts, and B. Sautois. Switching to nonhyperbolic cycles from codim 2 bifurcations of equilibria in odes. \sphinxstyleemphasis{Physica D: Nonlinear Phenomena}, 237(23):3061–3068, December 2008. \sphinxhref{https://doi.org/10.1016/j.physd.2008.06.006}{doi:10.1016/j.physd.2008.06.006}.
\bibitem[Kuz04]{references:id6}
\sphinxAtStartPar
Yu.A Kuznetsov. \sphinxstyleemphasis{Elements of Applied Bifurcation Theory}. Volume 112 of Applied Mathematical Sciences. Springer\sphinxhyphen{}Verlag, New York, third edition, 2004. ISBN 0\sphinxhyphen{}387\sphinxhyphen{}21906\sphinxhyphen{}4. \sphinxhref{https://doi.org/10.1007/978-1-4757-3978-7}{doi:10.1007/978\sphinxhyphen{}1\sphinxhyphen{}4757\sphinxhyphen{}3978\sphinxhyphen{}7}.
\bibitem[ML81]{references:id4}
\sphinxAtStartPar
C. Morris and H. Lecar. Voltage oscillations in the barnacle giant muscle fiber. \sphinxstyleemphasis{Biophysical Journal}, 35(1):193–213, July 1981. \sphinxhref{https://doi.org/10.1016/s0006-3495(81)84782-0}{doi:10.1016/s0006\sphinxhyphen{}3495(81)84782\sphinxhyphen{}0}.
\bibitem[SGAR08]{references:id13}
\sphinxAtStartPar
F. Salas, F. Gordillo, J. Aracil, and R. Reginatto. Codimension\sphinxhyphen{}two bifurcations in indirect field oriented control of induction motor drives. \sphinxstyleemphasis{Int. J. Bifurcation Chaos}, 18(03):779–792, March 2008. \sphinxhref{https://doi.org/10.1142/s0218127408020641}{doi:10.1142/s0218127408020641}.
\bibitem[SZ14]{references:id20}
\sphinxAtStartPar
Chunhua Shan and Huaiping Zhu. Bifurcations and complex dynamics of an sir model with the impact of the number of hospital beds. \sphinxstyleemphasis{Journal of Differential Equations}, 257(5):1662–1688, September 2014. \sphinxhref{https://doi.org/10.1016/j.jde.2014.05.030}{doi:10.1016/j.jde.2014.05.030}.
\bibitem[ShilNikovNN95]{references:id17}
\sphinxAtStartPar
A. Shil'Nikov, G. Nicolis, and C. Nicolis. Bifurcation and predictability analysis of a low\sphinxhyphen{}order atmospheric circulation model. \sphinxstyleemphasis{Int. J. Bifurcation Chaos}, 05(06):1701–1711, December 1995. \sphinxhref{https://doi.org/10.1142/s0218127495001253}{doi:10.1142/s0218127495001253}.
\bibitem[SEL+14]{references:id21}
\sphinxAtStartPar
Jan Sieber, Koen Engelborghs, Tatyana Luzyanina, Giovanni Samaey, and Dirk Roose. Dde\sphinxhyphen{}biftool manual \sphinxhyphen{} bifurcation analysis of delay differential equations. 2014. \sphinxhref{https://arxiv.org/abs/arXiv:1406.7144}{arXiv:arXiv:1406.7144}.
\bibitem[vV03]{references:id16}
\sphinxAtStartPar
Lennaert van Veen. Baroclinic flow and the lorenz\sphinxhyphen{}84 model. \sphinxstyleemphasis{Int. J. Bifurcation Chaos}, 13(08):2117–2139, August 2003. \sphinxhref{https://doi.org/10.1142/s0218127403007904}{doi:10.1142/s0218127403007904}.
\bibitem[XR99]{references:id8}
\sphinxAtStartPar
Dongmei Xiao and Shigui Ruan. Bogdanov\sphinxhyphen{}Takens bifurcations in predator\sphinxhyphen{}prey systems with constant rate harvesting. In \sphinxstyleemphasis{Differential equations with applications to biology (Halifax, NS, 1997)}, volume 21 of Fields Inst. Commun., pages 493–506. Amer. Math. Soc., Providence, RI, 1999.
\end{sphinxthebibliography}







\renewcommand{\indexname}{Index}
\printindex
\end{document}